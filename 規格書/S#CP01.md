# S#CP01 程式規格說明文件

## 一、基本資訊

- **程式ID**：S#CP01
- **程式名稱**：使用者密碼安全維護程式
- **系統歸屬**：西祺企業管理資訊系統 - 系統管理模組
- **開發者**：ANDY
- **建立日期**：1981.06.29
- **最後更新**：未記錄

## 二、程式概述

S#CP01是西祺企業管理資訊系統中系統管理模組的重要程式，負責使用者密碼的安全維護和管理。該程式提供使用者密碼的變更功能，允許使用者將原始密碼更改為新密碼，以確保系統安全性。程式設計簡潔，操作流程清晰，是系統安全管理的基礎工具。

## 三、系統架構

S#CP01程式在系統中的位置處於系統管理模組的安全管理環節，與使用者權限管理密切相關。程式架構如下：

1. **主程式**：S#CP01 - 負責使用者介面和流程控制
2. **控制程式**：S#CP01C - 負責密碼變更的處理邏輯
3. **處理程式**：S#CP011 - 負責密碼驗證和更新
4. **顯示檔案**：S#CP01D - 提供使用者介面

## 四、程式流程

1. **初始化階段**：
   - 設定初始參數和環境變數
   - 清空輸入欄位

2. **使用者互動階段**：
   - 顯示密碼變更畫面
   - 收集使用者輸入的原始密碼和新密碼
   - 處理使用者功能鍵（F3退出）

3. **處理控制階段**：
   - 呼叫S#CP01C程式處理密碼變更
   - S#CP01C呼叫S#CP011進行密碼驗證和更新
   - 返回結果並顯示相應訊息

4. **結束階段**：
   - 完成密碼變更後退出程式
   - 或使用者取消操作後退出程式

## 五、介面設計

S#CP01D顯示檔案是程式的主要使用者介面，包含以下元素：

1. **標題區**：
   - 程式標識和系統名稱
   - 當前日期和時間

2. **輸入區**：
   - 原始使用者密碼輸入欄位(DBGN1)
   - 新使用者密碼輸入欄位(DBGN2)

3. **功能鍵**：
   - F3：退出程式

4. **訊息區**：
   - 顯示操作結果和錯誤訊息
   - 支援多種錯誤訊息顯示(ERR1, ERR2, ERR3)

## 六、資料處理

程式對以下檔案進行操作：

1. **S#SDPF**：使用者安全資料檔案
   - 包含使用者ID、密碼和權限資訊
   - 程式通過此檔案驗證原始密碼

2. **S#SDLF9**：使用者登入記錄檔案
   - 記錄使用者登入和密碼變更歷史
   - 用於驗證使用者身份

3. **S#SUPF**：使用者基本資料檔案
   - 包含使用者基本資訊
   - 用於獲取使用者相關資訊

## 七、安全機制

1. **密碼驗證**：
   - 驗證原始密碼是否正確
   - 確保只有合法使用者可以變更密碼

2. **密碼加密**：
   - 密碼以加密形式儲存在資料庫中
   - 確保密碼安全性

3. **錯誤處理**：
   - 提供明確的錯誤訊息
   - 防止未授權的密碼變更

## 八、主要功能

1. **密碼變更**：
   - 允許使用者變更自己的密碼
   - 要求輸入原始密碼和新密碼

2. **密碼驗證**：
   - 驗證原始密碼是否正確
   - 確保只有合法使用者可以變更密碼

3. **安全記錄**：
   - 記錄密碼變更歷史
   - 提供安全審計功能

## 九、程式邏輯

1. **S#CP01**：
   - 顯示使用者介面
   - 收集使用者輸入
   - 呼叫S#CP01C處理密碼變更

2. **S#CP01C**：
   - 接收使用者輸入的密碼資訊
   - 呼叫S#CP011進行密碼驗證和更新
   - 處理操作結果

3. **S#CP011**：
   - 驗證原始密碼
   - 更新新密碼
   - 記錄密碼變更歷史

## 十、整合點

1. **上游系統**：
   - 系統管理主選單(S#M000)
   - 使用者登入程式

2. **下游系統**：
   - 使用者權限管理程式(S#S01)
   - 系統安全審計程式

## 十一、錯誤處理

程式提供多種錯誤處理機制：

1. **輸入驗證**：
   - 確保密碼欄位不為空
   - 驗證密碼格式

2. **錯誤訊息**：
   - ERR1：原始密碼錯誤
   - ERR2：新密碼格式不正確
   - ERR3：密碼更新失敗

3. **操作結果**：
   - 成功訊息：密碼已成功更新
   - 失敗訊息：密碼更新失敗，請重試

## 十二、使用方式

1. **從系統主選單進入**：
   - 選擇選項08（使用者密碼安全維護）
   - 系統顯示S#CP01密碼變更畫面

2. **輸入密碼資訊**：
   - 輸入原始使用者密碼
   - 輸入新使用者密碼

3. **完成操作**：
   - 系統驗證並更新密碼
   - 顯示操作結果訊息

## 十三、總結

S#CP01程式是西祺企業管理資訊系統中系統管理模組的重要安全工具，負責使用者密碼的安全維護和管理。程式設計簡潔，操作流程清晰，提供了基本的密碼變更功能，確保系統安全性。通過與其他安全管理程式的協作，構成了完整的系統安全管理機制，為企業資訊系統提供基礎的安全保障。