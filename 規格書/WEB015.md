# 程式功能規格書

## 1. 程式基本資訊

| 項目 | 內容 |
|------|------|
| 程式編號 | WEB015 |
| 程式名稱 | Web 化銷售訂單管理系統 |
| 系統分類 | 網路銷售管理系統 |
| 開發語言 | RPG IV / HTML / JavaScript |
| 資料庫   | DB2 for IBM i |
| 執行平台 | AS/400 與網頁前端 |
| 版本     | 1.0 |

## 2. 程式概述

WEB015 是一個 Web 化銷售訂單管理系統，將傳統 AS/400 綠屏的銷售訂單處理功能轉換為網頁介面，提供更直覺、更便捷的銷售訂單管理體驗。該程式負責銷售訂單的建立、修改、查詢、審核、處理和追蹤等全生命週期管理，支援多種訂單類型、多層級審核流程和完整的訂單狀態追蹤。系統與庫存、客戶、產品和財務等模組整合，實現從訂單接收到出貨、開立發票的完整業務流程，並提供豐富的報表和分析功能，協助企業提升銷售效率和客戶滿意度。

## 3. 功能需求

### 3.1 基本功能

#### 3.1.1 訂單建立功能
- 新增銷售訂單
- 選擇客戶資料
- 選擇產品項目
- 設定數量與價格
- 計算訂單金額

#### 3.1.2 訂單查詢功能
- 按訂單編號查詢
- 按客戶資料查詢
- 按訂單日期查詢
- 按訂單狀態查詢
- 按業務人員查詢

#### 3.1.3 訂單處理功能
- 訂單審核與核准
- 訂單修改與取消
- 訂單出貨處理
- 訂單發票處理
- 訂單結案處理

#### 3.1.4 訂單狀態追蹤
- 顯示訂單當前狀態
- 追蹤訂單處理進度
- 記錄訂單狀態變更
- 顯示訂單處理歷程
- 訂單異常狀態警示

#### 3.1.5 訂單報表功能
- 訂單明細報表
- 訂單狀態報表
- 銷售統計報表
- 業務績效報表
- 客戶訂購分析報表

### 3.2 進階功能

#### 3.2.1 多類型訂單支援
- 標準銷售訂單
- 預訂訂單
- 樣品訂單
- 專案訂單
- 促銷訂單

#### 3.2.2 訂單審核流程
- 多層級審核機制
- 權限控制與分配
- 審核意見記錄
- 審核通知機制
- 審核歷程追蹤

#### 3.2.3 庫存整合功能
- 即時庫存查詢
- 庫存預留機制
- 缺貨處理機制
- 庫存分配優化
- 庫存變動追蹤

#### 3.2.4 客戶整合功能
- 客戶資料同步
- 客戶信用檢查
- 客戶特殊價格
- 客戶訂購歷史
- 客戶偏好設定

## 4. 資料結構

### 4.1 主要檔案

#### 4.1.1 銷售訂單主檔 (WEBSOPF)
| 欄位名稱 | 資料類型 | 長度 | 說明 |
|---------|---------|------|------|
| ORDER_ID | CHAR | 10 | 訂單編號 (主鍵) |
| ORDER_TYPE | CHAR | 2 | 訂單類型代碼 |
| CUST_ID | CHAR | 10 | 客戶編號 |
| ORDER_DATE | DATE | - | 訂單日期 |
| DELIVERY_DATE | DATE | - | 預計交貨日期 |
| SALES_REP | CHAR | 10 | 業務代表 |
| CURRENCY | CHAR | 3 | 幣別代碼 |
| EXCHANGE_RATE | DECIMAL | 10,6 | 匯率 |
| SUBTOTAL | DECIMAL | 12,2 | 小計金額 |
| DISCOUNT_AMT | DECIMAL | 12,2 | 折扣金額 |
| TAX_AMT | DECIMAL | 12,2 | 稅金 |
| SHIPPING_AMT | DECIMAL | 12,2 | 運費 |
| TOTAL_AMT | DECIMAL | 12,2 | 總金額 |
| PAYMENT_TERMS | CHAR | 5 | 付款條件 |
| SHIPPING_METHOD | CHAR | 5 | 運送方式 |
| ORDER_STATUS | CHAR | 2 | 訂單狀態代碼 |
| APPROVAL_STATUS | CHAR | 2 | 審核狀態代碼 |
| CREDIT_CHECK | CHAR | 1 | 信用檢查狀態 |
| REMARKS | VARCHAR | 500 | 備註 |
| CREATE_USER | CHAR | 10 | 建立人員 |
| CREATE_DATE | DATE | - | 建立日期 |
| CREATE_TIME | TIME | - | 建立時間 |
| UPDATE_USER | CHAR | 10 | 更新人員 |
| UPDATE_DATE | DATE | - | 更新日期 |
| UPDATE_TIME | TIME | - | 更新時間 |

#### 4.1.2 銷售訂單明細檔 (WEBSODF)
| 欄位名稱 | 資料類型 | 長度 | 說明 |
|---------|---------|------|------|
| ORDER_ID | CHAR | 10 | 訂單編號 (主鍵) |
| LINE_NO | SMALLINT | - | 明細行號 (主鍵) |
| PRODUCT_ID | CHAR | 15 | 產品代碼 |
| DESCRIPTION | VARCHAR | 100 | 產品描述 |
| QUANTITY | DECIMAL | 10,2 | 數量 |
| UNIT | CHAR | 5 | 單位 |
| UNIT_PRICE | DECIMAL | 12,2 | 單價 |
| DISCOUNT_PCT | DECIMAL | 5,2 | 折扣百分比 |
| DISCOUNT_AMT | DECIMAL | 12,2 | 折扣金額 |
| LINE_AMT | DECIMAL | 12,2 | 行項目金額 |
| TAX_CODE | CHAR | 5 | 稅別代碼 |
| TAX_AMT | DECIMAL | 12,2 | 稅金 |
| WAREHOUSE | CHAR | 5 | 倉庫代碼 |
| DELIVERY_DATE | DATE | - | 預計交貨日期 |
| LINE_STATUS | CHAR | 2 | 行項目狀態 |
| SHIPPED_QTY | DECIMAL | 10,2 | 已出貨數量 |
| INVOICED_QTY | DECIMAL | 10,2 | 已開票數量 |
| REMARKS | VARCHAR | 200 | 備註 |

#### 4.1.3 訂單狀態歷程檔 (WEBSOSHF)
| 欄位名稱 | 資料類型 | 長度 | 說明 |
|---------|---------|------|------|
| ORDER_ID | CHAR | 10 | 訂單編號 (主鍵) |
| STATUS_SEQ | SMALLINT | - | 狀態序號 (主鍵) |
| STATUS_CODE | CHAR | 2 | 狀態代碼 |
| STATUS_DATE | DATE | - | 狀態日期 |
| STATUS_TIME | TIME | - | 狀態時間 |
| OPERATOR_ID | CHAR | 10 | 操作人員 |
| REMARKS | VARCHAR | 200 | 備註 |

#### 4.1.4 訂單審核記錄檔 (WEBSOAPF)
| 欄位名稱 | 資料類型 | 長度 | 說明 |
|---------|---------|------|------|
| ORDER_ID | CHAR | 10 | 訂單編號 (主鍵) |
| APPROVAL_SEQ | SMALLINT | - | 審核序號 (主鍵) |
| APPROVAL_LEVEL | CHAR | 2 | 審核層級 |
| APPROVER_ID | CHAR | 10 | 審核人員 |
| APPROVAL_DATE | DATE | - | 審核日期 |
| APPROVAL_TIME | TIME | - | 審核時間 |
| APPROVAL_STATUS | CHAR | 2 | 審核狀態 |
| COMMENTS | VARCHAR | 500 | 審核意見 |

#### 4.1.5 訂單出貨記錄檔 (WEBSOSHPF)
| 欄位名稱 | 資料類型 | 長度 | 說明 |
|---------|---------|------|------|
| SHIPMENT_ID | CHAR | 10 | 出貨編號 (主鍵) |
| ORDER_ID | CHAR | 10 | 訂單編號 |
| SHIPMENT_DATE | DATE | - | 出貨日期 |
| CARRIER | CHAR | 10 | 承運商 |
| TRACKING_NO | VARCHAR | 50 | 追蹤編號 |
| TOTAL_PACKAGES | SMALLINT | - | 包裹總數 |
| TOTAL_WEIGHT | DECIMAL | 10,2 | 總重量 |
| SHIPPING_AMT | DECIMAL | 12,2 | 運費 |
| STATUS | CHAR | 2 | 出貨狀態 |
| CREATE_USER | CHAR | 10 | 建立人員 |
| CREATE_DATE | DATE | - | 建立日期 |
| REMARKS | VARCHAR | 200 | 備註 |

### 4.2 參考檔案

#### 4.2.1 客戶主檔 (WEBCUSPF)
#### 4.2.2 產品主檔 (MDPRODF)
#### 4.2.3 庫存主檔 (IMISPF)
#### 4.2.4 業務人員檔 (MDSALEF)
#### 4.2.5 狀態代碼檔 (SYSCODEF)

## 5. 處理流程

### 5.1 訂單建立流程
1. 使用者登入系統
2. 使用者選擇新增訂單功能
3. 系統顯示訂單輸入表單
4. 使用者選擇客戶資料
5. 系統載入客戶相關資訊
6. 使用者輸入訂單基本資料
7. 使用者新增產品項目
8. 系統檢查產品庫存
9. 系統計算訂單金額
10. 使用者確認訂單資料
11. 系統儲存訂單並生成訂單編號
12. 系統更新訂單狀態為「已建立」
13. 系統通知相關人員

### 5.2 訂單審核流程
1. 審核人員登入系統
2. 審核人員查看待審核訂單
3. 審核人員選擇特定訂單
4. 系統顯示訂單詳細資料
5. 審核人員檢查訂單資料
6. 審核人員輸入審核意見
7. 審核人員選擇核准或拒絕
8. 系統記錄審核結果
9. 系統更新訂單審核狀態
10. 如需更高層級審核，系統通知下一位審核人員
11. 如審核完成，系統更新訂單狀態為「已核准」

### 5.3 訂單出貨流程
1. 倉庫人員登入系統
2. 倉庫人員查看待出貨訂單
3. 倉庫人員選擇特定訂單
4. 系統顯示訂單出貨資料
5. 倉庫人員確認庫存
6. 倉庫人員輸入出貨資料
7. 系統生成出貨單
8. 系統更新庫存數量
9. 系統更新訂單出貨狀態
10. 系統通知客戶和業務人員

### 5.4 訂單發票流程
1. 財務人員登入系統
2. 財務人員查看待開立發票的訂單
3. 財務人員選擇特定訂單
4. 系統顯示訂單發票資料
5. 財務人員確認發票資料
6. 系統生成發票
7. 系統更新訂單發票狀態
8. 系統通知客戶和業務人員

## 6. 使用者介面

### 6.1 網頁前端介面

#### 6.1.1 訂單查詢頁面
- 查詢條件設定區域
- 快速查詢按鈕
- 查詢結果顯示區域
- 分頁控制
- 排序與篩選控制
- 資料匯出按鈕
- 新增訂單按鈕

#### 6.1.2 訂單建立頁面
- 客戶選擇區域
- 訂單基本資料輸入區域
- 產品項目選擇與輸入區域
- 金額計算與顯示區域
- 訂單摘要顯示
- 儲存與提交按鈕
- 取消按鈕

#### 6.1.3 訂單詳細資料頁面
- 訂單基本資料顯示
- 訂單明細資料顯示
- 訂單金額資訊
- 訂單狀態顯示
- 訂單處理歷程
- 審核資訊顯示
- 操作按鈕區域

#### 6.1.4 訂單審核頁面
- 待審核訂單列表
- 訂單詳細資料顯示
- 審核意見輸入區域
- 審核歷程顯示
- 核准與拒絕按鈕
- 返回按鈕

#### 6.1.5 訂單出貨頁面
- 待出貨訂單列表
- 訂單明細與庫存資訊
- 出貨資料輸入區域
- 出貨歷程顯示
- 確認出貨按鈕
- 取消按鈕

### 6.2 報表介面

#### 6.2.1 訂單明細報表
- 報表參數設定
- 報表預覽
- 報表匯出選項
- 報表列印選項
- 報表儲存選項

#### 6.2.2 銷售統計報表
- 統計條件設定
- 統計圖表顯示
- 統計數據表格
- 資料鑽取功能
- 報表匯出選項

#### 6.2.3 業務績效報表
- 績效條件設定
- 績效圖表顯示
- 績效數據表格
- 比較分析功能
- 報表匯出選項

## 7. 系統整合

### 7.1 與客戶管理系統整合
- 同步客戶基本資料
- 檢查客戶信用狀態
- 更新客戶訂購歷史
- 提供客戶特殊價格
- 支援客戶偏好設定

### 7.2 與庫存管理系統整合
- 即時查詢庫存狀態
- 預留庫存數量
- 更新庫存使用情況
- 觸發庫存補充請求
- 監控庫存水平

### 7.3 與財務系統整合
- 處理訂單付款資訊
- 生成銷售發票
- 更新應收帳款
- 處理銷售退回
- 提供銷售報表資料

### 7.4 與物流系統整合
- 生成出貨資訊
- 追蹤運送狀態
- 處理運送異常
- 提供運送成本分析
- 優化運送路線

## 8. 安全性需求

### 8.1 資料安全
- 訂單資料存取控制
- 敏感資料加密
- 資料傳輸加密
- 定期資料備份
- 資料存取稽核記錄

### 8.2 使用者認證與授權
- 使用者身份驗證
- 角色基礎存取控制
- 功能權限管理
- 資料權限管理
- 操作權限管理

### 8.3 系統安全
- 網路安全防護
- 系統漏洞定期檢測
- 安全更新管理
- 防毒與惡意軟體防護
- 系統安全稽核

## 9. 效能需求

### 9.1 回應時間
- 基本查詢回應時間不超過 2 秒
- 複雜查詢回應時間不超過 5 秒
- 訂單儲存回應時間不超過 3 秒
- 報表生成時間不超過 10 秒
- 頁面載入時間不超過 3 秒

### 9.2 處理能力
- 支援同時 50 位使用者在線
- 每日處理 1,000 筆訂單
- 每小時處理 200 筆訂單
- 支援 100,000 筆訂單記錄
- 系統可用性達 99.5%

### 9.3 擴展性
- 支援水平擴展
- 模組化設計
- 可配置的處理流程
- 彈性的資料結構
- 支援未來功能擴展

## 10. 測試需求

### 10.1 功能測試
- 訂單建立功能測試
- 訂單查詢功能測試
- 訂單處理功能測試
- 訂單狀態追蹤測試
- 報表生成功能測試

### 10.2 效能測試
- 系統負載測試
- 查詢效能測試
- 資料庫效能測試
- 並發使用者測試
- 長時間運行穩定性測試

### 10.3 安全測試
- 使用者認證測試
- 權限控制測試
- 資料存取控制測試
- 資料加密測試
- 安全漏洞掃描

### 10.4 整合測試
- 與客戶管理系統整合測試
- 與庫存管理系統整合測試
- 與財務系統整合測試
- 與物流系統整合測試
- 與報表系統整合測試

## 11. 實施計劃

### 11.1 開發階段
1. 需求分析與設計 (2週)
2. 資料庫設計與建置 (1週)
3. 後端程式開發 (4週)
4. 前端介面開發 (3週)
5. 系統整合 (2週)
6. 測試與除錯 (3週)
7. 文件編寫 (1週)

### 11.2 測試階段
1. 單元測試 (1週)
2. 整合測試 (1週)
3. 系統測試 (2週)
4. 使用者接受度測試 (1週)
5. 效能測試 (1週)
6. 安全測試 (1週)

### 11.3 部署階段
1. 環境準備 (1週)
2. 系統部署 (1週)
3. 資料遷移 (1週)
4. 使用者培訓 (1週)
5. 上線準備 (1週)
6. 正式上線 (1天)
7. 上線後支援 (4週)

## 12. 維護計劃

### 12.1 日常維護
- 系統監控與警報
- 資料庫維護與優化
- 系統效能調整
- 安全更新與修補
- 問題追蹤與解決

### 12.2 定期維護
- 每週系統備份
- 每月系統效能評估
- 每季安全稽核
- 每半年系統升級評估
- 每年系統全面檢修

### 12.3 問題處理流程
1. 問題報告接收
2. 問題分類與優先級評估
3. 問題分派與處理
4. 解決方案測試與驗證
5. 解決方案部署
6. 問題解決確認與記錄

## 13. 文件需求

### 13.1 技術文件
- 系統架構文件
- 資料庫設計文件
- 程式設計文件
- API 文件
- 測試文件

### 13.2 使用者文件
- 使用者手冊
- 管理員手冊
- 操作指南
- 常見問題解答
- 故障排除指南

### 13.3 培訓文件
- 使用者培訓教材
- 管理員培訓教材
- 操作流程指南
- 系統功能介紹
- 實際操作案例

## 14. 附錄

### 14.1 術語表
- **WEB015**: Web 化銷售訂單管理系統程式編號
- **Web 化**: 將傳統 AS/400 綠屏介面轉換為網頁介面的過程
- **訂單狀態**: 表示訂單在處理流程中的當前階段
- **審核流程**: 訂單需要經過的審核步驟和層級
- **庫存預留**: 為特定訂單保留庫存的機制

### 14.2 參考資料
- AS/400 系統技術文件
- RPG IV 程式設計指南
- Web 應用程式開發標準
- 銷售訂單管理最佳實踐
- 系統整合設計指南

### 14.3 變更歷史
| 版本 | 日期 | 變更說明 | 變更人 |
|------|------|----------|--------|
| 0.1 | 2023/01/15 | 初稿 | 系統分析師 |
| 0.2 | 2023/02/01 | 新增系統整合需求 | 系統架構師 |
| 0.3 | 2023/02/15 | 修訂效能需求 | 效能工程師 |
| 0.4 | 2023/03/01 | 完善安全需求 | 安全專家 |
| 1.0 | 2023/03/15 | 正式版本 | 專案經理 |
