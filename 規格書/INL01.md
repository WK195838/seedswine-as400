# INL01.txt 程式規格書（含相關檔案分析）

## 1. 基本資訊

- **程式名稱**：INL01
- **程式類型**：CL程式（控制語言程式）
- **程式庫**：REPLIB
- **功能描述**：系統初始化程式，作為系統啟動的入口點
- **建立日期**：1992/01/29
- **程式說明**：INZ PGM (MENU)

## 2. 程式概述

INL01是一個系統初始化程式，作為AS/400系統啟動時的入口點。此程式負責初始化系統環境、顯示初始畫面，並呼叫主選單程式REM000C，引導使用者進入系統。這是整個應用系統的起始點，負責將使用者導向主選單介面。

## 3. 程式流程

```
開始
  |
  ↓
宣告檔案 (WDS000D)
  |
  ↓
覆蓋訊息檔 (OVRMSGF)
  |
  ↓
設定變數 &IN99 = '1'
  |
  ↓
發送初始畫面 (SNDF RCDFMT(SCR001))
  |
  ↓
呼叫主選單程式 (CALL PGM(REM000C))
  |
  ↓
結束
```

## 4. 程式碼分析

### 4.1 檔案宣告

```
DCLF FILE(*LIBL/WDS000D)
```
- 宣告使用WDS000D顯示檔案
- WDS000D是一個確認刪除的顯示檔案，包含SCR001記錄格式
- 此檔案可能在系統初始化時用於顯示歡迎畫面或系統訊息

### 4.2 訊息檔覆蓋

```
OVRMSGF MSGF(QCPFMSG) TOMSGF(PTFLIB/PTMF)
```
- 將系統訊息檔QCPFMSG覆蓋為自定義訊息檔PTFLIB/PTMF
- 目的是提供本地化或自定義的系統訊息
- 這個覆蓋在REM000C中也有使用，確保整個系統使用一致的訊息檔

### 4.3 變數設定

```
CHGVAR VAR(&IN99) VALUE('1')
```
- 設定指示器&IN99為'1'
- 根據WDS000D的定義，當IN99為'1'時，會隱藏某些畫面元素
- 這可能用於控制初始畫面的顯示邏輯

### 4.4 發送初始畫面

```
SNDF RCDFMT(SCR001)
```
- 發送初始畫面，使用SCR001記錄格式
- SCR001在WDS000D中定義，是一個包含系統訊息或確認提示的畫面
- 這可能是系統的歡迎畫面或初始提示

### 4.5 呼叫主選單程式

```
CALL PGM(REM000C)
```
- 呼叫系統主選單程式REM000C
- REM000C是整個系統的主選單控制程式，提供各種功能模組的入口
- 使用者通過REM000C可以訪問系統的所有主要功能

## 5. 相關檔案分析

### 5.1 WDS000D（顯示檔案）

- **功能**：確認刪除的顯示檔案
- **主要記錄格式**：SCR001
- **特點**：
  - 包含閃爍提示和覆蓋功能
  - 使用指示器IN99控制畫面顯示
  - 提供F3（結束）和F14（處理）功能鍵
  - 包含錯誤處理畫面PSSR0001
  - 支援訊息子檔（MSGRCD）

### 5.2 REM000C（主選單控制程式）

- **功能**：系統主選單控制程式
- **主要流程**：
  1. 宣告變數和檔案
  2. 覆蓋訊息檔
  3. 呼叫初始化程式P63和NOM000R
  4. 從LDA獲取使用者資訊和日期
  5. 設定注意程式（SETATNPGM）
  6. 顯示主選單畫面
  7. 根據使用者選擇設定對應的程式名稱
  8. 檢查使用者權限
  9. 呼叫選擇的程式

- **主要功能模組**：
  - 01 - 採購作業 (PAM000C)
  - 02 - 主檔作業 (MTM000C)
  - 03 - 生產系統作業 (POM000C)
  - 04 - 銷售訂單作業 (SOM000C)
  - 05 - 銷售分析作業 (SAM000C)
  - 06 - 庫存系統作業 (IMM000C)
  - 07 - 配送系統作業 (PIM000C)
  - 08 - 應收帳款作業 (ARM000C)
  - 09 - 製造系統作業 (MSOM00C)
  - 其他多個子系統和報表功能

### 5.3 REM000D（主選單顯示檔案）

- **功能**：系統主選單顯示檔案
- **主要記錄格式**：DSPC1
- **特點**：
  - 顯示系統標題「西祺企業管理資訊系統」
  - 顯示日期、時間和使用者資訊
  - 列出所有可用的系統功能模組
  - 提供功能選擇輸入欄位DOPID
  - 支援錯誤訊息顯示

## 6. 系統初始化流程

結合INL01、WDS000D和REM000C的分析，系統的完整初始化流程如下：

1. **INL01啟動**：
   - 宣告WDS000D顯示檔案
   - 覆蓋系統訊息檔
   - 設定指示器IN99
   - 顯示初始畫面SCR001

2. **呼叫REM000C**：
   - REM000C宣告變數和REM000D顯示檔案
   - 覆蓋訊息檔
   - 呼叫P63進行系統初始化
   - 呼叫NOM000R（可能是通知或記錄程式）
   - 從LDA獲取使用者資訊和日期
   - 設定注意程式ATN01

3. **顯示主選單**：
   - REM000C顯示REM000D中定義的主選單畫面
   - 使用者選擇功能模組
   - 系統檢查使用者權限
   - 呼叫對應的功能模組程式

## 7. 程式特點

1. **簡潔性**：INL01程式碼簡短精簡，只執行必要的初始化步驟
2. **入口點**：作為系統的入口點，負責引導使用者進入系統
3. **環境設定**：設定基本的系統環境，如訊息檔案
4. **整合性**：與REM000C和WDS000D緊密整合，形成完整的系統啟動流程

## 8. 系統架構關係

INL01在整個系統架構中的位置：

```
系統啟動
   |
   ↓
 INL01 (初始化程式)
   |
   ↓
REM000C (主選單控制程式)
   |
   ↓
功能模組 (PAM000C, MTM000C, SOM000C等)
```

## 9. 注意事項

1. INL01是系統啟動的關鍵程式，修改時需謹慎
2. 程式依賴WDS000D顯示檔案和REM000C主選單程式
3. 系統使用LDA（本地資料區）儲存使用者資訊和日期
4. 系統使用自定義訊息檔PTFLIB/PTMF替代系統訊息檔

## 10. 建議與改進

1. 可考慮增加錯誤處理機制，如MONMSG命令
2. 可考慮增加系統環境檢查，確保系統正常運行
3. 可考慮增加日誌記錄，追蹤系統啟動情況
4. 可考慮增加系統參數設定，使系統更具彈性

---

此規格書基於INL01.txt、WDS000D.txt和REM000C.txt程式碼的綜合分析。INL01作為系統的入口點，雖然程式碼簡短，但在整個系統架構中扮演著關鍵角色，負責初始化系統環境並引導使用者進入主選單介面。
