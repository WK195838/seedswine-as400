# 程式功能規格書

## 1. 程式基本資訊

| 項目 | 內容 |
|------|------|
| 程式編號 | WEB042 |
| 程式名稱 | Web 化庫存查詢系統 |
| 系統分類 | 網路庫存管理系統 |
| 開發語言 | RPG IV / HTML / JavaScript |
| 資料庫   | DB2 for IBM i |
| 執行平台 | AS/400 與網頁前端 |
| 版本     | 1.0 |

## 2. 程式概述

WEB042 是一個 Web 化庫存查詢系統，主要用於將傳統 AS/400 綠屏的庫存查詢功能轉換為網頁介面，提供更直覺、更便捷的庫存資訊查詢體驗。該程式允許使用者通過網頁瀏覽器查詢庫存資料，包括庫存數量、庫存狀態、庫存位置、庫存變動歷史等資訊，並提供多種查詢條件組合、資料匯出和報表生成功能。

## 3. 功能需求

### 3.1 基本功能

#### 3.1.1 庫存查詢功能
- 按產品代碼查詢庫存
- 按產品類別查詢庫存
- 按倉庫/庫位查詢庫存
- 按庫存狀態查詢庫存
- 按庫存數量範圍查詢庫存

#### 3.1.2 庫存明細顯示
- 顯示產品基本資訊
- 顯示庫存數量資訊
- 顯示庫存位置資訊
- 顯示庫存狀態資訊
- 顯示最後更新資訊

#### 3.1.3 庫存變動歷史查詢
- 查詢庫存入庫記錄
- 查詢庫存出庫記錄
- 查詢庫存調整記錄
- 查詢庫存盤點記錄
- 查詢庫存移轉記錄

#### 3.1.4 庫存統計功能
- 按產品類別統計庫存
- 按倉庫統計庫存
- 按庫存狀態統計庫存
- 按時間段統計庫存變動
- 計算庫存價值

#### 3.1.5 庫存警示功能
- 顯示低於安全庫存的產品
- 顯示超過最大庫存的產品
- 顯示庫存異常的產品
- 顯示長期滯銷的產品
- 顯示即將到期的產品

### 3.2 進階功能

#### 3.2.1 Web 介面功能
- 提供直覺式的 Web 查詢介面
- 支援多種瀏覽器與裝置（響應式設計）
- 提供資料視覺化展示
- 支援自定義查詢條件儲存
- 提供個人化儀表板設定

#### 3.2.2 資料匯出功能
- 匯出 Excel 格式
- 匯出 PDF 格式
- 匯出 CSV 格式
- 匯出 XML 格式
- 支援自定義匯出欄位

#### 3.2.3 報表生成功能
- 庫存現況報表
- 庫存變動報表
- 庫存警示報表
- 庫存價值報表
- 庫存分析報表

#### 3.2.4 系統整合功能
- 與採購系統整合
- 與銷售系統整合
- 與生產系統整合
- 與財務系統整合
- 與條碼/RFID 系統整合

## 4. 資料結構

### 4.1 主要檔案

#### 4.1.1 庫存主檔 (IMISPF)
| 欄位名稱 | 資料類型 | 長度 | 說明 |
|---------|---------|------|------|
| ITEM_CODE | CHAR | 15 | 產品代碼 (主鍵) |
| WAREHOUSE_ID | CHAR | 5 | 倉庫代碼 (主鍵) |
| LOCATION_ID | CHAR | 10 | 庫位代碼 (主鍵) |
| QUANTITY | DECIMAL | 10,2 | 庫存數量 |
| UNIT | CHAR | 5 | 單位 |
| STATUS_CODE | CHAR | 2 | 庫存狀態代碼 |
| LAST_IN_DATE | DATE | - | 最後入庫日期 |
| LAST_OUT_DATE | DATE | - | 最後出庫日期 |
| LAST_COUNT_DATE | DATE | - | 最後盤點日期 |
| UNIT_COST | DECIMAL | 10,2 | 單位成本 |
| TOTAL_VALUE | DECIMAL | 12,2 | 庫存總值 |
| SAFETY_STOCK | DECIMAL | 10,2 | 安全庫存量 |
| MAX_STOCK | DECIMAL | 10,2 | 最大庫存量 |
| LAST_UPDATE_USER | CHAR | 10 | 最後更新人員 |
| LAST_UPDATE_DATE | DATE | - | 最後更新日期 |
| LAST_UPDATE_TIME | TIME | - | 最後更新時間 |

#### 4.1.2 庫存交易檔 (IMITPF)
| 欄位名稱 | 資料類型 | 長度 | 說明 |
|---------|---------|------|------|
| TRANS_ID | CHAR | 15 | 交易編號 (主鍵) |
| TRANS_DATE | DATE | - | 交易日期 |
| TRANS_TIME | TIME | - | 交易時間 |
| TRANS_TYPE | CHAR | 2 | 交易類型代碼 |
| ITEM_CODE | CHAR | 15 | 產品代碼 |
| WAREHOUSE_ID | CHAR | 5 | 倉庫代碼 |
| LOCATION_ID | CHAR | 10 | 庫位代碼 |
| QUANTITY | DECIMAL | 10,2 | 交易數量 |
| UNIT | CHAR | 5 | 單位 |
| UNIT_COST | DECIMAL | 10,2 | 單位成本 |
| TOTAL_VALUE | DECIMAL | 12,2 | 交易總值 |
| REF_DOC_TYPE | CHAR | 2 | 參考單據類型 |
| REF_DOC_NO | CHAR | 15 | 參考單據編號 |
| OPERATOR_ID | CHAR | 10 | 操作人員 |
| REMARKS | VARCHAR | 100 | 備註 |

#### 4.1.3 Web 查詢設定檔 (WEBQRYPF)
| 欄位名稱 | 資料類型 | 長度 | 說明 |
|---------|---------|------|------|
| USER_ID | CHAR | 10 | 使用者代碼 (主鍵) |
| QUERY_ID | CHAR | 10 | 查詢設定代碼 (主鍵) |
| QUERY_NAME | VARCHAR | 50 | 查詢設定名稱 |
| QUERY_TYPE | CHAR | 2 | 查詢類型 |
| QUERY_CONDITION | VARCHAR | 1000 | 查詢條件 (JSON格式) |
| DISPLAY_COLUMNS | VARCHAR | 500 | 顯示欄位 (JSON格式) |
| SORT_ORDER | VARCHAR | 200 | 排序順序 (JSON格式) |
| CREATE_DATE | DATE | - | 建立日期 |
| UPDATE_DATE | DATE | - | 更新日期 |

#### 4.1.4 Web 使用者設定檔 (WEBUSRPF)
| 欄位名稱 | 資料類型 | 長度 | 說明 |
|---------|---------|------|------|
| USER_ID | CHAR | 10 | 使用者代碼 (主鍵) |
| DEFAULT_QUERY | CHAR | 10 | 預設查詢設定 |
| DEFAULT_WAREHOUSE | CHAR | 5 | 預設倉庫 |
| DEFAULT_ITEM_CAT | CHAR | 5 | 預設產品類別 |
| ROWS_PER_PAGE | SMALLINT | - | 每頁顯示筆數 |
| DASHBOARD_LAYOUT | VARCHAR | 1000 | 儀表板配置 (JSON格式) |
| LAST_LOGIN_DATE | DATE | - | 最後登入日期 |
| LAST_LOGIN_TIME | TIME | - | 最後登入時間 |

### 4.2 參考檔案

#### 4.2.1 產品主檔 (MDPRODF)
#### 4.2.2 倉庫主檔 (MDWAREF)
#### 4.2.3 庫位主檔 (MDLOCF)
#### 4.2.4 狀態代碼檔 (SYSCODEF)
#### 4.2.5 使用者主檔 (SYSUSRF)

## 5. 處理流程

### 5.1 庫存查詢流程
1. 使用者登入 Web 系統
2. 系統載入使用者預設設定
3. 使用者選擇查詢條件
4. 系統驗證查詢條件
5. 系統執行查詢
6. 系統顯示查詢結果
7. 使用者可進行排序、篩選或分頁
8. 使用者可儲存查詢條件
9. 使用者可匯出查詢結果

### 5.2 庫存變動歷史查詢流程
1. 使用者在庫存查詢結果中選擇特定產品
2. 使用者請求查看庫存變動歷史
3. 系統載入該產品的庫存交易記錄
4. 系統顯示庫存變動歷史
5. 使用者可按交易類型、日期範圍等篩選
6. 使用者可查看交易詳細資訊
7. 使用者可匯出變動歷史資料

### 5.3 庫存統計報表流程
1. 使用者選擇報表類型
2. 使用者設定報表參數
3. 系統驗證報表參數
4. 系統生成報表資料
5. 系統顯示報表預覽
6. 使用者可調整報表格式
7. 使用者可列印或匯出報表
8. 系統記錄報表生成記錄

### 5.4 庫存警示查詢流程
1. 系統自動檢查庫存警示條件
2. 系統識別符合警示條件的產品
3. 使用者請求查看庫存警示
4. 系統顯示庫存警示清單
5. 使用者可按警示類型篩選
6. 使用者可查看警示詳細資訊
7. 使用者可處理警示事項
8. 系統記錄警示處理狀態

## 6. 使用者介面

### 6.1 網頁前端介面

#### 6.1.1 庫存查詢頁面
- 查詢條件設定區域
- 快速查詢按鈕
- 查詢結果顯示區域
- 分頁控制
- 排序與篩選控制
- 資料匯出按鈕
- 查詢條件儲存功能

#### 6.1.2 庫存明細頁面
- 產品基本資訊區域
- 庫存數量與狀態資訊
- 庫存位置資訊
- 庫存變動歷史摘要
- 相關產品資訊
- 庫存圖表顯示
- 操作按鈕區域

#### 6.1.3 庫存統計頁面
- 統計條件設定區域
- 統計圖表顯示區域
- 統計數據表格
- 資料鑽取功能
- 比較分析功能
- 資料匯出按鈕
- 報表生成按鈕

#### 6.1.4 庫存警示頁面
- 警示類型篩選
- 警示清單顯示
- 警示等級指示
- 警示詳細資訊
- 警示處理功能
- 警示歷史記錄
- 警示報表生成

### 6.2 後端管理介面

#### 6.2.1 系統設定畫面
- 使用者設定管理
- 查詢設定管理
- 報表格式設定
- 警示條件設定
- 系統參數設定
- 權限設定
- 日誌查詢

#### 6.2.2 資料維護畫面
- 庫存資料維護
- 庫存交易記錄維護
- 資料匯入功能
- 資料清理功能
- 資料備份功能
- 資料檢核功能
- 資料修復功能

## 7. 系統整合

### 7.1 與採購系統整合
- 提供庫存資訊給採購決策
- 接收採購入庫資訊
- 提供安全庫存警示
- 支援採購計劃生成
- 提供庫存分析資料

### 7.2 與銷售系統整合
- 提供庫存可用量查詢
- 接收銷售出庫資訊
- 支援銷售承諾日期計算
- 提供庫存預留功能
- 支援銷售分析

### 7.3 與生產系統整合
- 提供原料庫存資訊
- 接收生產領料資訊
- 接收生產入庫資訊
- 支援物料需求計劃
- 提供生產物料分析

### 7.4 與財務系統整合
- 提供庫存價值資訊
- 支援庫存成本計算
- 提供庫存資產報表
- 支援庫存盤點差異處理
- 提供庫存財務分析

## 8. 安全性需求

### 8.1 資料安全
- 庫存資料存取控制
- 敏感資料加密
- 資料傳輸加密
- 定期資料備份
- 資料存取稽核記錄

### 8.2 使用者認證與授權
- 使用者身份驗證
- 角色基礎存取控制
- 功能權限管理
- 資料權限管理
- 登入活動監控

### 8.3 系統安全
- 網路安全防護
- 系統漏洞定期檢測
- 安全更新管理
- 防毒與惡意軟體防護
- 系統安全稽核

## 9. 效能需求

### 9.1 回應時間
- 基本查詢回應時間不超過 2 秒
- 複雜查詢回應時間不超過 5 秒
- 報表生成時間不超過 10 秒
- 資料匯出時間不超過 15 秒
- 頁面載入時間不超過 3 秒

### 9.2 處理能力
- 支援同時 50 位使用者在線查詢
- 每日處理 5,000 次查詢請求
- 支援 100 萬筆庫存記錄
- 支援 1,000 萬筆庫存交易記錄
- 系統可用性達 99.5%

### 9.3 擴展性
- 支援水平擴展
- 模組化設計
- 可配置的查詢流程
- 彈性的資料結構
- 支援未來功能擴展

## 10. 測試需求

### 10.1 功能測試
- 庫存查詢功能測試
- 庫存變動歷史查詢測試
- 庫存統計功能測試
- 庫存警示功能測試
- 資料匯出功能測試

### 10.2 效能測試
- 系統負載測試
- 查詢效能測試
- 資料庫效能測試
- 並發查詢測試
- 長時間運行穩定性測試

### 10.3 安全測試
- 使用者認證測試
- 權限控制測試
- 資料存取控制測試
- 資料加密測試
- 安全漏洞掃描

### 10.4 整合測試
- 與採購系統整合測試
- 與銷售系統整合測試
- 與生產系統整合測試
- 與財務系統整合測試
- 與條碼/RFID 系統整合測試

## 11. 實施計劃

### 11.1 開發階段
1. 需求分析與設計 (2週)
2. 資料庫設計與建置 (1週)
3. 後端程式開發 (3週)
4. 前端介面開發 (3週)
5. 系統整合 (2週)
6. 測試與除錯 (2週)
7. 文件編寫 (1週)

### 11.2 測試階段
1. 單元測試 (1週)
2. 整合測試 (1週)
3. 系統測試 (1週)
4. 使用者接受度測試 (1週)
5. 效能測試 (1週)
6. 安全測試 (1週)

### 11.3 部署階段
1. 環境準備 (1週)
2. 系統部署 (1週)
3. 資料遷移 (1週)
4. 使用者培訓 (1週)
5. 上線準備 (1週)
6. 正式上線 (1天)
7. 上線後支援 (4週)

## 12. 維護計劃

### 12.1 日常維護
- 系統監控與警報
- 資料庫維護與優化
- 系統效能調整
- 安全更新與修補
- 問題追蹤與解決

### 12.2 定期維護
- 每週系統備份
- 每月系統效能評估
- 每季安全稽核
- 每半年系統升級評估
- 每年系統全面檢修

### 12.3 問題處理流程
1. 問題報告接收
2. 問題分類與優先級評估
3. 問題分派與處理
4. 解決方案測試與驗證
5. 解決方案部署
6. 問題解決確認與記錄

## 13. 文件需求

### 13.1 技術文件
- 系統架構文件
- 資料庫設計文件
- 程式設計文件
- API 文件
- 測試文件

### 13.2 使用者文件
- 使用者手冊
- 管理員手冊
- 操作指南
- 常見問題解答
- 故障排除指南

### 13.3 培訓文件
- 使用者培訓教材
- 管理員培訓教材
- 操作流程指南
- 系統功能介紹
- 實際操作案例

## 14. 附錄

### 14.1 術語表
- **WEB042**: Web 化庫存查詢系統程式編號
- **Web 化**: 將傳統 AS/400 綠屏介面轉換為網頁介面的過程
- **庫存交易**: 影響庫存數量變動的操作，如入庫、出庫、調整等
- **安全庫存**: 為防止缺貨而設定的最低庫存量
- **庫存警示**: 當庫存達到特定條件時發出的提醒或警告

### 14.2 參考資料
- AS/400 系統技術文件
- RPG IV 程式設計指南
- Web 應用程式開發標準
- 庫存管理系統設計指南
- 系統整合最佳實踐

### 14.3 變更歷史
| 版本 | 日期 | 變更說明 | 變更人 |
|------|------|----------|--------|
| 0.1 | 2023/01/10 | 初稿 | 系統分析師 |
| 0.2 | 2023/01/25 | 新增系統整合需求 | 系統架構師 |
| 0.3 | 2023/02/10 | 修訂效能需求 | 效能工程師 |
| 0.4 | 2023/02/25 | 完善安全需求 | 安全專家 |
| 1.0 | 2023/03/10 | 正式版本 | 專案經理 |
