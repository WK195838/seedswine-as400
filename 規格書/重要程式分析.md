# 西祺企業經營管理資訊系統重要程式分析

## 1. 系統概述

西祺企業經營管理資訊系統是一個基於AS/400平台開發的企業資源規劃(ERP)系統，主要使用RPG語言和CL程式開發。系統包含多個模組，如銷售訂單管理、採購管理、庫存管理、應收帳款管理等。

## 2. 程式命名規則

系統中的程式按照功能模組和用途進行命名，主要有以下命名規則：

- **SOR系列**：銷售訂單(Sales Order)相關程式
- **WDS系列**：視窗介面(Window Display)查詢程式
- **WOR系列**：工單(Work Order)相關程式
- **VTR系列**：銷售統計(Sales Statistics)報表程式
- **ARM系列**：應收帳款(Accounts Receivable)管理程式
- **APM系列**：應付帳款(Accounts Payable)管理程式
- **PIR系列**：採購入庫(Procurement Inventory Receiving)程式
- **POR系列**：採購訂單(Procurement Order)程式

## 3. 程式結構分析

### 3.1 程式類型

系統中的程式主要分為以下幾種類型：

1. **主程式**：如SOR010、WDS010等，負責主要業務邏輯處理
2. **子程式**：如SOR1601、SOR1602等，負責特定功能的處理
3. **控制程式(CL)**：如SOR160C、SOR160C1等，負責程式的調用和控制
4. **顯示檔案(DSPF)**：如SOR160D等，定義畫面佈局和輸入欄位
5. **印表檔案(PRTF)**：如SOR160P等，定義報表格式

### 3.2 程式間的關係

以SOR160銷售訂單報表程式為例，其程式結構如下：

- **SOR160**：主程式，負責處理用戶輸入的查詢條件
- **SOR160C**：CL控制程式，負責調用SOR160和SOR160C1
- **SOR160C1**：CL子程式，負責報表產生的控制
- **SOR160C2**：CL子程式，可能負責特定功能
- **SOR1601**：RPG子程式，負責產生明細報表
- **SOR1602**：RPG子程式，負責產生彙總報表
- **SOR1603**：RPG子程式，負責產生兩者皆列印的報表
- **SOR160D**：顯示檔案，定義查詢條件畫面
- **SOR160P**：印表檔案，定義報表格式

## 4. 重要程式分析

### 4.1 SOR160 銷售訂單報表程式

**功能**：根據用戶指定的條件產生銷售訂單報表。

**主要特點**：
- 支援多種查詢條件：訂單日期範圍、客戶代碼範圍、產品代碼範圍、訂單狀態等
- 提供三種報表格式：明細報表、彙總報表、兩者皆列印
- 採用模組化設計，主程式負責參數處理和報表控制，子程式負責實際的報表產生

**程式流程**：
1. 用戶輸入查詢條件
2. 系統驗證查詢條件的有效性
3. 根據用戶選擇的報表類型，調用相應的子程式(SOR1601/SOR1602/SOR1603)
4. 子程式從相關檔案中讀取資料，產生報表

### 4.2 WDS系列 視窗介面查詢程式

**功能**：提供視窗化的資料查詢介面。

**主要特點**：
- 統一的使用者介面
- 支援多種查詢條件
- 查詢結果可以被其他程式調用

**代表程式**：
- **WDS010**：產品查詢視窗介面程式
- **WDS020**：客戶查詢視窗介面程式
- **WDS030**：業務員查詢視窗介面程式

### 4.3 WOR系列 工單管理程式

**功能**：處理工廠生產工單的建立、修改、刪除和查詢。

**主要特點**：
- 完整的工單生命週期管理
- 與庫存管理和採購管理模組整合
- 支援工單狀態追蹤和報表產生

**代表程式**：
- **WOR110**：工單報表程式
- **WOR120**：工單查詢程式

## 5. 程式開發特點

通過分析源代碼，可以發現系統開發有以下特點：

1. **模組化設計**：程式按功能模組劃分，每個模組內部又分為多個子程式
2. **標準化命名**：程式命名遵循一定的規則，便於識別和管理
3. **參數傳遞**：程式間通過參數和LDA(Local Data Area)進行資料傳遞
4. **錯誤處理**：程式中包含完善的錯誤處理機制
5. **維護記錄**：程式頭部包含修改歷史記錄，便於追蹤變更

## 6. 建議關注的重要程式

根據分析，以下程式是系統中的核心程式，建議優先關注：

1. **SOR010**：銷售訂單輸入程式，系統核心交易處理程式
2. **POR010**：採購訂單輸入程式，採購管理核心程式
3. **PIR010**：採購入庫程式，庫存管理核心程式
4. **ARM010**：應收帳款管理程式，財務管理核心程式
5. **APM010**：應付帳款管理程式，財務管理核心程式
6. **WDS系列**：視窗介面查詢程式，被多個模組調用
7. **SOR160/SOR170**：銷售訂單報表程式，重要的報表程式

這些程式代表了系統的核心業務流程，對理解整個系統的運作至關重要。 