# S#M000程序規格說明文檔

## 1. 基本資訊

- **程序名稱**：S#M000
- **系統**：西祺企業管理資訊系統 - 系統管理模組
- **子系統**：程序權限管理
- **功能描述**：程序權限管理系統主選單程序
- **開發者**：JEANNY LIN
- **創建日期**：1979/06/26

## 2. 程序結構

S#M000程序是程序權限管理系統的主選單程序，作為整個程序權限管理系統的入口點，它提供了一個選單界面，允許系統管理員選擇不同的權限管理功能。

### 2.1 程序流程

1. 程序啟動後，調用R@S004程序進行初始化
2. 設置注意程序(SETATNPGM)為ATN01
3. 從LDA區域獲取用戶ID和日期資訊
4. 顯示主選單界面(S#M000D)
5. 用戶輸入選項代碼(DOPT)
6. 根據用戶選擇的選項代碼，調用相應的子程序
7. 返回主選單界面，等待用戶下一步操作
8. 如果用戶選擇'90'，則返回上一級選單

## 3. 相關檔案

### 3.1 主要檔案

- **S#M000D**：主選單顯示檔案，定義了選單界面的布局和選項
- **S#A110**：用戶基本資料維護程序
- **S#A120**：用戶權限資料維護程序
- **S#A130**：程序權限資料維護程序
- **S#A140**：程序基本資料維護程序
- **S#R410**、**S#R420**、**S#R430**：報表列印程序
- **S#CP01**、**S#CP02**：資料複製程序
- **ATN01**：系統監控程序

### 3.2 參數定義

主要參數：

| 參數名 | 描述 | 類型 | 備註 |
|-------|------|------|------|
| DOPT | 選項代碼 | 字符(2) | 用戶選擇的功能代碼 |
| USER | 用戶ID | 字符(10) | 當前用戶的識別碼 |
| WDATE | 系統日期 | 字符(6) | 當前系統日期 |
| DSP01 | 顯示參數 | 字符(10) | 用於子程序的顯示參數 |
| IN03 | 功能鍵標誌 | 字符(1) | 用於處理F3功能鍵 |

## 4. 程序功能詳細說明

### 4.1 主選單界面

S#M000D顯示檔案定義了程序權限管理系統的主選單界面，包含以下主要功能區域：

1. **用戶管理**：
   - 01 - 用戶基本資料維護
   - 02 - 用戶權限資料維護

2. **程序管理**：
   - 03 - 程序基本資料維護
   - 04 - 程序權限資料維護

3. **報表列印**：
   - 05 - 按用戶列印權限表
   - 06 - 按程序列印權限表
   - 07 - 權限明細表

4. **資料複製**：
   - 08 - 用戶權限資料複製
   - 09 - 程序權限資料複製

5. **系統功能**：
   - 80 - 系統狀態查詢
   - 90 - 結束

### 4.2 選項處理

S#M000程序根據用戶選擇的選項代碼(DOPT)，調用相應的子程序：

- DOPT='01' → 調用S#A110（用戶基本資料維護）
- DOPT='02' → 調用S#A120（用戶權限資料維護）
- DOPT='03' → 調用S#A140（程序基本資料維護）
- DOPT='04' → 調用S#A130（程序權限資料維護）
- DOPT='05' → 調用S#R410（按用戶列印權限表）
- DOPT='06' → 調用S#R420（按程序列印權限表）
- DOPT='07' → 調用S#R430（權限明細表）
- DOPT='08' → 調用S#CP01（用戶權限資料複製）
- DOPT='09' → 調用S#CP02（程序權限資料複製）
- DOPT='80' → 調用ATN01（系統狀態查詢）
- DOPT='90' → 返回上一級選單

### 4.3 子程序功能

#### 4.3.1 用戶基本資料維護(S#A110)

S#A110程序用於維護系統用戶的基本資料，包括用戶ID、用戶名稱、部門、職位等資訊。它提供了新增、修改、刪除和查詢用戶資料的功能。

#### 4.3.2 用戶權限資料維護(S#A120)

S#A120程序用於維護用戶的權限資料，允許系統管理員為特定用戶分配或撤銷對特定程序的訪問權限。

#### 4.3.3 程序基本資料維護(S#A140)

S#A140程序用於維護系統中程序的基本資料，包括程序ID、程序名稱、功能描述等資訊。

#### 4.3.4 程序權限資料維護(S#A130)

S#A130程序用於維護程序的權限資料，允許系統管理員定義哪些用戶可以訪問特定程序。

#### 4.3.5 報表列印程序

- S#R410：按用戶列印權限表，顯示特定用戶擁有的所有程序訪問權限
- S#R420：按程序列印權限表，顯示特定程序的所有授權用戶
- S#R430：權限明細表，提供系統中所有用戶和程序的權限對應關係

#### 4.3.6 資料複製程序

- S#CP01：用戶權限資料複製，允許將一個用戶的權限設置複製到另一個用戶
- S#CP02：程序權限資料複製，允許將一個程序的權限設置複製到另一個程序

#### 4.3.7 系統狀態查詢(ATN01)

ATN01程序提供了系統狀態查詢功能，包括：
- 訊息查詢
- 輸出查詢
- 作業查詢
- 活動作業
- 下班簽退
- 密碼修改
- 啟動印表機
- 列印控制
- 遠端連線

## 5. 業務規則

### 5.1 用戶權限管理

系統採用基於角色的訪問控制模型，每個用戶可以被授予對特定程序的訪問權限。權限管理遵循以下原則：

- 默認情況下，用戶沒有任何程序的訪問權限
- 系統管理員可以為用戶分配程序訪問權限
- 權限可以按用戶或按程序進行管理
- 權限設置可以通過複製功能快速應用到多個用戶或程序

### 5.2 系統監控

系統監控功能(ATN01)提供了對系統狀態的全面監控，包括訊息、輸出、作業等資訊，幫助系統管理員及時發現和解決問題。

## 6. 界面說明

S#M000D顯示檔案定義了程序權限管理系統的主選單界面，主要包括：

1. 標題區域：顯示系統名稱、日期和用戶ID
2. 選項區域：列出所有可用的功能選項，分為用戶管理、程序管理、報表列印、資料複製和系統功能五個部分
3. 輸入區域：用戶輸入選項代碼(DOPT)
4. 訊息區域：顯示錯誤訊息或提示訊息

## 7. 數據流向

1. 用戶輸入選項代碼(DOPT) → S#M000程序
2. S#M000程序 → 子程序(S#A110等)
3. 子程序 → 數據檔案(S#SUPF等)
4. 報表程序 → 列印輸出

## 8. 安全與權限

程序權限管理系統本身就是一個安全控制系統，它通過以下機制確保系統安全：

1. 用戶身份驗證：確保只有授權用戶才能訪問系統
2. 程序訪問控制：限制用戶只能訪問其被授權的程序
3. 權限管理：提供靈活的權限分配和撤銷機制
4. 系統監控：監控系統狀態，及時發現異常情況

## 9. 維護建議

1. 考慮更新界面設計，提高用戶體驗
2. 增強錯誤處理機制，提供更詳細的錯誤訊息
3. 考慮添加日誌記錄功能，便於問題追蹤
4. 可以考慮將硬編碼的程序名稱改為配置參數，提高靈活性
5. 增加更多的選項說明和幫助功能，幫助用戶更好地理解和使用系統
6. 考慮增加批量權限管理功能，提高管理效率

## 10. 總結

S#M000程序是西祺企業管理資訊系統系統管理模組中的重要組成部分，作為程序權限管理系統的入口點，它提供了一個統一的界面，允許系統管理員訪問各種權限管理功能。程序設計遵循了AS/400系統的典型架構，使用多個相互關聯的程序和檔案完成業務功能。

程序權限管理系統涵蓋了用戶管理、程序管理、報表列印、資料複製和系統功能等方面，為企業提供了全面的權限管理解決方案。系統的模塊化設計使得各個功能可以獨立運行，同時又能通過主選單程序進行統一管理，確保了系統的安全性和可維護性。