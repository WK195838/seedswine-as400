# S#I310程序規格書

## 1. 基本信息

| 項目 | 內容 |
|------|------|
| 程序ID | S#I310 |
| 程序名稱 | 程序基本資料維護查詢 |
| 所屬系統 | 西祺企業管理資訊系統 |
| 所屬子系統 | 程序權限管理系統 |
| 開發者 | A1062 JEANNY LIN |
| 創建日期 | 79/07/02 (民國79年7月2日) |
| 最後更新 | 未指定 |
| 程序語言 | RPG |
| 程序位置 | QRPGSRC_REPLIB/S#I310.txt |

## 2. 程序概述

S#I310程序是西祺企業管理資訊系統中的一個系統管理工具，主要用於查詢和維護系統中的程序基本資料。該程序提供了一個子文件(Subfile)界面，允許系統管理員瀏覽、查詢系統中所有程序的基本信息，包括程序ID、程序名稱、程序類型、程序說明等。這是系統管理和維護的重要工具，有助於系統管理員了解系統結構和程序組成。

## 3. 系統架構

### 3.1 位置關係
S#I310程序位於程序權限管理系統中，是系統管理模塊的一部分，可能從系統管理菜單中訪問。

### 3.2 調用關係
- **被調用方式**：可能從系統管理菜單或其他程序調用
- **調用其他程序**：無明確調用其他程序的證據
- **相關文件**：
  - S#SPPF - 程序主檔
  - S#SUPF - 使用者主檔
  - S#SDPF - 程序權限主檔
  - S#I310D - 顯示文件

### 3.3 運行環境
- **操作系統**：IBM AS/400
- **運行庫**：REPLIB
- **所需資源**：
  - S#SPPF、S#SUPF、S#SDPF數據文件

## 4. 程序流程

### 4.1 主要流程
1. 初始化程序環境(RTN010)
2. 處理用戶操作循環：
   - 初始化子文件(RTN100)
   - 添加子文件數據(RTN200)
   - 顯示子文件界面(RTN300)
   - 處理用戶選擇(RTN400)
3. 根據功能鍵處理不同操作：
   - 上下翻頁(F7/F8)
   - 退出(F3)
   - 選擇特定程序

### 4.2 流程圖
```
開始
  ↓
初始化程序環境(RTN010)
  ↓
用戶操作循環 ← 處理功能鍵
  ↓             ↑
初始化子文件(RTN100)
  ↓
添加子文件數據(RTN200)
  ↓
顯示子文件界面(RTN300)
  ↓
處理用戶選擇(RTN400) → 用戶選擇退出 → 結束
```

## 5. 參數說明

| 參數名 | 類型 | 長度 | 說明 | 必填 | 預設值 |
|--------|------|------|------|------|--------|
| DSP01 | CHAR | 10 | 輸入參數，可能是初始顯示的程序ID | 輸入 | 無 |
| *IN03 | IND | 1 | 輸出參數，退出標誌 | 輸出 | '0' |

## 6. 程序代碼說明

### 6.1 主要變數

| 變數名 | 類型 | 長度 | 說明 |
|--------|------|------|------|
| CENTER | CHAR | 10 | 中心用戶ID |
| USER | CHAR | 10 | 當前用戶ID |
| DDATE | CHAR | 6 | 當前日期 |
| WSD01 | CHAR | 10 | 程序權限主檔鍵值1(用戶ID) |
| WSD02 | CHAR | 10 | 程序權限主檔鍵值2(程序ID) |
| DRRN | NUM | ? | 子文件相對記錄號 |
| A03 | 陣列 | 3x8 | 程序類型描述陣列 |

### 6.2 子程序說明

#### 6.2.1 RTN010 - 初始化程序
- 初始化程序環境和變數
- 設置初始顯示條件

#### 6.2.2 RTN100 - 初始化子文件
- 清除子文件
- 設置子文件控制指示符

#### 6.2.3 RTN200 - 添加子文件數據
- 讀取程序主檔(S#SPPF)數據
- 格式化數據並添加到子文件
- 處理分頁邏輯

#### 6.2.4 RTN300 - 顯示子文件界面
- 顯示子文件控制記錄
- 處理功能鍵和用戶輸入

#### 6.2.5 RTN400 - 處理用戶選擇
- 處理用戶選擇的程序
- 可能返回選擇結果給調用程序

## 7. 錯誤處理

### 7.1 程序內部錯誤處理
- 處理文件訪問錯誤
- 處理用戶輸入錯誤
- 處理分頁邊界條件

### 7.2 可能的錯誤情況
- 程序主檔為空
- 用戶無權訪問特定程序
- 顯示文件錯誤

## 8. 安全考慮

### 8.1 訪問控制
- 程序應只允許系統管理員使用
- 可能通過S#S01權限檢查程序控制訪問權限

### 8.2 數據安全
- 程序僅提供查詢功能，不修改系統關鍵數據
- 顯示的程序信息應根據用戶權限過濾

## 9. 性能考慮

### 9.1 執行效率
- 使用子文件提高顯示效率
- 分頁顯示減少數據傳輸量

### 9.2 資源消耗
- CPU使用率：低
- 內存使用：低
- I/O操作：中等（讀取程序主檔）

## 10. 測試要點

### 10.1 單元測試
- 測試程序信息顯示
- 測試分頁功能
- 測試選擇功能
- 測試返回值

### 10.2 集成測試
- 與系統管理菜單的集成
- 與權限管理其他功能的集成

## 11. 維護建議

### 11.1 日常維護
- 定期檢查程序是否正常運行
- 監控程序主檔數據的完整性

### 11.2 功能擴展建議
- 增加搜索功能，方便快速定位特定程序
- 增加排序功能，按不同條件排序顯示
- 增加程序詳細信息查看功能
- 增加程序關係圖顯示功能

## 12. 相關文檔

### 12.1 系統文檔
- 西祺企業管理資訊系統技術手冊
- 程序權限管理系統使用指南
- IBM AS/400 RPG編程指南

### 12.2 技術參考
- AS/400子文件設計指南
- 系統程序管理最佳實踐

## 13. 版本歷史

| 版本號 | 更新日期 | 更新內容 | 更新者 |
|--------|----------|----------|--------|
| 1.0 | 79/07/02 | 初始版本 | A1062 JEANNY LIN |

## 14. 附錄

### 14.1 顯示界面說明
- 頁眉：包含系統名稱、程序名稱、日期、時間
- 子文件：顯示程序列表，包含程序ID、程序名稱、程序類型等信息
- 功能鍵：F3=退出，F7=上頁，F8=下頁

### 14.2 數據文件結構
- S#SPPF（程序主檔）：
  - SP01：程序編號
  - SP02：程序名稱
  - SP03：程序類型（M=主程序，P=子程序，其他）
  - SP04-SP06：程序說明

- S#SUPF（使用者主檔）：
  - SU01：使用者編號
  - SU02：使用者名稱
  - SU03：上級主管編號

- S#SDPF（程序權限主檔）：
  - SD01：使用者編號
  - SD02：程序編號
  - SD03-SD09：權限標誌

### 14.3 程序類型說明
- 主程序(M)：系統主要功能程序
- 子程序(P)：被其他程序調用的程序
- 其他：其他類型程序

### 14.4 調用示例
```
CALL S#I310 PARM('程序ID' *IN03)
```

## 15. 結語

S#I310程序作為西祺企業管理資訊系統中的程序基本資料維護查詢工具，提供了重要的系統管理功能。它允許系統管理員查詢和了解系統中所有程序的基本信息，有助於系統的維護和管理。程序採用子文件技術提供了高效的用戶界面，支持分頁瀏覽和選擇操作。建議在未來的系統升級中，考慮擴展其功能，增加更多的查詢條件和顯示選項，以滿足不斷發展的系統管理需求。