# 程式功能規格書

## 1. 程式基本資訊

| 項目 | 內容 |
|------|------|
| 程式編號 | WEB043 |
| 程式名稱 | Web 化訂單處理系統 |
| 系統分類 | 網路訂單管理系統 |
| 開發語言 | RPG IV / HTML / JavaScript |
| 資料庫   | DB2 for IBM i |
| 執行平台 | AS/400 與網頁前端 |
| 版本     | 1.0 |

## 2. 程式概述

WEB043 是一個 Web 化訂單處理系統，主要用於處理客戶通過網站提交的訂單。該程式負責接收客戶在網站上提交的訂單資訊，處理訂單資料，管理訂單狀態，並與後端生產系統整合，實現從訂單接收到生產安排的完整流程。系統將傳統的 AS/400 訂單處理功能轉換為 Web 化介面，提供更便捷的使用者體驗。

## 3. 功能需求

### 3.1 基本功能

#### 3.1.1 訂單接收功能
- 接收客戶通過網站提交的訂單資訊
- 驗證訂單資料格式與完整性
- 支援多種產品類型訂購
- 生成唯一訂單編號
- 記錄訂單基本資訊（客戶資料、訂購日期、預計完成日期等）

#### 3.1.2 訂單明細管理
- 記錄訂單明細資訊（產品、數量、規格等）
- 支援多種產品類型與規格
- 計算訂單金額（含稅金、運費等）
- 管理訂單折扣與優惠券
- 記錄訂單付款資訊

#### 3.1.3 訂單狀態管理
- 追蹤訂單處理狀態（已接收、處理中、已完成、已出貨等）
- 自動更新訂單狀態
- 記錄訂單處理歷程
- 處理訂單變更與取消
- 生成訂單狀態通知

#### 3.1.4 生產排程整合
- 將訂單資訊傳送至生產系統
- 根據訂單優先級和工作量安排生產排程
- 監控生產進度
- 處理生產異常情況
- 更新訂單生產狀態

#### 3.1.5 客戶通知功能
- 生成訂單確認通知
- 發送訂單狀態更新通知
- 發送訂單完成通知
- 發送出貨通知
- 處理客戶查詢回應

### 3.2 進階功能

#### 3.2.1 Web 介面功能
- 提供直覺式的 Web 訂單輸入介面
- 支援多種瀏覽器與裝置（響應式設計）
- 提供即時訂單狀態查詢
- 支援線上訂單修改
- 提供訂單歷史查詢

#### 3.2.2 批次處理功能
- 批次訂單匯入處理
- 批次訂單狀態更新
- 批次生產排程安排
- 批次客戶通知發送
- 批次報表生成

#### 3.2.3 報表與分析功能
- 訂單統計報表
- 生產效率分析
- 客戶訂購行為分析
- 產品銷售分析
- 營收與利潤分析

#### 3.2.4 系統整合功能
- 與客戶關係管理系統整合
- 與庫存管理系統整合
- 與財務系統整合
- 與物流系統整合
- 與行動應用程式整合

## 4. 資料結構

### 4.1 主要檔案

#### 4.1.1 訂單主檔 (WEBORDPF)
| 欄位名稱 | 資料類型 | 長度 | 說明 |
|---------|---------|------|------|
| ORDER_ID | CHAR | 10 | 訂單編號 (主鍵) |
| CUST_ID | CHAR | 10 | 客戶編號 |
| ORDER_DATE | DATE | - | 訂單日期 |
| EXPECTED_DATE | DATE | - | 預計完成日期 |
| ORDER_STATUS | CHAR | 2 | 訂單狀態代碼 |
| TOTAL_AMOUNT | DECIMAL | 10,2 | 訂單總金額 |
| DISCOUNT_AMOUNT | DECIMAL | 8,2 | 折扣金額 |
| TAX_AMOUNT | DECIMAL | 8,2 | 稅金 |
| SHIPPING_FEE | DECIMAL | 8,2 | 運費 |
| PAYMENT_METHOD | CHAR | 2 | 付款方式代碼 |
| PAYMENT_STATUS | CHAR | 1 | 付款狀態 |
| SHIPPING_METHOD | CHAR | 2 | 運送方式代碼 |
| TRACKING_NUMBER | CHAR | 20 | 追蹤編號 |
| REMARKS | VARCHAR | 200 | 備註 |
| CREATE_USER | CHAR | 10 | 建立人員 |
| CREATE_DATE | DATE | - | 建立日期 |
| CREATE_TIME | TIME | - | 建立時間 |
| UPDATE_USER | CHAR | 10 | 更新人員 |
| UPDATE_DATE | DATE | - | 更新日期 |
| UPDATE_TIME | TIME | - | 更新時間 |

#### 4.1.2 訂單明細檔 (WEBORDDF)
| 欄位名稱 | 資料類型 | 長度 | 說明 |
|---------|---------|------|------|
| ORDER_ID | CHAR | 10 | 訂單編號 (外鍵) |
| LINE_NO | SMALLINT | - | 明細行號 |
| PRODUCT_CODE | CHAR | 10 | 產品代碼 |
| PRODUCT_SPEC | CHAR | 10 | 產品規格 |
| QUANTITY | SMALLINT | - | 數量 |
| UNIT_PRICE | DECIMAL | 8,2 | 單價 |
| SPECIAL_REQ | CHAR | 5 | 特殊需求代碼 |
| REMARKS | VARCHAR | 100 | 備註 |
| PROCESS_STATUS | CHAR | 1 | 處理狀態 |
| CREATE_USER | CHAR | 10 | 建立人員 |
| CREATE_DATE | DATE | - | 建立日期 |
| CREATE_TIME | TIME | - | 建立時間 |

#### 4.1.3 訂單附件檔 (WEBATTF)
| 欄位名稱 | 資料類型 | 長度 | 說明 |
|---------|---------|------|------|
| ATTACH_ID | CHAR | 20 | 附件識別碼 (主鍵) |
| ORDER_ID | CHAR | 10 | 訂單編號 (外鍵) |
| LINE_NO | SMALLINT | - | 明細行號 |
| ORIGINAL_FILENAME | VARCHAR | 100 | 原始檔名 |
| FILE_FORMAT | CHAR | 5 | 檔案格式 |
| FILE_SIZE | INTEGER | - | 檔案大小 (KB) |
| UPLOAD_DATE | DATE | - | 上傳日期 |
| UPLOAD_TIME | TIME | - | 上傳時間 |
| STORAGE_PATH | VARCHAR | 200 | 儲存路徑 |
| PROCESS_FLAG | CHAR | 1 | 處理標記 |

#### 4.1.4 訂單狀態歷程檔 (WEBORDSHF)
| 欄位名稱 | 資料類型 | 長度 | 說明 |
|---------|---------|------|------|
| ORDER_ID | CHAR | 10 | 訂單編號 (外鍵) |
| STATUS_SEQ | SMALLINT | - | 狀態序號 |
| STATUS_CODE | CHAR | 2 | 狀態代碼 |
| STATUS_DATE | DATE | - | 狀態日期 |
| STATUS_TIME | TIME | - | 狀態時間 |
| OPERATOR_ID | CHAR | 10 | 操作人員 |
| REMARKS | VARCHAR | 100 | 備註 |

### 4.2 參考檔案

#### 4.2.1 客戶主檔 (MDCUSTF)
#### 4.2.2 產品主檔 (MDPRODF)
#### 4.2.3 狀態代碼檔 (SYSCODEF)
#### 4.2.4 付款方式檔 (SYSPAYF)
#### 4.2.5 運送方式檔 (SYSSHIPF)

## 5. 處理流程

### 5.1 訂單接收流程
1. 客戶通過網站填寫訂單資訊並提交
2. 系統驗證訂單資料完整性
3. 系統生成唯一訂單編號
4. 系統記錄訂單基本資訊
5. 系統計算訂單金額
6. 系統處理付款資訊
7. 系統發送訂單確認通知
8. 系統將訂單資訊傳送至後端處理系統

### 5.2 訂單處理流程
1. 後端系統接收訂單資訊
2. 系統驗證訂單資料完整性
3. 系統更新訂單狀態為「處理中」
4. 系統根據訂單內容安排生產排程
5. 系統監控生產進度
6. 系統處理生產異常情況
7. 系統更新訂單狀態為「已完成」
8. 系統發送訂單完成通知

### 5.3 訂單出貨流程
1. 系統接收生產完成通知
2. 系統生成出貨單
3. 系統更新訂單狀態為「已出貨」
4. 系統記錄運送資訊
5. 系統發送出貨通知
6. 系統監控運送狀態
7. 系統更新訂單狀態為「已送達」
8. 系統發送送達通知

### 5.4 訂單查詢流程
1. 客戶提交訂單查詢請求
2. 系統驗證客戶身份
3. 系統檢索訂單資訊
4. 系統顯示訂單狀態與明細
5. 系統提供訂單追蹤資訊
6. 系統記錄查詢活動

## 6. 使用者介面

### 6.1 網頁前端介面

#### 6.1.1 訂單輸入頁面
- 客戶資訊輸入區域
- 產品選擇區域
- 產品規格設定區域
- 數量與價格顯示區域
- 附件上傳功能
- 訂單摘要顯示區域

#### 6.1.2 訂單確認頁面
- 訂單摘要資訊
- 產品明細資訊
- 金額明細
- 付款資訊輸入
- 運送資訊輸入

#### 6.1.3 訂單狀態查詢頁面
- 訂單查詢條件輸入
- 訂單列表顯示
- 訂單詳細資訊顯示
- 訂單狀態追蹤顯示
- 訂單歷程顯示

### 6.2 後端管理介面

#### 6.2.1 訂單管理畫面
- 訂單查詢條件
- 訂單列表顯示
- 訂單詳細資訊顯示
- 訂單狀態更新功能
- 訂單處理功能

#### 6.2.2 生產排程畫面
- 待處理訂單列表
- 生產排程安排功能
- 生產進度監控功能
- 生產異常處理功能
- 生產完成確認功能

#### 6.2.3 報表與分析畫面
- 報表條件設定
- 報表顯示區域
- 圖表顯示區域
- 資料匯出功能
- 報表列印功能

## 7. 系統整合

### 7.1 與客戶關係管理系統整合
- 共享客戶基本資料
- 同步客戶訂購歷史
- 提供客戶偏好分析
- 支援客戶忠誠度計劃
- 協助客戶服務處理

### 7.2 與庫存管理系統整合
- 檢查產品庫存狀態
- 更新庫存使用情況
- 觸發庫存補充請求
- 監控庫存水平
- 預測庫存需求

### 7.3 與財務系統整合
- 處理訂單付款資訊
- 生成銷售記錄
- 處理退款請求
- 提供銷售報表資料
- 支援財務分析

### 7.4 與物流系統整合
- 生成出貨資訊
- 追蹤運送狀態
- 處理運送異常
- 提供運送成本分析
- 優化運送路線

## 8. 安全性需求

### 8.1 資料安全
- 客戶資料加密儲存
- 訂單資料安全存取控制
- 資料傳輸加密
- 定期資料備份
- 資料存取稽核記錄

### 8.2 使用者認證與授權
- 使用者身份驗證
- 角色基礎存取控制
- 權限管理機制
- 密碼安全政策
- 登入活動監控

### 8.3 系統安全
- 網路安全防護
- 系統漏洞定期檢測
- 安全更新管理
- 防毒與惡意軟體防護
- 系統安全稽核

## 9. 效能需求

### 9.1 回應時間
- 網頁載入時間不超過 3 秒
- 訂單提交回應時間不超過 5 秒
- 訂單處理回應時間不超過 2 秒
- 查詢回應時間不超過 2 秒
- 報表生成時間不超過 10 秒

### 9.2 處理能力
- 支援同時 100 位使用者在線
- 每日處理 1,000 筆訂單
- 每小時處理 500 筆訂單
- 系統可用性達 99.9%
- 支援高峰期每分鐘 50 筆訂單

### 9.3 擴展性
- 支援水平擴展
- 模組化設計
- 可配置的處理流程
- 彈性的資料結構
- 支援未來功能擴展

## 10. 測試需求

### 10.1 功能測試
- 訂單接收功能測試
- 訂單處理功能測試
- Web 介面功能測試
- 訂單狀態管理測試
- 客戶通知功能測試

### 10.2 效能測試
- 系統負載測試
- 訂單提交效能測試
- 資料庫查詢效能測試
- 並發處理能力測試
- 長時間運行穩定性測試

### 10.3 安全測試
- 資料加密測試
- 使用者認證測試
- 權限控制測試
- 資料存取控制測試
- 安全漏洞掃描

### 10.4 整合測試
- 與客戶關係管理系統整合測試
- 與庫存管理系統整合測試
- 與財務系統整合測試
- 與物流系統整合測試
- 與行動應用程式整合測試

## 11. 實施計劃

### 11.1 開發階段
1. 需求分析與設計 (2週)
2. 資料庫設計與建置 (1週)
3. 後端程式開發 (4週)
4. 前端介面開發 (3週)
5. 系統整合 (2週)
6. 測試與除錯 (3週)
7. 文件編寫 (1週)

### 11.2 測試階段
1. 單元測試 (1週)
2. 整合測試 (1週)
3. 系統測試 (2週)
4. 使用者接受度測試 (1週)
5. 效能測試 (1週)
6. 安全測試 (1週)

### 11.3 部署階段
1. 環境準備 (1週)
2. 系統部署 (1週)
3. 資料遷移 (1週)
4. 使用者培訓 (1週)
5. 上線準備 (1週)
6. 正式上線 (1天)
7. 上線後支援 (4週)

## 12. 維護計劃

### 12.1 日常維護
- 系統監控與警報
- 資料庫維護與優化
- 系統效能調整
- 安全更新與修補
- 問題追蹤與解決

### 12.2 定期維護
- 每週系統備份
- 每月系統效能評估
- 每季安全稽核
- 每半年系統升級評估
- 每年系統全面檢修

### 12.3 問題處理流程
1. 問題報告接收
2. 問題分類與優先級評估
3. 問題分派與處理
4. 解決方案測試與驗證
5. 解決方案部署
6. 問題解決確認與記錄

## 13. 文件需求

### 13.1 技術文件
- 系統架構文件
- 資料庫設計文件
- 程式設計文件
- API 文件
- 測試文件

### 13.2 使用者文件
- 使用者手冊
- 管理員手冊
- 操作指南
- 常見問題解答
- 故障排除指南

### 13.3 培訓文件
- 使用者培訓教材
- 管理員培訓教材
- 操作流程指南
- 系統功能介紹
- 實際操作案例

## 14. 附錄

### 14.1 術語表
- **WEB043**: Web 化訂單處理系統程式編號
- **Web 化**: 將傳統 AS/400 綠屏介面轉換為網頁介面的過程
- **訂單狀態**: 表示訂單在處理流程中的當前階段
- **生產排程**: 安排訂單的處理順序和時間
- **批次處理**: 同時處理多個訂單的操作

### 14.2 參考資料
- AS/400 系統技術文件
- RPG IV 程式設計指南
- Web 應用程式開發標準
- 訂單處理系統設計指南
- 系統整合最佳實踐

### 14.3 變更歷史
| 版本 | 日期 | 變更說明 | 變更人 |
|------|------|----------|--------|
| 0.1 | 2023/01/15 | 初稿 | 系統分析師 |
| 0.2 | 2023/02/01 | 新增系統整合需求 | 系統架構師 |
| 0.3 | 2023/02/15 | 修訂效能需求 | 效能工程師 |
| 0.4 | 2023/03/01 | 完善安全需求 | 安全專家 |
| 1.0 | 2023/03/15 | 正式版本 | 專案經理 |
