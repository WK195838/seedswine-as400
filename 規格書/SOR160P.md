# SOR160P - 銷售訂單入庫報表打印檔規格書

## 基本資訊
- **檔案名稱**：SOR160P
- **檔案類型**：PRTF（打印檔）
- **所屬資料庫**：REPLIB
- **功能說明**：銷售訂單入庫報表打印格式定義
- **相關程式**：
  - SOR1602（報表格式1生成程式）
  - SOR1603（報表格式2生成程式）
- **系統名稱**：西祺企業經營管理資訊系統
- **子系統**：銷售訂單管理系統
- **作者**：EASON
- **建立日期**：96/09/06
- **最後修改日期**：00/11/08
- **功能特點**：定義銷售訂單入庫報表的打印格式，支持多種報表格式。

## 檔案概述
SOR160P是西祺企業經營管理資訊系統中銷售訂單入庫報表程式(SOR160系列)的打印檔，用於定義銷售訂單入庫報表的打印格式。該打印檔定義了報表的頁面布局、標題、欄位標題、明細行格式、小計和合計格式等，為報表生成程式（SOR1602和SOR1603）提供打印格式定義。

SOR160P支持兩種報表格式：按客戶分組的報表格式（由SOR1602使用）和按商品分組的報表格式（由SOR1603使用）。通過不同的記錄格式定義，實現不同的報表布局和內容展示。

## 報表布局

### 1. 報表標題（TITLE）
```
                                        西祺企業經營管理資訊系統                                        頁次：   1
                                          銷售訂單入庫報表                                           日期：20XX/XX/XX
查詢條件：交易類型=全部  客戶=全部  商品=全部  業務員=全部  日期範圍=20XX/XX/XX-20XX/XX/XX
```

### 2. 按客戶分組報表格式（FORMAT1）
```
客戶：XXXXXX  XXXXXXXXXXXXXXXXXXXX

訂單號碼  項次  商品代碼            商品名稱                      數量      單價      金額      業務員
---------  ---  ---------------  ----------------------------  ---------  ---------  ---------  --------
XXXXXXXXX  XXX  XXXXXXXXXXXXXXX  XXXXXXXXXXXXXXXXXXXXXXXXXXXX  99,999.99  99,999.99  99,999.99  XXXX
XXXXXXXXX  XXX  XXXXXXXXXXXXXXX  XXXXXXXXXXXXXXXXXXXXXXXXXXXX  99,999.99  99,999.99  99,999.99  XXXX
                                                               ---------              ---------
                                                 客戶小計：     99,999.99            999,999.99

客戶：XXXXXX  XXXXXXXXXXXXXXXXXXXX
...

                                                 報表合計：     99,999.99          9,999,999.99
```

### 3. 按商品分組報表格式（FORMAT2）
```
商品：XXXXXXXXXXXXXXX  XXXXXXXXXXXXXXXXXXXXXXXXXXXX

訂單號碼  項次  客戶代碼  客戶名稱                      數量      單價      金額      業務員
---------  ---  --------  ----------------------------  ---------  ---------  ---------  --------
XXXXXXXXX  XXX  XXXXXX    XXXXXXXXXXXXXXXXXXXXXXXXXXXX  99,999.99  99,999.99  99,999.99  XXXX
XXXXXXXXX  XXX  XXXXXX    XXXXXXXXXXXXXXXXXXXXXXXXXXXX  99,999.99  99,999.99  99,999.99  XXXX
                                                        ---------              ---------
                                                商品小計：99,999.99            999,999.99

商品：XXXXXXXXXXXXXXX  XXXXXXXXXXXXXXXXXXXXXXXXXXXX
...

                                                 報表合計：     99,999.99          9,999,999.99
```

## DDS定義
SOR160P的DDS定義包括以下主要部分：

### 1. 檔案級別定義
```DDS
A                                      REF(REWF2)
A                                      PAGESIZE(66 132)
A                                      FOLDRST(1)
A                                      OVRFLW(60)
```

### 2. 標題記錄格式定義
```DDS
A          R TITLE
A                                      SKIPB(1)
A                                      SPACEA(1)
A                                     33'西祺企業經營管理資訊系統'
A                                    110'頁次：'
A            PAGE          4S 0      116EDTCDE(Z)
A                                      SPACEA(1)
A                                     39'銷售訂單入庫報表'
A                                    110'日期：'
A            PDATE         8A        116
A                                      SPACEA(1)
A                                      SPACEA(1)
A                                      SPACEA(1)
```

### 3. 按客戶分組報表格式定義（FORMAT1）
```DDS
A          R FORMAT1                   SPACEA(1)
A                                      SPACEB(1)
A                                  1'客戶：'
A            CUST           6A      8
A            CUSNM         30A     16
A                                      SPACEA(2)
A                                  1'訂單號碼'
A                                 12'項次'
A                                 18'商品代碼'
A                                 36'商品名稱'
A                                 68'數量'
A                                 80'單價'
A                                 92'金額'
A                                106'業務員'
A                                      SPACEA(1)
A                                  1'---------'
A                                 12'---'
A                                 18'---------------'
A                                 36'----------------------------'
A                                 68'---------'
A                                 80'---------'
A                                 92'---------'
A                                106'--------'
```

### 4. 按客戶分組報表明細記錄格式定義（DETAIL1）
```DDS
A          R DETAIL1                   SPACEA(1)
A            SONUM          9A      1
A            SOITEM         3A     12
A            PROD          15A     18
A            PTDESC        30A     36
A            QTY           9P 2    68EDTCDE(J)
A            PRICE         9P 2    80EDTCDE(J)
A            AMT           9P 2    92EDTCDE(J)
A            SLMN          4A     106
```

### 5. 按客戶分組報表小計記錄格式定義（SUBTOT1）
```DDS
A          R SUBTOT1                   SPACEA(1)
A                                 68'---------'
A                                 92'---------'
A                                      SPACEA(1)
A                                 53'客戶小計：'
A            TOTQTY         9P 2   68EDTCDE(J)
A            TOTAMT        11P 2   92EDTCDE(J)
A                                      SPACEA(2)
```

### 6. 按商品分組報表格式定義（FORMAT2）
```DDS
A          R FORMAT2                   SPACEA(1)
A                                      SPACEB(1)
A                                  1'商品：'
A            PROD          15A      8
A            PTDESC        30A     25
A                                      SPACEA(2)
A                                  1'訂單號碼'
A                                 12'項次'
A                                 18'客戶代碼'
A                                 28'客戶名稱'
A                                 60'數量'
A                                 72'單價'
A                                 84'金額'
A                                 98'業務員'
A                                      SPACEA(1)
A                                  1'---------'
A                                 12'---'
A                                 18'--------'
A                                 28'----------------------------'
A                                 60'---------'
A                                 72'---------'
A                                 84'---------'
A                                 98'--------'
```

### 7. 按商品分組報表明細記錄格式定義（DETAIL2）
```DDS
A          R DETAIL2                   SPACEA(1)
A            SONUM          9A      1
A            SOITEM         3A     12
A            CUST           6A     18
A            CUSNM         30A     28
A            QTY           9P 2    60EDTCDE(J)
A            PRICE         9P 2    72EDTCDE(J)
A            AMT           9P 2    84EDTCDE(J)
A            SLMN          4A     98
```

### 8. 按商品分組報表小計記錄格式定義（SUBTOT2）
```DDS
A          R SUBTOT2                   SPACEA(1)
A                                 60'---------'
A                                 84'---------'
A                                      SPACEA(1)
A                                 45'商品小計：'
A            TOTQTY         9P 2   60EDTCDE(J)
A            TOTAMT        11P 2   84EDTCDE(J)
A                                      SPACEA(2)
```

### 9. 報表合計記錄格式定義（TOTAL）
```DDS
A          R TOTAL                     SPACEA(1)
A                                 68'---------'
A                                 92'---------'
A                                      SPACEA(1)
A                                 53'報表合計：'
A            TOTQTY         9P 2   68EDTCDE(J)
A            TOTAMT        11P 2   92EDTCDE(J)
A                                      SPACEA(2)
```

## 字段說明

### 1. 標題字段
- **PAGE**：頁碼，4位數值
- **PDATE**：報表日期，8位字元，格式為YYYY/MM/DD

### 2. 查詢條件字段
- **COMP**：交易類型，1位字元
- **CUST**：客戶代碼，6位字元
- **PROD**：商品代碼，15位字元
- **SLMN**：業務員代碼，4位字元
- **SDATE**：開始日期，8位字元
- **EDATE**：結束日期，8位字元

### 3. 明細字段
- **SONUM**：訂單號碼，9位字元
- **SOITEM**：項次，3位字元
- **CUST**：客戶代碼，6位字元
- **CUSNM**：客戶名稱，30位字元
- **PROD**：商品代碼，15位字元
- **PTDESC**：商品名稱，30位字元
- **QTY**：數量，9位數值，2位小數
- **PRICE**：單價，9位數值，2位小數
- **AMT**：金額，9位數值，2位小數
- **SLMN**：業務員代碼，4位字元

### 4. 小計和合計字段
- **TOTQTY**：總數量，9位數值，2位小數
- **TOTAMT**：總金額，11位數值，2位小數

## 使用說明

### 1. 報表生成
- SOR160P不直接由用戶使用，而是由報表生成程式（SOR1602或SOR1603）使用
- 報表生成程式根據用戶選擇的報表格式，使用相應的記錄格式生成報表

### 2. 報表格式選擇
- 如果用戶選擇報表格式1（按客戶分組），使用FORMAT1、DETAIL1和SUBTOT1記錄格式
- 如果用戶選擇報表格式2（按商品分組），使用FORMAT2、DETAIL2和SUBTOT2記錄格式

### 3. 報表打印
- 報表可以直接打印到印表機
- 報表也可以生成為電子文件，供後續處理

## 與其他程式的關係
SOR160P與以下程式有關聯：
1. **SOR1602**：報表格式1生成程式，使用SOR160P定義的FORMAT1、DETAIL1和SUBTOT1記錄格式
2. **SOR1603**：報表格式2生成程式，使用SOR160P定義的FORMAT2、DETAIL2和SUBTOT2記錄格式

## 維護歷史
- **M001**：98.10.21，由MICHELLE進行Y2K修改
- **M002**：99.11.08，增加客戶群組相關字段
- **M003**：00.11.08，增加商品群組相關字段

## 效能考量
1. **打印優化**：優化打印格式，減少打印時間
2. **紙張使用**：合理設計報表布局，減少紙張使用
3. **溢出處理**：適當處理頁面溢出，確保報表格式正確

## 安全考量
1. **數據保護**：確保報表中不包含敏感資訊
2. **報表訪問控制**：確保只有授權用戶才能生成和查看報表
3. **打印控制**：控制報表的打印權限

## 未來擴展建議
1. **增加更多報表格式**：支持更多類型的報表格式
2. **增強報表美觀性**：提供更美觀的報表格式，如添加公司標誌等
3. **增加電子報表格式**：支持生成PDF、Excel等格式的電子報表
4. **增加圖表功能**：在報表中添加圖表，提高數據可視化效果

## 結論
SOR160P作為銷售訂單入庫報表程式(SOR160系列)的打印檔，定義了銷售訂單入庫報表的打印格式。該打印檔支持兩種報表格式：按客戶分組的報表格式和按商品分組的報表格式，為報表生成程式提供了靈活、清晰的打印格式定義，幫助用戶有效地查看和分析銷售訂單數據。 