# POA001 程式規格說明文件

## 一、基本資訊

- **程式ID**：POA001
- **程式名稱**：採購廠商基本資料維護程式
- **系統歸屬**：西祺企業管理資訊系統 - 採購管理模組
- **開發者**：A1005 ROGER CHIEN
- **建立日期**：1980.11.19
- **最後更新**：1998.11.10 (Y2K修改)

## 二、程式概述

POA001是西祺企業管理資訊系統中採購管理模組的核心程式，負責廠商基本資料的建立、查詢、修改和刪除。該程式提供完整的廠商資料管理功能，包括廠商代碼、名稱、地址、聯絡人、付款條件等資訊的維護，是採購作業流程的基礎支援程式。

## 三、系統架構

POA001程式在系統中的位置處於採購管理模組的基礎資料維護環節，與其他採購相關程式有密切的關聯。程式架構如下：

1. **主程式**：POA001 - 負責廠商資料維護的主要邏輯
2. **顯示檔案**：POA001D - 提供使用者介面
3. **資料檔案**：
   - POPALF - 廠商主檔案
   - POPAPF - 廠商相關檔案

## 四、程式流程

1. **初始化階段**：
   - 從LDA(本地資料區)獲取使用者資訊和系統日期
   - 設定初始參數和環境變數

2. **主選單階段**：
   - 顯示廠商資料清單
   - 提供功能選項（新增、修改、刪除、查詢）
   - 處理使用者功能鍵（F3退出、F6新增、翻頁等）

3. **資料維護階段**：
   - 新增：建立新廠商資料記錄
   - 修改：更新現有廠商資料
   - 刪除：移除廠商資料
   - 查詢：顯示廠商詳細資訊

4. **資料驗證階段**：
   - 檢查必填欄位
   - 驗證資料格式和有效性
   - 確認廠商代碼唯一性

## 五、介面設計

POA001D顯示檔案是程式的主要使用者介面，包含以下元素：

1. **清單畫面(SFLSR1/SFLCR1)**：
   - 顯示廠商代碼(PA01)
   - 廠商類別(MB03)
   - 廠商名稱(PA02)
   - 建立日期(DPA04)
   - 最後交易日期(DPA06)
   - 狀態(PA08)
   - 選項欄位(DOPT1)

2. **明細畫面**：
   - 廠商基本資料（代碼、名稱、地址等）
   - 聯絡資訊（電話、傳真、聯絡人）
   - 交易條件（付款條件、交貨方式等）
   - 其他相關資訊

3. **功能鍵**：
   - F3：退出程式
   - F6：新增資料
   - 翻頁：瀏覽更多記錄

## 六、資料處理

程式對POPALF檔案進行的主要操作包括：

1. **讀取操作**：
   - SETLL - 設定檔案位置
   - CHAIN - 直接讀取特定記錄
   - READ - 循序讀取記錄

2. **更新操作**：
   - WRITE - 寫入新記錄
   - UPDATE - 更新現有記錄
   - DELETE - 刪除記錄

3. **資料關聯**：
   - 與MTMBPF檔案關聯，獲取廠商類別資訊
   - 與POPAPF檔案關聯，處理廠商相關資訊

## 七、檔案使用

程式使用的主要檔案包括：

1. **顯示檔案**：
   - POA001D - 使用者介面顯示檔案

2. **資料檔案**：
   - POPALF - 廠商主檔案，包含廠商基本資料
   - POPAPF - 廠商相關檔案，包含廠商附加資訊
   - MTMBPF - 代碼檔案，包含廠商類別代碼

3. **欄位定義**：
   - PA01 - 廠商代碼
   - PA02 - 廠商名稱
   - PA04 - 建立日期
   - PA06 - 最後交易日期
   - PA07 - 聯絡人
   - PA08 - 狀態
   - PA10 - 電話
   - PA11 - 傳真

## 八、安全與權限

1. **使用者驗證**：
   - 程式透過LDA獲取使用者資訊
   - 使用者權限控制透過系統模組管理

2. **資料安全**：
   - 記錄鎖定機制確保多用戶環境下的資料一致性
   - 檔案共享設定確保資料完整性

## 九、效能考慮

1. **檔案存取最佳化**：
   - 使用鍵值存取提高查詢效率
   - 適當設定檔案共享參數提高並行效能

2. **畫面處理最佳化**：
   - 使用子檔控制提高畫面顯示效率
   - 分頁顯示減少資料傳輸量

## 十、維護建議

1. **程式碼最佳化**：
   - 統一錯誤處理機制
   - 增強參數驗證邏輯

2. **功能增強**：
   - 增加更靈活的查詢條件
   - 提供廠商評估功能
   - 增加廠商歷史交易查詢

3. **相容性改進**：
   - 確保與新版系統的相容性
   - 最佳化Y2K相關程式碼

## 十一、整合點

1. **上游系統**：
   - 採購管理模組主選單(POM000)
   - 基礎代碼維護程式

2. **下游系統**：
   - 採購單處理程式(POA002)
   - 採購查詢程式(POI026)
   - 採購報表程式(POR997)

## 十二、總結

POA001程式是西祺企業管理資訊系統採購管理模組中的關鍵組件，負責廠商基本資料的維護和管理。程式設計合理，提供完整的資料維護功能，能夠滿足企業日常採購作業的需求。透過與其他採購相關程式的協作，構成了完整的採購管理流程，為企業提供有效的採購管理工具。