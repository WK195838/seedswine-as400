# VTM000C 西祺產銷主選單程式規格說明書

## 1. 基本信息

- **程式名稱**：VTM000C
- **程式類型**：CL程式
- **系統**：西祺企業管理資訊系統
- **子系統**：西祺產銷模組
- **功能**：提供西祺產銷模組的主選單界面，允許用戶選擇不同的功能進入
- **建立日期**：不詳
- **更新日期**：不詳
- **作者**：MICHELLE

## 2. 程式結構

### 2.1 變數定義
- `&WDATE`：日期變數，長度6字元
- `&$USER`：用戶ID，長度10字元
- `&S0101I`：用戶ID參數，長度10字元
- `&S0102I`：程式ID參數，長度10字元
- `&S0101O`：權限檢查結果，長度1字元

### 2.2 檔案引用
- `VTM000D`：西祺產銷主選單顯示檔案，定義了選單界面

### 2.3 程式流程

1. **初始化**
   - 從LDA獲取用戶ID和日期信息
   - 設置日期格式和用戶ID參數

2. **主選單顯示**
   - 顯示`VTM000D`檔案中定義的選單界面
   - 等待用戶輸入選擇代碼（`DOPID`）
   - 如果用戶按下F3鍵，則返回上一層

3. **選單選項處理**
   - 根據用戶輸入的`DOPID`值，設置對應的程式名稱到`&S0102I`變數
   - 選項包括：
     - `01`：銷售訂單基本資料（`VTM001C`）
     - `02`：進貨訂單基本資料（`VTA002C`）
     - `03`：銷售訂單人工輸入（`VTA004`）
     - `04`：進貨訂單人工輸入（`VTA003`）
     - `05`：銷售訂單查詢（`VTB004C`）
     - `07`：出貨進貨查詢列印（`VTA017C`）
     - `10`：庫存查詢（`VTI001`）
     - `41`：訂單列印（`VTR010C`）
     - `42`：人工輸入列印（`VTR020C`）
     - `43`：銷貨明細訂單列印（`VTR030C`）
     - `44`：出貨列印（`VTR040C`）
     - `45`：物料訂單列印（`VTR050C`）

4. **權限檢查**
   - 調用`S#S01`程式檢查用戶對所選功能的權限
   - 參數：用戶ID（`&S0101I`）、程式ID（`&S0102I`）、權限結果（`&S0101O`）
   - 如果權限檢查通過（`&S0101O = 'Y'`），則調用相應的程式
   - 如果權限檢查失敗，設置錯誤指示器並返回主選單

## 3. 功能模組說明

### 3.1 資料作業模組
- **銷售訂單基本資料 (01)**
  - 程式：`VTM001C`
  - 功能：維護銷售訂單的基本資料設定

- **進貨訂單基本資料 (02)**
  - 程式：`VTA002C`
  - 功能：維護進貨訂單的基本資料設定

### 3.2 訂單處理模組
- **銷售訂單人工輸入 (03)**
  - 程式：`VTA004`
  - 功能：手動輸入銷售訂單資料

- **進貨訂單人工輸入 (04)**
  - 程式：`VTA003`
  - 功能：手動輸入進貨訂單資料

- **銷售訂單查詢 (05)**
  - 程式：`VTB004C`
  - 功能：查詢銷售訂單資料

### 3.3 查詢模組
- **出貨進貨查詢列印 (07)**
  - 程式：`VTA017C`
  - 功能：查詢和列印出貨和進貨資料

- **庫存查詢 (10)**
  - 程式：`VTI001`
  - 功能：查詢庫存資料

### 3.4 報表模組
- **訂單列印 (41)**
  - 程式：`VTR010C`
  - 功能：列印訂單報表

- **人工輸入列印 (42)**
  - 程式：`VTR020C`
  - 功能：列印人工輸入的訂單資料

- **銷貨明細訂單列印 (43)**
  - 程式：`VTR030C`
  - 功能：列印銷貨明細訂單報表

- **出貨列印 (44)**
  - 程式：`VTR040C`
  - 功能：列印出貨報表

- **物料訂單列印 (45)**
  - 程式：`VTR050C`
  - 功能：列印物料訂單報表

## 4. 界面說明

### 4.1 主選單界面
- 顯示檔案：`VTM000D`
- 界面元素：
  - 標題：西祺產銷主選單
  - 日期和時間顯示
  - 用戶ID顯示
  - 功能選項分組：
    - 資料作業：選項01-05
    - 資料查詢：選項07, 10
    - 報表作業：選項41-45
  - 功能鍵：
    - F3：返回主選單

### 4.2 錯誤處理
- 無效選擇時返回主選單
- 權限檢查失敗時顯示錯誤訊息

## 5. 相關程式

### 5.1 直接調用的程式
- **S#S01**：權限檢查程式
  - 功能：檢查用戶對特定程式的權限
  - 參數：用戶ID、程式ID、權限結果

### 5.2 被調用的子程式
- **VTM001C**：銷售訂單基本資料程式
- **VTA002C**：進貨訂單基本資料程式
- **VTA003**：進貨訂單人工輸入程式
- **VTA004**：銷售訂單人工輸入程式
- **VTB004C**：銷售訂單查詢程式
- **VTA017C**：出貨進貨查詢列印程式
- **VTI001**：庫存查詢程式
- **VTR010C**：訂單列印程式
- **VTR020C**：人工輸入列印程式
- **VTR030C**：銷貨明細訂單列印程式
- **VTR040C**：出貨列印程式
- **VTR050C**：物料訂單列印程式

## 6. 業務邏輯

### 6.1 模組化設計
- 西祺產銷模組被分為多個功能子模組，如訂單處理、庫存查詢、報表列印等
- 每個子模組有對應的程式，通過主選單統一入口

### 6.2 權限控制
- 使用`S#S01`程式進行權限檢查
- 只有授權用戶才能訪問特定功能
- 權限檢查失敗時顯示錯誤訊息

### 6.3 用戶界面
- 使用數字代碼選擇功能
- 清晰的選單分類和描述
- 錯誤訊息顯示機制

## 7. 系統整合

VTM000C作為西祺產銷模組的主入口，連接了西祺企業管理資訊系統的各個產銷相關功能，包括：

1. **訂單管理**：銷售訂單和進貨訂單的輸入和維護
2. **庫存管理**：庫存查詢和管理
3. **報表系統**：各種訂單和出貨報表的生成

## 8. 安全考量

### 8.1 權限控制
- 使用`S#S01`程式檢查用戶權限
- 只有授權用戶才能訪問特定功能

### 8.2 用戶識別
- 從LDA獲取用戶ID
- 在選單界面顯示當前用戶

### 8.3 錯誤處理
- 權限檢查失敗時顯示錯誤訊息
- 無效選擇時返回主選單

## 9. 維護建議

### 9.1 代碼優化
- 使用更現代的條件結構替代多個IF-THEN-DO
- 考慮使用數組或表格簡化選項處理

### 9.2 功能擴展
- 可以添加更多產銷相關功能選項
- 考慮實現個性化選單（根據用戶常用功能）

### 9.3 界面改進
- 更新為圖形用戶界面
- 添加幫助功能和提示

### 9.4 系統整合
- 與Web界面整合
- 實現單點登錄

## 10. 總結

VTM000C是西祺企業管理資訊系統中的西祺產銷主選單程式，提供了用戶訪問各個產銷相關功能的入口。它實現了基本的權限控制和用戶界面，並與系統的其他部分緊密整合。該程式採用了模組化設計，便於維護和擴展。

通過VTM000C，用戶可以方便地訪問銷售訂單、進貨訂單、庫存查詢和報表列印等功能，實現西祺產銷業務的全面管理。