# SOR160D - 銷售訂單入庫報表顯示檔規格書

## 基本資訊
- **檔案名稱**：SOR160D
- **檔案類型**：DSPF（顯示檔）
- **所屬資料庫**：REPLIB
- **功能說明**：銷售訂單入庫報表查詢條件輸入畫面
- **相關程式**：
  - SOR160（主程式）
  - SOR160C（控制程式）
  - SOR160C1（查詢程式）
- **系統名稱**：西祺企業經營管理資訊系統
- **子系統**：銷售訂單管理系統
- **作者**：EASON
- **建立日期**：96/09/06
- **最後修改日期**：00/11/08
- **功能特點**：提供用戶友好的界面，讓用戶輸入銷售訂單入庫報表的查詢條件。

## 檔案概述
SOR160D是西祺企業經營管理資訊系統中銷售訂單入庫報表程式(SOR160系列)的顯示檔，用於提供銷售訂單入庫報表的查詢條件輸入界面。該顯示檔定義了查詢條件輸入畫面的布局和字段，包括交易類型、客戶代碼、商品代碼、業務員代碼、日期範圍、報表格式等查詢條件，以及相應的功能鍵定義。

SOR160D作為用戶界面，為用戶提供直觀、友好的操作界面，使用戶能夠方便地輸入查詢條件，生成所需的銷售訂單入庫報表。

## 畫面布局

### 主畫面（SOR160D）
```
                       銷售訂單入庫報表查詢條件                      
                                                                    
  交易類型 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . _  (1=出貨 2=退貨 3=調撥 空白=全部)
  客戶代碼 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . ______  (空白=全部)
  客戶群組 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . __  (空白=全部)
  商品代碼 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . _______________  (空白=全部)
  商品群組 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . __  (空白=全部)
  業務員代碼 . . . . . . . . . . . . . . . . . . . . . . . . . . . . ____  (空白=全部)
  開始日期 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . ________  (YYYYMMDD)
  結束日期 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . ________  (YYYYMMDD)
  報表格式 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . _  (1=按客戶分組 2=按商品分組)
                                                                    
                                                                    
                                                                    
                                                                    
                                                                    
                                                                    
                                                                    
                                                                    
                                                                    
                                                                    
  F3=結束  F4=提示  F5=重新整理  F12=取消  F13=查詢條件說明
```

## DDS定義
SOR160D的DDS定義包括以下主要部分：

### 1. 檔案級別定義
```DDS
A                                      DSPSIZ(24 80 *DS3)
A                                      PRINT
A                                      INDARA
A                                      CA03(03 'EXIT')
A                                      CA04(04 'PROMPT')
A                                      CA05(05 'REFRESH')
A                                      CA12(12 'CANCEL')
A                                      CA13(13 'HELP')
```

### 2. 記錄格式定義
```DDS
A          R SOR160D                   BLINK
A                                      OVERLAY
A                                      PUTOVR
A                                      CLRL(*ALL)
A                                      FRCDTA
A                                      RTNCSRLOC(&CSRR &CSRF &CSRP)
A            CSRR           4S 0H
A            CSRF          10A  H
A            CSRP           4S 0H
```

### 3. 字段定義
```DDS
A                                  1 30'銷售訂單入庫報表查詢條件'
A                                  3  3'交易類型 . . . . . . . . . . . . . . . . . . . . . . . . . . . . .'
A            COMP           1A  B  3 70
A                                  3 73'(1=出貨 2=退貨 3=調撥 空白=全部)'
A                                  4  3'客戶代碼 . . . . . . . . . . . . . . . . . . . . . . . . . . . . .'
A            CUST           6A  B  4 70
A                                  4 78'(空白=全部)'
A                                  5  3'客戶群組 . . . . . . . . . . . . . . . . . . . . . . . . . . . . .'
A            CGRP           2A  B  5 70
A                                  5 74'(空白=全部)'
A                                  6  3'商品代碼 . . . . . . . . . . . . . . . . . . . . . . . . . . . . .'
A            PROD          15A  B  6 70
A                                  6 87'(空白=全部)'
A                                  7  3'商品群組 . . . . . . . . . . . . . . . . . . . . . . . . . . . . .'
A            PGRP           2A  B  7 70
A                                  7 74'(空白=全部)'
A                                  8  3'業務員代碼 . . . . . . . . . . . . . . . . . . . . . . . . . . . .'
A            SLMN           4A  B  8 70
A                                  8 76'(空白=全部)'
A                                  9  3'開始日期 . . . . . . . . . . . . . . . . . . . . . . . . . . . . .'
A            SDATE          8A  B  9 70
A                                  9 80'(YYYYMMDD)'
A                                 10  3'結束日期 . . . . . . . . . . . . . . . . . . . . . . . . . . . . .'
A            EDATE          8A  B 10 70
A                                 10 80'(YYYYMMDD)'
A                                 11  3'報表格式 . . . . . . . . . . . . . . . . . . . . . . . . . . . . .'
A            RPTF           1A  B 11 70
A                                 11 73'(1=按客戶分組 2=按商品分組)'
A                                 23  3'F3=結束  F4=提示  F5=重新整理  F12=取消  F13=查詢條件說明'
```

## 字段說明

### 1. 查詢條件字段
- **COMP**：交易類型，1位字元，可選值為1（出貨）、2（退貨）、3（調撥）或空白（全部）
- **CUST**：客戶代碼，6位字元，可輸入特定客戶代碼或空白（全部）
- **CGRP**：客戶群組，2位字元，可輸入特定客戶群組或空白（全部）
- **PROD**：商品代碼，15位字元，可輸入特定商品代碼或空白（全部）
- **PGRP**：商品群組，2位字元，可輸入特定商品群組或空白（全部）
- **SLMN**：業務員代碼，4位字元，可輸入特定業務員代碼或空白（全部）
- **SDATE**：開始日期，8位字元，格式為YYYYMMDD
- **EDATE**：結束日期，8位字元，格式為YYYYMMDD
- **RPTF**：報表格式，1位字元，可選值為1（按客戶分組）或2（按商品分組）

### 2. 隱藏字段
- **CSRR**：游標位置行號，4位數值
- **CSRF**：游標位置字段名，10位字元
- **CSRP**：游標位置列號，4位數值

## 功能鍵定義
- **F3**：結束程式
- **F4**：提示（顯示可選值）
- **F5**：重新整理畫面
- **F12**：取消當前操作
- **F13**：顯示查詢條件說明

## 使用說明

### 1. 查詢條件輸入
1. 在主畫面中輸入查詢條件
2. 可以輸入一個或多個條件，如果某個條件為空白，表示不限制該條件
3. 日期必須按照YYYYMMDD格式輸入
4. 報表格式必須選擇1（按客戶分組）或2（按商品分組）

### 2. 功能鍵使用
- 按F3可以結束程式
- 按F4可以獲取字段的可選值提示
- 按F5可以重新整理畫面，清除已輸入的條件
- 按F12可以取消當前操作
- 按F13可以顯示查詢條件的詳細說明

### 3. 錯誤處理
- 如果輸入的日期格式不正確，會顯示錯誤訊息
- 如果輸入的交易類型或報表格式不在有效範圍內，會顯示錯誤訊息

## 與其他程式的關係
SOR160D與以下程式有關聯：
1. **SOR160**：主程式，使用SOR160D顯示查詢條件輸入畫面
2. **SOR160C**：控制程式，接收從SOR160D輸入的查詢條件
3. **SOR160C1**：查詢程式，根據從SOR160D輸入的查詢條件執行查詢

## 維護歷史
- **M001**：98.10.21，由MICHELLE進行Y2K修改
- **M002**：99.11.08，增加客戶群組選項
- **M003**：00.11.08，增加商品群組選項

## 效能考量
1. **畫面響應**：優化畫面響應速度，提高用戶體驗
2. **字段驗證**：在客戶端進行基本的字段驗證，減少服務器負擔
3. **提示功能**：提供字段提示功能，幫助用戶正確輸入

## 安全考量
1. **輸入驗證**：驗證用戶輸入的有效性，防止非法輸入
2. **訪問控制**：確保只有授權用戶才能訪問此畫面
3. **數據保護**：保護用戶輸入的查詢條件，防止未授權訪問

## 未來擴展建議
1. **增加更多查詢條件**：支持更多類型的查詢條件
2. **增強用戶界面**：提供更友好的用戶界面，如下拉菜單、日期選擇器等
3. **增加查詢條件保存功能**：允許用戶保存常用的查詢條件
4. **增加多語言支持**：支持多種語言顯示

## 結論
SOR160D作為銷售訂單入庫報表程式(SOR160系列)的顯示檔，提供了用戶友好的界面，讓用戶能夠方便地輸入查詢條件，生成所需的銷售訂單入庫報表。該顯示檔的設計遵循清晰易讀和易用性原則，為用戶提供直觀、友好的操作界面，幫助用戶有效地查詢和分析銷售訂單數據。 