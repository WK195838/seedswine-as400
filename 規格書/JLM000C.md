# JLM000C程序規格說明文檔

## 1. 基本資訊

- **程序名稱**：JLM000C
- **系統**：西祺企業管理資訊系統 - 會計模組
- **子系統**：會計憑證
- **功能描述**：會計憑證主選單程序
- **開發者**：JUDY LEE
- **創建日期**：1993/04/30

## 2. 程序結構

JLM000C程序是會計憑證模組的主選單程序，作為整個會計憑證系統的入口點，它提供了一個選單界面，允許用戶選擇不同的會計憑證處理功能。

### 2.1 程序流程

1. 程序啟動後，顯示主選單界面(JLM000D)
2. 用戶輸入選項代碼(DOPID)
3. 如果用戶按F3退出，則返回上一級選單
4. 如果用戶輸入有效的選項代碼，程序會根據選項代碼設置相應的程序名稱(S0102I)
5. 調用權限檢查程序(S#S01)，檢查用戶是否有權限執行所選功能
6. 如果用戶有權限，則調用相應的子程序；否則顯示錯誤訊息
7. 返回主選單界面，等待用戶下一步操作

## 3. 相關檔案

### 3.1 主要檔案

- **JLM000D**：主選單顯示檔案，定義了選單界面的布局和選項
- **JLB011C**、**JLB012C**等：各個功能模組的控制程序，負責處理特定的會計憑證功能

### 3.2 參數定義

主要參數：

| 參數名 | 描述 | 類型 | 備註 |
|-------|------|------|------|
| DOPID | 選項代碼 | 字符(2) | 用戶選擇的功能代碼 |
| S0101I | 用戶ID | 字符(10) | 當前用戶的識別碼 |
| S0102I | 程序名稱 | 字符(10) | 要調用的子程序名稱 |
| S0101O | 權限標誌 | 字符(1) | 'Y'表示有權限，其他值表示無權限 |

## 4. 程序功能詳細說明

### 4.1 主選單界面

JLM000D顯示檔案定義了會計憑證模組的主選單界面，包含以下主要選項：

1. 11 - 普通憑證維護
2. 12 - 轉帳憑證維護
3. 13 - 收入憑證維護
4. 14 - 費用憑證維護
5. 15 - 人工作業憑證維護
6. 21 - 普通多筆憑證維護
7. 22 - 收入多筆憑證維護
8. 23 - 轉帳多筆憑證維護
9. 31 - 憑證沖銷憑證維護
10. 41 - 科目餘額憑證維護
11. 42 - 科目明細憑證維護
12. 43 - 期內調整憑證維護
13. 51 - 已存調整憑證維護

### 4.2 選項處理

JLM000C程序根據用戶選擇的選項代碼(DOPID)，設置相應的子程序名稱(S0102I)：

- DOPID='11' → S0102I='JLB011C'（普通憑證維護）
- DOPID='12' → S0102I='JLB012C'（轉帳憑證維護）
- DOPID='13' → S0102I='JLB013C'（收入憑證維護）
- 以此類推...

### 4.3 權限檢查

程序調用S#S01程序檢查用戶是否有權限執行所選功能：

```
CALL PGM(S#S01) PARM(&S0101I &S0102I &S0101O)
```

如果S0101O返回'Y'，則用戶有權限執行該功能，程序會調用相應的子程序；否則，程序會設置錯誤標誌(IN98)並返回主選單界面。

### 4.4 子程序結構

以JLB011C（普通憑證維護）為例，子程序通常包含以下組件：

1. JLB011C：控制程序，負責協調各個子程序的調用
2. JLB0111：界面程序，提供用戶交互界面
3. JLB011C1：處理程序，負責實際的數據處理和報表生成

## 5. 業務規則

### 5.1 憑證類型

會計憑證模組支持多種憑證類型，每種類型有特定的處理邏輯：

- 普通憑證：一般性的會計憑證
- 轉帳憑證：用於內部轉帳的憑證
- 收入憑證：記錄收入的憑證
- 費用憑證：記錄費用的憑證
- 人工作業憑證：手工處理的憑證

### 5.2 多筆憑證

多筆憑證允許在一個憑證中包含多個會計分錄，適用於複雜的會計處理：

- 普通多筆憑證
- 收入多筆憑證
- 轉帳多筆憑證

### 5.3 特殊憑證

系統還支持一些特殊類型的憑證處理：

- 憑證沖銷：用於沖銷之前的憑證
- 科目餘額/明細：用於科目餘額和明細的處理
- 期內調整/已存調整：用於會計期間的調整處理

## 6. 界面說明

JLM000D顯示檔案定義了會計憑證模組的主選單界面，主要包括：

1. 標題區域：顯示系統名稱、日期、時間和用戶ID
2. 選項區域：列出所有可用的功能選項
3. 輸入區域：用戶輸入選項代碼(DOPID)
4. 功能鍵區域：顯示可用的功能鍵（如F3=返回主選單）
5. 訊息區域：顯示錯誤訊息或提示訊息

## 7. 數據流向

1. 用戶輸入選項代碼(DOPID) → JLM000C程序
2. JLM000C程序 → 權限檢查程序(S#S01)
3. 權限檢查結果 → JLM000C程序
4. JLM000C程序 → 子程序(JLB011C等)
5. 子程序 → 數據處理和報表生成

## 8. 安全與權限

程序使用S#S01程序進行權限檢查，確保用戶只能訪問其有權限的功能。權限檢查基於用戶ID(S0101I)和程序名稱(S0102I)，返回權限標誌(S0101O)。

## 9. 維護建議

1. 考慮更新界面設計，提高用戶體驗
2. 增強錯誤處理機制，提供更詳細的錯誤訊息
3. 考慮添加日誌記錄功能，便於問題追蹤
4. 可以考慮將硬編碼的程序名稱改為配置參數，提高靈活性
5. 增加更多的選項說明和幫助功能，幫助用戶更好地理解和使用系統

## 10. 總結

JLM000C程序是西祺企業管理資訊系統會計模組中的重要組成部分，作為會計憑證系統的入口點，它提供了一個統一的界面，允許用戶訪問各種會計憑證處理功能。程序設計遵循了AS/400系統的典型架構，使用多個相互關聯的程序和檔案完成業務功能。通過權限檢查機制，確保了系統的安全性和數據的完整性。