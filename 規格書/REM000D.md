# REM000D 程式規格書

## 1. 基本資訊

- **檔案名稱**：REM000D
- **檔案類型**：DDS（資料描述規格）顯示檔案
- **程式庫**：REPLIB
- **功能描述**：系統主選單顯示檔案
- **相關程式**：REM000C（主選單控制程式）
- **建立日期**：80/11/15
- **作者**：A1005 ROGER CHIEN
- **系統名稱**：西祺企業管理資訊系統

## 2. 檔案概述

REM000D是西祺企業管理資訊系統的主選單顯示檔案，定義了系統主選單的畫面布局和顯示格式。此檔案與REM000C主選單控制程式配合使用，為使用者提供一個直觀的介面，顯示系統的所有主要功能模組，並允許使用者選擇所需的功能。

## 3. 檔案結構

```
顯示檔案定義
  |
  ↓
記錄格式定義 (DSPC1)
  |
  ↓
常數欄位（標題、標籤等）
  |
  ↓
變數欄位（日期、時間、使用者ID等）
  |
  ↓
輸入欄位（功能選擇）
  |
  ↓
錯誤訊息欄位
```

## 4. 檔案內容分析

### 4.1 檔案屬性

```
DSPSIZ(24 80 *DS3)
MSGLOC(24)
PRINT
```
- 定義顯示大小為24行80列，使用DS3顯示站
- 設定訊息行位置在第24行
- 啟用列印功能

### 4.2 記錄格式定義

```
R DSPC1
```
- 定義主選單的記錄格式為DSPC1
- 此記錄格式包含所有主選單的顯示元素

### 4.3 標題和系統資訊

```
1  2'REM000'
1 26MSGCON(030 URE9999 *LIBL/REMF)
1 62'日期:'
$EGMDY         6Y 0O  1 70EDTCDE(Y)
2  2'SCR001'
2 30'西祺企業管理資訊系統'
2 62'時間:'
2 70TIME
3 62' USER :'
$USER         10A  O  3 70
```
- 顯示程式ID、系統標題、日期、時間和使用者資訊
- 系統標題使用高亮度和底線屬性強調
- 日期使用Y編輯碼格式化為YY/MM/DD
- 時間使用編輯字格式化為HH:MM:SS

### 4.4 功能選項顯示

```
5 12'01.採購作業'
5 45'1A.應付帳款系統'
6 12'02.主檔作業'
7 12'03.生產系統作業'
7 45'13.生產系統報表'
...
```
- 顯示所有可用的系統功能模組
- 每個選項都使用底線屬性強調
- 選項按照功能類別和編號排列
- 部分選項前有星號(*)，表示已停用或特殊功能

### 4.5 輸入欄位

```
DOPID          2A  B 21 48DSPATR(UL)
VALUES('01' '02' '03' '04' '05' '06' '07' '08' '09' '14' '15' '16' '18' '1A' '13' '80' '90' '19' '21' ' ')
```
- 定義功能選擇輸入欄位DOPID
- 長度為2個字元，使用底線屬性
- 限制輸入值為有效的功能代碼
- 位於畫面中央，方便使用者輸入

### 4.6 錯誤訊息處理

```
98        ERR1          60A  O 24  2MSGID(UPT 2023 PTMF)
24 66MSGCON(014 UPT9999 *LIBL/PTMF)
```
- 當指示器98開啟時，顯示錯誤訊息ERR1
- 使用訊息ID UPT2023從PTMF訊息檔案獲取錯誤訊息
- 在畫面底部顯示系統訊息

## 5. 畫面布局分析

### 5.1 整體布局

```
+------------------------------------------------------------------+
| REM000                 系統標題                      日期:YY/MM/DD |
| SCR001             西祺企業管理資訊系統                時間:HH:MM:SS |
|                                                  USER:使用者ID    |
|                                                                  |
| 01.採購作業                                   1A.應付帳款系統       |
| 02.主檔作業                                                       |
| 03.生產系統作業                               13.生產系統報表       |
| 04.銷售訂單作業                               14.銷售訂單報表       |
| 05.銷售分析作業                               15.銷售分析報表       |
| 06.庫存系統作業                               16.庫存系統報表       |
| 07.配送系統作業                                                   |
| 08.應收帳款作業                               18.應收帳款報表       |
| 09.製造系統作業                               19.每日交易主選單     |
| * 10.物料系統作業                                                 |
|                                                                  |
| 21.資料維護作業                                                   |
| * 31.工單管理系統                                                 |
|                              80.系統管理作業                      |
|                              90.結束系統作業                      |
|                                                                  |
|                        請輸入選擇代號:__                          |
|                                                                  |
|                                                                  |
| 錯誤訊息                                                系統訊息   |
+------------------------------------------------------------------+
```

### 5.2 功能區域劃分

1. **標題區域**（第1-3行）：
   - 顯示程式ID、系統標題、日期、時間和使用者資訊

2. **功能選項區域**（第5-19行）：
   - 左側顯示主要作業功能
   - 右側顯示對應的報表功能
   - 底部顯示系統管理和結束選項

3. **輸入區域**（第21行）：
   - 顯示提示訊息和輸入欄位

4. **訊息區域**（第24行）：
   - 顯示錯誤訊息和系統訊息

## 6. 功能選項對照表

| 選項 | 功能描述 | 顯示位置 |
|------|----------|----------|
| 01 | 採購作業 | 5,12 |
| 02 | 主檔作業 | 6,12 |
| 03 | 生產系統作業 | 7,12 |
| 04 | 銷售訂單作業 | 8,12 |
| 05 | 銷售分析作業 | 9,12 |
| 06 | 庫存系統作業 | 10,12 |
| 07 | 配送系統作業 | 11,12 |
| 08 | 應收帳款作業 | 12,12 |
| 09 | 製造系統作業 | 13,12 |
| *10 | 物料系統作業 | 14,10 |
| 11 | 系統設定作業 | (未顯示) |
| 13 | 生產系統報表 | 7,45 |
| 14 | 銷售訂單報表 | 8,45 |
| 15 | 銷售分析報表 | 9,45 |
| 16 | 庫存系統報表 | 10,45 |
| 18 | 應收帳款報表 | 12,45 |
| 19 | 每日交易主選單 | 13,45 |
| 21 | 資料維護作業 | 16,12 |
| *31 | 工單管理系統 | 17,10 |
| 1A | 應付帳款系統 | 5,45 |
| 80 | 系統管理作業 | 18,32 |
| 90 | 結束系統作業 | 19,32 |

## 7. 顯示屬性使用

### 7.1 常用顯示屬性

- **DSPATR(HI)**：高亮度，用於強調系統標題
- **DSPATR(UL)**：底線，用於強調功能選項和輸入欄位
- **DSPATR(RI)**：反轉圖像，用於錯誤訊息
- **COLOR(TRQ)**：藍綠色，用於特殊顯示
- **COLOR(WHT)**：白色，用於一般資料顯示

### 7.2 條件顯示

- **指示器98**：控制錯誤訊息的顯示
- **M001M、M002A**：修改標記，表示程式碼的修改歷史

## 8. 相關檔案和程式

### 8.1 相關程式

- **REM000C**：主選單控制程式，處理使用者選擇和呼叫相應功能
- **各功能模組程式**：PAM000C, MTM000C, SOM000C等

### 8.2 相關檔案

- **REMF**：訊息檔案，包含系統標題訊息
- **PTMF**：訊息檔案，包含錯誤訊息和系統訊息

## 9. 檔案特點

1. **使用者友好**：清晰的布局和標籤，方便使用者導航
2. **功能完整**：顯示系統所有主要功能模組
3. **視覺區分**：使用不同位置和屬性區分不同類型的功能
4. **輸入驗證**：限制DOPID欄位的有效輸入值
5. **錯誤處理**：提供專用區域顯示錯誤訊息

## 10. 注意事項

1. 部分功能選項前有星號(*)，表示已停用或特殊功能
2. VALUES子句限制了可輸入的功能代碼，需與REM000C中的處理邏輯保持一致
3. 畫面布局針對24x80的顯示器優化，在其他尺寸可能需要調整
4. 系統使用中文顯示，需確保系統支援中文字元集

## 11. 建議與改進

1. 可考慮增加功能分類或分頁，使介面更清晰
2. 可增加功能說明或線上幫助
3. 可考慮使用顏色區分不同類型的功能
4. 可增加快捷鍵功能，提高操作效率

---

此規格書基於REM000D.txt的分析。REM000D作為西祺企業管理資訊系統的主選單顯示檔案，定義了系統的主要使用者介面。它與REM000C主選單控制程式配合使用，為使用者提供了一個直觀、功能完整的系統導航介面。