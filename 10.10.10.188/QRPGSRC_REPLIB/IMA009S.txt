      ****************************************************************
      *   泛太資訊科技開發股份有限公司－版權所有    TEL:7313250    *
      *                                                              *
      * PROGRAM NAME : IMA009                                        *
      * AUTHER       : A1087  JOYCE                                  *
      * CREATE DATE  : 81/04/20                                      *
      * UPDATE DATE  :                                               *
      * SYSTEM       :人頭馬匯東                                   *
      * SUBSYSTEM    :庫存系統                                     *
      * REMARK       :月結處理                                     *
      ****************************************************************
     FSOSNLF02UF  E           K        DISK
     FSOSNLF  IF  E           K        DISK
     F            SN0                               KRENAMESN0L
     FIMIELF02UF  E           K        DISK
     FIMIGLF02UF  E           K        DISK
     FPOPDLF02UF  E           K        DISK
     FPOPFLF02UF  E           K        DISK
     FPOPHLF02UF  E           K        DISK
     FSOSOPF  IF  E           K        DISK
     FIMIFPF  IF  E           K        DISK
     FIMIHPF  IF  E           K        DISK
     FPOPCPF  IF  E           K        DISK
     FPOPEPF  IF  E           K        DISK
     FPOPGPF  IF  E           K        DISK
     FPOPIPF  IF  E           K        DISK
     FIMIILF02UF  E           K        DISK
     FIMIMLF02UF  E           K        DISK
     FIMIBLF03UF  E           K        DISK
     FIMICLF02UF  E           K        DISK
     FSOSCLF03UF  E           K        DISK
     FSOSCLF  IF  E           K        DISK
     F            SC0                               KRENAMESC0L
     FSOSELF06UF  E           K        DISK
     FSOSELF  IF  E           K        DISK
     F            SE0                               KRENAMESE0L
     FSOSGLF05UF  E           K        DISK
     FIMIULF01IF  E           K        DISK
     FIMIJPF  IF  E           K        DISK
     FIMILPF  IF  E           K        DISK
     FPA#BPF  UF  E           K        DISK
     FIMINLF02UF  E           K        DISK                      A
     FSOSDPF  IF  E           K        DISK
     FSOSFPF  IF  E           K        DISK
     FSOSHPF  IF  E           K        DISK
     FSOSPLF01IF  E           K        DISK
     FIMA009D CF  E                    WORKSTN
     FIMA009P O   E             39     PRINTER
     I*
     I           UDS
     I                                      101 110 $USER
     I                                      119 1240$EGMDY
     I                                      152 161 $USERN
     I                                      111 1160$CHYMD
     I            DS
B2MODI                                        1   60#B16
B2MODI                                        1   40YY
B2MODI                                        5   60MM
     I            DS
B2MODI                                        1   60W#B16
B2MODI                                        1   40WYY
B2MODI                                        5   60WMM
     I            DS
     I                                        1   40D#B16
     I                                        1   20DMM
     I                                        3   40DYY
     I            DS
B2MODI                                        1   80SETLL
B2MODI                                        1   60SETYM
B2MODI                                        7   80SETD
     I            DS
B2MODI                                        1   80WDATE
B2MODI                                        1   60WYYMM
     I            DS
     I                                        1  12 SN02
     I                                        3   4 SN02L
      *==============================================================*
      *                    DEFINE ROUTINE
      *==============================================================*
     C           *LIKE     DEFN SD04      WSD04
     C           *LIKE     DEFN SD10      WSD10
B2000C           *LIKE     DEFN IN02      WIN02
      *
B2000C           *LIKE     DEFN SC39      KDATE
     C           *LIKE     DEFN SC01      KCOMP
     C           *LIKE     DEFN SC02      KORD
      *==============================================================*
      *                    KLIST
      *==============================================================*
     C           KEYIN     KLIST
     C                     KFLD           IN02
     C                     KFLD           IN01
     C                     KFLD           IN03
     C                     KFLD           IN04
     C           KEYIN1    KLIST
     C                     KFLD           IN02
     C                     KFLD           IN01
     C           KEYIN2    KLIST
     C                     KFLD           WIN02
     C           KEYPC     KLIST
     C                     KFLD           PC02
     C                     KFLD           PC03
     C           KEYPE     KLIST
     C                     KFLD           PD02
     C           KEYPG     KLIST
     C                     KFLD           PF02
     C           KEYPI     KLIST
     C                     KFLD           PH02
     C           KEYSD     KLIST
     C                     KFLD           SC02
     C           KEYSF     KLIST
     C                     KFLD           SE02
     C           KEYSH     KLIST
     C                     KFLD           SG02
     C           KEYSO     KLIST
     C                     KFLD           SN02
     C           KEYIF     KLIST
     C                     KFLD           IE02
     C           KEYIH     KLIST
     C                     KFLD           IG02
     C           KEYIJ     KLIST
     C                     KFLD           II02
     C           KEYIL     KLIST
     C                     KFLD           IM02
     C           KEYSFD    KLIST
     C                     KFLD           SE29
     C                     KFLD           SF03
     C           KEYKEP    KLIST
     C                     KFLD           KDATE
     C                     KFLD           KCOMP
     C                     KFLD           KORD
      *==============================================================*
      *                    MAIN ROUTINE
      *==============================================================*
     C                     EXSR RTN010                     *INIT ENVIRM
     C                     EXSR RTN100                     *CHECK SCR01?
     C*
  01-C           *IN03     DOWEQ'0'
    C*
    C                     EXFMTDSPD1
    C                     MOVEA*ALL'0'   *IN,60
    C*
  02-C           *IN14     IFEQ '1'
    C                     EXSR RTN200                     *PROCESS    ?
    C                     SETON                     98                ?
  02-C                     END
  01-C                     END
     C*
     C                     SETON                     LR
      *===============================================================*
      *          RTN010....INIT SCREEN
      *===============================================================*
01===C           RTN010    BEGSR
|    C*
|    C                     Z-ADD0         D#B16
|    C*
B2MODC                     Z-ADD0         DATE    80
|    C                     CALL 'RES001'
|    C                     PARM 'MDY'     S001I1  3
B2???C                     PARM $EGMDY    S001I2  80
B2INF *CVR3012 sev.30 Field $EGMDY contains more than one year
B2INF *CVR3012 sev.30 Field S001I2 contains more than one year
B2MODC           DATE      PARM           S001O1  80
|    C*
|    C                     Z-ADD0         WORK   234
|    C                     Z-ADD0         WORK1  234
      *
01===C                     ENDSR
      *===============================================================*
      *          RTN100....CHECK SCREEN
      *===============================================================*
02===C           RTN100    BEGSR
|    C*結帳月份檢查
|    C           *LOVAL    SETLL#B0
|    C                     READ #B0                      40
| 01-C           *IN40     IFEQ '0'
      *
|   C           MM        ADD  1         DMM
| 02-C           DMM       IFGT 12
      *SCREEN
|   C                     Z-ADD1         DMM
B2???C           YY        ADD  1         DYY
B2INF *CVR5008 sev.50 The converter tool cannot handle op-code ADD
B2INF *   involving not-expanded and expanded date fields requiring
B2INF *   add/remove century. Code must be adjusted manually
      *DATE YY/MM
|   C                     Z-ADD1         WMM
B2CHKC           YY        ADD  1         WYY
| 02*C                     ELSE
      *SCREEN
B2TRCC                     Z-ADDYY        DYY
      *DATE YY/MM
|   C                     Z-ADDDMM       WMM
B2000C                     Z-ADDYY        WYY
| 02-C                     END
| 01-C                     END
|    C*
B2000C                     Z-ADDW#B16     SETYM
|    C                     Z-ADD1         SETD
|    C*
02===C                     ENDSR
      *===============================================================*
      *          RTN200....DATA PROCESS
      *===============================================================*
03===C           RTN200    BEGSR
|    C*
|    C                     EXSR RTN310
|    C                     EXSR RTN320
|    C                     EXSR RTN330
|    C                     EXSR RTN340
|    C                     EXSR RTN350
|    C                     EXSR RTN360
|    C                     EXSR RTN370
|    C                     EXSR RTN380
|    C                     EXSR RTN390
|    C                     EXSR RTN400
|    C                     EXSR RTN410
|    C                     EXSR RTN420
|    C                     EXSR RTN430
|    C                     EXSR RTN440
|    C                     EXSR RTN450
|    C                     EXSR RTN500
|    C*
03===C                     ENDSR
      *===============================================================*
      *          RTN310....月結資料檔
      *===============================================================*
04===C           RTN310    BEGSR
|    C*
B2000C                     Z-ADD#B16      WIN02
|    C*
B2000C           KEYIN2    SETLLIN0
B2000C           KEYIN2    READEIN0                      44
| 01-C           *IN44     DOWEQ'0'
|   C*
| 02-C           IN17      IFNE 0
|   C           IN26      ORNE 0
|   C           IN27      ORNE 0
|   C           IN28      ORNE 0
|   C           IN261     ORNE 0
|   C           IN271     ORNE 0
|   C           IN281     ORNE 0
|   C           IN29      ORNE 0
|   C           IN30      ORNE 0
|   C           IN31      ORNE 0
|   C           IN291     ORNE 0
|   C           IN301     ORNE 0
|   C           IN311     ORNE 0
|   C           IN32      ORNE 0
|   C           IN33      ORNE 0
|   C           IN34      ORNE 0
|   C           IN321     ORNE 0
|   C           IN331     ORNE 0
|   C           IN341     ORNE 0
|   C**
B2000C                     Z-ADDW#B16     IN02
|   C                     Z-ADDIN17      IN05
|   C                     Z-ADD0         IN06
|   C                     Z-ADD0         IN07
|   C                     Z-ADD0         IN08
|   C                     Z-ADD0         IN09
|   C                     Z-ADD0         IN10
|   C                     Z-ADD0         IN101
|   C                     Z-ADD0         IN11
|   C                     Z-ADD0         IN12
|   C                     Z-ADD0         IN13
|   C                     Z-ADD0         IN14
|   C                     Z-ADD0         IN15
|   C                     Z-ADD0         IN16
|   C                     Z-ADD0         IN18
|   C                     Z-ADD0         IN19
|   C                     Z-ADD0         IN20
|   C                     Z-ADDIN26      IN23
|   C                     Z-ADDIN27      IN24
|   C                     Z-ADDIN28      IN25
|   C                     Z-ADDIN261     IN231
|   C                     Z-ADDIN271     IN241
|   C                     Z-ADDIN281     IN251
| 03-C           WMM       IFEQ 4
|   C                     Z-ADD0         IN29
|   C                     Z-ADD0         IN30
|   C                     Z-ADD0         IN31
|   C                     Z-ADD0         IN291
|   C                     Z-ADD0         IN301
|   C                     Z-ADD0         IN311
|   C                     Z-ADD0         IN32
|   C                     Z-ADD0         IN33
|   C                     Z-ADD0         IN34
|   C                     Z-ADD0         IN321
|   C                     Z-ADD0         IN331
|   C                     Z-ADD0         IN341
| 03-C                     END
|   C                     Z-ADD0         IN35
|   C                     Z-ADD0         IN36
|   C                     Z-ADD0         IN37
|   C                     Z-ADD0         IN38
|   C                     Z-ADD0         IN39
|   C                     Z-ADD0         IN40
|   C                     Z-ADD0         IN41
|   C*
B2000C                     Z-ADDDATE      INXX
B2000C                     TIME           INYY
|   C                     MOVE $USER     INZZ
|   C**
|   C                     WRITEIN0
      *
| 02-C                     END
B2000C           KEYIN2    READEIN0                      44
| 01-C                     END
|    C*
|    C                     WRITEPH1
|    C*
04===C                     ENDSR
      *===============================================================*
      *          RTN320....國外採購驗收主檔
      *===============================================================*
05===C           RTN320    BEGSR
|    C*
B2000C           SETLL     SETLLPD0
|    C                     READ PD0                      44
| 01-C           *IN44     DOWEQ'0'
|   C*
B2000C                     Z-ADDPD04      WDATE
B2000C           WYYMM     IFEQ W#B16
|   C                     MOVE 'V'       PD24
B2000C                     Z-ADDDATE      PDXX
B2000C                     TIME           PDYY
|   C                     MOVE $USER     PDZZ
|   C**
|   C                     UPDATPD0
|   C*
|   C                     MOVE PD02      PDNO
|   C***
|   C           KEYPE     SETLLPE0
|   C           KEYPE     READEPE0                      45
| 03-C           *IN45     DOWEQ'0'
|   C*
|   C                     Z-ADD0         PC10
|   C                     MOVELPE03      PC02
|   C                     MOVELPE04      PC03
|   C           KEYPC     CHAINPC0                  41
|   C           PE06      MULT PC10      WORK
|   C*
|   C                     MOVELPE01      IN01
B2000C                     Z-ADDW#B16     IN02
|   C                     MOVE PD06      IN03
|   C                     MOVE PE04      IN04
|   C                     Z-ADDWORK      QTY
|   C                     Z-ADD0         QTY1
|   C                     WRITEPD1
| 04-C           *IN39     IFEQ '1'
|   C                     WRITEPE1
|   C                     WRITEPH1
|   C                     SETOF                     39
| 04-C                     END
|   C*
|   C           KEYIN     CHAININ0                  40
B2000C                     Z-ADDDATE      INXX
B2000C                     TIME           INYY
|   C                     MOVE $USER     INZZ
|   C*
| 05-C           *IN40     IFEQ '0'
|   C                     ADD  WORK      IN06
|   C                     ADD  WORK      IN17
|   C                     ADD  PE07      IN26
|   C                     ADD  PE08      IN27
|   C                     ADD  PE09      IN27
|   C                     UPDATIN0
      *
| 05*C                     ELSE
|   C                     Z-ADD0         IN05
|   C                     Z-ADDWORK      IN06
|   C                     Z-ADD0         IN07
|   C                     Z-ADD0         IN08
|   C                     Z-ADD0         IN09
|   C                     Z-ADD0         IN10
|   C                     Z-ADD0         IN101
|   C                     Z-ADD0         IN11
|   C                     Z-ADD0         IN12
|   C                     Z-ADD0         IN13
|   C                     Z-ADD0         IN14
|   C                     Z-ADD0         IN15
|   C                     Z-ADD0         IN16
|   C                     Z-ADDWORK      IN17
|   C                     Z-ADD0         IN18
|   C                     Z-ADD0         IN19
|   C                     Z-ADD0         IN20
|   C                     Z-ADD0         IN23
|   C                     Z-ADD0         IN24
|   C                     Z-ADD0         IN25
|   C                     Z-ADD0         IN231
|   C                     Z-ADD0         IN241
|   C                     Z-ADD0         IN251
|   C                     Z-ADDPE07      IN26
|   C                     Z-ADDPE08      IN27
|   C                     ADD  PE09      IN27
|   C                     Z-ADD0         IN28
|   C                     Z-ADD0         IN261
|   C                     Z-ADD0         IN271
|   C                     Z-ADD0         IN281
|   C                     Z-ADD0         IN29
|   C                     Z-ADD0         IN30
|   C                     Z-ADD0         IN31
|   C                     Z-ADD0         IN291
|   C                     Z-ADD0         IN301
|   C                     Z-ADD0         IN311
|   C                     Z-ADD0         IN32
|   C                     Z-ADD0         IN33
|   C                     Z-ADD0         IN34
|   C                     Z-ADD0         IN321
|   C                     Z-ADD0         IN331
|   C                     Z-ADD0         IN341
|   C                     Z-ADD0         IN35
|   C                     Z-ADD0         IN36
|   C                     Z-ADD0         IN37
|   C                     Z-ADD0         IN38
|   C                     Z-ADD0         IN39
|   C                     Z-ADD0         IN40
|   C                     Z-ADD0         IN41
|   C**
|   C                     WRITEIN0
      *
| 05-C                     END
|   C*
|   C           KEYPE     READEPE0                      45
| 03-C                     END
|   C*
|   C                     READ PD0                      44
| 02*C                     ELSE
|   C                     SETON                     44
| 02-C                     END
|   C*
| 01-C                     END
|    C*
05===C                     ENDSR
      *===============================================================*
      *          RTN330....國外採購完稅主檔
      *===============================================================*
06===C           RTN330    BEGSR
|    C*
B2000C           SETLL     SETLLPF0
|    C                     READ PF0                      44
| 01-C           *IN44     DOWEQ'0'
|   C*
B2000C                     Z-ADDPF11      WDATE
B2000C           WYYMM     IFEQ W#B16
|   C                     MOVE 'V'       PF13
B2000C                     Z-ADDDATE      PFXX
B2000C                     TIME           PFYY
|   C                     MOVE $USER     PFZZ
|   C**
|   C                     UPDATPF0
|   C                     MOVE PF02      PDNO
|   C                     MOVELPF01      IN01
|   C***
|   C           KEYPG     SETLLPG0
|   C           KEYPG     READEPG0                      45
| 03-C           *IN45     DOWEQ'0'
|   C*PF06保稅物流點
B2000C                     Z-ADDW#B16     IN02
|   C                     MOVE PF06      IN03
|   C                     MOVE PG03      IN04
|   C                     Z-ADDPG07      QTY
|   C                     Z-ADD0         QTY1
|   C                     WRITEPD1
| 04-C           *IN39     IFEQ '1'
|   C                     WRITEPE1
|   C                     WRITEPH1
|   C                     SETOF                     39
| 04-C                     END
|   C*
|   C           KEYIN     CHAININ0                  40
B2000C                     Z-ADDDATE      INXX
B2000C                     TIME           INYY
|   C                     MOVE $USER     INZZ
|   C*
| 05-C           *IN40     IFEQ '0'
|   C                     SUB  PG07      IN19
|   C                     SUB  PG07      IN17
|   C                     SUB  PG12      IN26
|   C                     SUB  PG13      IN27
|   C                     UPDATIN0
      *
| 05*C                     ELSE
|   C                     Z-ADD0         IN05
|   C                     Z-ADD0         IN06
|   C                     Z-ADD0         IN07
|   C                     Z-ADD0         IN08
|   C                     Z-ADD0         IN09
|   C                     Z-ADD0         IN10
|   C                     Z-ADD0         IN101
|   C                     Z-ADD0         IN11
|   C                     Z-ADD0         IN12
|   C                     Z-ADD0         IN13
|   C                     Z-ADD0         IN14
|   C                     Z-ADD0         IN15
|   C                     Z-ADD0         IN16
|   C                     Z-SUBPG07      IN17
|   C                     Z-ADD0         IN18
|   C                     Z-SUBPG07      IN19
|   C                     Z-ADD0         IN20
|   C                     Z-ADD0         IN23
|   C                     Z-ADD0         IN24
|   C                     Z-ADD0         IN25
|   C                     Z-ADD0         IN231
|   C                     Z-ADD0         IN241
|   C                     Z-ADD0         IN251
|   C                     Z-SUBPG12      IN26
|   C                     Z-SUBPG13      IN27
|   C                     Z-ADD0         IN28
|   C                     Z-ADD0         IN261
|   C                     Z-ADD0         IN271
|   C                     Z-ADD0         IN281
|   C                     Z-ADD0         IN29
|   C                     Z-ADD0         IN30
|   C                     Z-ADD0         IN31
|   C                     Z-ADD0         IN291
|   C                     Z-ADD0         IN301
|   C                     Z-ADD0         IN311
|   C                     Z-ADD0         IN32
|   C                     Z-ADD0         IN33
|   C                     Z-ADD0         IN34
|   C                     Z-ADD0         IN321
|   C                     Z-ADD0         IN331
|   C                     Z-ADD0         IN341
|   C                     Z-ADD0         IN35
|   C                     Z-ADD0         IN36
|   C                     Z-ADD0         IN37
|   C                     Z-ADD0         IN38
|   C                     Z-ADD0         IN39
|   C                     Z-ADD0         IN40
|   C                     Z-ADD0         IN41
|   C**
|   C                     WRITEIN0
      *
| 05-C                     END
|   C*PF07完稅物流點
B2000C                     Z-ADDW#B16     IN02
|   C                     MOVE PF07      IN03
|   C                     MOVE PG03      IN04
|   C                     Z-ADDPG07      QTY
|   C                     Z-ADD0         QTY1
|   C                     WRITEPD1
| 06-C           *IN39     IFEQ '1'
|   C                     WRITEPE1
|   C                     WRITEPH1
|   C                     SETOF                     39
| 06-C                     END
|   C*
|   C           KEYIN     CHAININ0                  40
B2000C                     Z-ADDDATE      INXX
B2000C                     TIME           INYY
|   C                     MOVE $USER     INZZ
|   C*
| 07-C           *IN40     IFEQ '0'
|   C                     ADD  PG07      IN06
|   C                     ADD  PG07      IN17
|   C                     ADD  PG12      IN26
|   C                     ADD  PG13      IN27
|   C                     ADD  PG06      IN28
|   C                     UPDATIN0
      *
| 07*C                     ELSE
|   C                     Z-ADD0         IN05
|   C                     Z-ADDPG07      IN06
|   C                     Z-ADD0         IN07
|   C                     Z-ADD0         IN08
|   C                     Z-ADD0         IN09
|   C                     Z-ADD0         IN10
|   C                     Z-ADD0         IN101
|   C                     Z-ADD0         IN11
|   C                     Z-ADD0         IN12
|   C                     Z-ADD0         IN13
|   C                     Z-ADD0         IN14
|   C                     Z-ADD0         IN15
|   C                     Z-ADD0         IN16
|   C                     Z-ADDPG07      IN17
|   C                     Z-ADD0         IN18
|   C                     Z-ADD0         IN19
|   C                     Z-ADD0         IN20
|   C                     Z-ADD0         IN23
|   C                     Z-ADD0         IN24
|   C                     Z-ADD0         IN25
|   C                     Z-ADD0         IN231
|   C                     Z-ADD0         IN241
|   C                     Z-ADD0         IN251
|   C                     Z-ADDPG12      IN26
|   C                     Z-ADDPG13      IN27
|   C                     Z-ADDPG06      IN28
|   C                     Z-ADD0         IN261
|   C                     Z-ADD0         IN271
|   C                     Z-ADD0         IN281
|   C                     Z-ADD0         IN29
|   C                     Z-ADD0         IN30
|   C                     Z-ADD0         IN31
|   C                     Z-ADD0         IN291
|   C                     Z-ADD0         IN301
|   C                     Z-ADD0         IN311
|   C                     Z-ADD0         IN32
|   C                     Z-ADD0         IN33
|   C                     Z-ADD0         IN34
|   C                     Z-ADD0         IN321
|   C                     Z-ADD0         IN331
|   C                     Z-ADD0         IN341
|   C                     Z-ADD0         IN35
|   C                     Z-ADD0         IN36
|   C                     Z-ADD0         IN37
|   C                     Z-ADD0         IN38
|   C                     Z-ADD0         IN39
|   C                     Z-ADD0         IN40
|   C                     Z-ADD0         IN41
|   C**
|   C                     WRITEIN0
      *
| 07-C                     END
|   C*
|   C           KEYPG     READEPG0                      45
| 03-C                     END
|   C*
|   C                     READ PF0                      44
| 02*C                     ELSE
|   C                     SETON                     44
| 02-C                     END
|   C*
| 01-C                     END
|    C*
06===C                     ENDSR
      *===============================================================*
      *          RTN340....國內採購驗收主檔
      *===============================================================*
07===C           RTN340    BEGSR
|    C*
B2000C           SETLL     SETLLPH0
|    C                     READ PH0                      44
| 01-C           *IN44     DOWEQ'0'
|   C*
B2000C                     Z-ADDPH04      WDATE
B2000C           WYYMM     IFEQ W#B16
|   C                     MOVE 'V'       PH10
B2000C                     Z-ADDDATE      PHXX
B2000C                     TIME           PHYY
|   C                     MOVE $USER     PHZZ
|   C**
|   C                     UPDATPH0
|   C                     MOVE PH02      PDNO
|   C                     MOVELPH01      IN01
|   C***
|   C           KEYPI     SETLLPI0
|   C           KEYPI     READEPI0                      45
| 03-C           *IN45     DOWEQ'0'
|   C*
|   C                     Z-ADD0         PC10
|   C                     MOVELPI03      PC02
|   C                     MOVELPI04      PC03
|   C           KEYPC     CHAINPC0                  41
|   C           PI06      MULT PC10      WORK
|   C           PI06      MULT PI07      WORK1
|   C*
B2000C                     Z-ADDW#B16     IN02
|   C                     MOVE PH05      IN03
|   C                     MOVE PI04      IN04
|   C                     Z-ADDWORK      QTY
|   C                     Z-ADD0         QTY1
|   C                     WRITEPD1
| 04-C           *IN39     IFEQ '1'
|   C                     WRITEPE1
|   C                     WRITEPH1
|   C                     SETOF                     39
| 04-C                     END
|   C*
|   C           KEYIN     CHAININ0                  40
B2000C                     Z-ADDDATE      INXX
B2000C                     TIME           INYY
|   C                     MOVE $USER     INZZ
|   C*
| 05-C           *IN40     IFEQ '0'
|   C                     ADD  WORK      IN06
|   C                     ADD  WORK      IN17
|   C                     ADD  WORK1     IN26
|   C                     UPDATIN0
      *
| 05*C                     ELSE
|   C                     Z-ADD0         IN05
|   C                     Z-ADDWORK      IN06
|   C                     Z-ADD0         IN07
|   C                     Z-ADD0         IN08
|   C                     Z-ADD0         IN09
|   C                     Z-ADD0         IN10
|   C                     Z-ADD0         IN101
|   C                     Z-ADD0         IN11
|   C                     Z-ADD0         IN12
|   C                     Z-ADD0         IN13
|   C                     Z-ADD0         IN14
|   C                     Z-ADD0         IN15
|   C                     Z-ADD0         IN16
|   C                     Z-ADDWORK      IN17
|   C                     Z-ADD0         IN18
|   C                     Z-ADD0         IN19
|   C                     Z-ADD0         IN20
|   C                     Z-ADD0         IN23
|   C                     Z-ADD0         IN24
|   C                     Z-ADD0         IN25
|   C                     Z-ADD0         IN231
|   C                     Z-ADD0         IN241
|   C                     Z-ADD0         IN251
|   C                     Z-ADDWORK1     IN26
|   C                     Z-ADD0         IN27
|   C                     Z-ADD0         IN28
|   C                     Z-ADD0         IN261
|   C                     Z-ADD0         IN271
|   C                     Z-ADD0         IN281
|   C                     Z-ADD0         IN29
|   C                     Z-ADD0         IN30
|   C                     Z-ADD0         IN31
|   C                     Z-ADD0         IN291
|   C                     Z-ADD0         IN301
|   C                     Z-ADD0         IN311
|   C                     Z-ADD0         IN32
|   C                     Z-ADD0         IN33
|   C                     Z-ADD0         IN34
|   C                     Z-ADD0         IN321
|   C                     Z-ADD0         IN331
|   C                     Z-ADD0         IN341
|   C                     Z-ADD0         IN35
|   C                     Z-ADD0         IN36
|   C                     Z-ADD0         IN37
|   C                     Z-ADD0         IN38
|   C                     Z-ADD0         IN39
|   C                     Z-ADD0         IN40
|   C                     Z-ADD0         IN41
|   C**
|   C                     WRITEIN0
      *
| 05-C                     END
|   C*
|   C           KEYPI     READEPI0                      45
| 03-C                     END
|   C*
|   C                     READ PH0                      44
| 02*C                     ELSE
|   C                     SETON                     44
| 02-C                     END
|   C*
| 01-C                     END
|    C*
07===C                     ENDSR
      *===============================================================*
      *          RTN350....銷售訂單主檔
      *===============================================================*
08===C           RTN350    BEGSR
|    C*
B2000C           SETLL     SETLLSC0
|    C                     READ SC0                      44
| 01-C           *IN44     DOWEQ'0'
|   C*
B2000C                     Z-ADDSC39      WDATE
B2000C           WYYMM     IFEQ W#B16
|   C                     MOVE 'V'       SC38
B2000C                     Z-ADDDATE      SCXX
B2000C                     TIME           SCYY
|   C                     MOVE $USER     SCZZ
|   C**
|   C                     UPDATSC0
|   C                     MOVE SC02      PDNO
|   C***物流點
| 03-C           SC03      IFEQ 'SB'
|   C           SC03      OREQ 'SC'
      *KEEP KEY
B2000C                     Z-ADDSC39      KDATE
|   C                     MOVELSC01      KCOMP
|   C                     MOVELSC02      KORD
|   C           KORD      CHAINSP0                  40
|   C           SP01      CHAINSC0L                 40
      *原始單別物流點
|   C                     MOVELSC04      IN03
B2000C           KEYKEP    CHAINSC0                  40
      *
| 03*C                     ELSE
|   C                     MOVE SC04      IN03
| 03-C                     END
      ***
|   C           KEYSD     SETLLSD0
|   C           KEYSD     READESD0                      45
| 04-C           *IN45     DOWEQ'0'
|   C*
|   C                     MOVELSD01      COMPL
      *數量
|   C           SD04      ADD  SD05      WSD04
      *成本
|   C           SD10      ADD  SD11      WSD10
|   C                     ADD  SD12      WSD10
|   C*----------------------------------------------------------------
| 05-C           SC03      IFNE 'S2'
|   C           SC03      ANDNE'SB'
|   C           SC03      ANDNE'S3'
|   C           SC03      ANDNE'SC'
|   C                     MOVELSD01      IN01
B2000C                     Z-ADDW#B16     IN02
|   C                     MOVE SD03      IN04
|   C                     Z-ADDSD04      QTY
|   C                     Z-ADDSD05      QTY1
|   C                     WRITEPD1
| 06-C           *IN39     IFEQ '1'
|   C                     WRITEPE1
|   C                     WRITEPH1
|   C                     SETOF                     39
| 06-C                     END
|   C*
|   C           KEYIN     CHAININ0                  40
B2000C                     Z-ADDDATE      INXX
B2000C                     TIME           INYY
|   C                     MOVE $USER     INZZ
|   C*
| 07-C           *IN40     IFEQ '0'
|   C                     SUB  SD04      IN07
|   C                     SUB  SD05      IN08
|   C                     SUB  SD04      IN17
|   C                     SUB  SD05      IN17
      *
| 08-C           SD16      IFEQ COMPL
|   C           WSD04     MULT SD10      WORK
|   C                     SUB  WORK      IN26
|   C           WSD04     MULT SD11      WORK
|   C                     SUB  WORK      IN27
|   C           WSD04     MULT SD12      WORK
|   C                     SUB  WORK      IN28
| 08-C                     END
      *
|   C           WSD04     MULT SD10      WORK
|   C                     ADD  WORK      IN29
|   C           WSD04     MULT SD11      WORK
|   C                     ADD  WORK      IN30
|   C           WSD04     MULT SD12      WORK
|   C                     ADD  WORK      IN31
|   C                     UPDATIN0
      *
| 07*C                     ELSE
|   C                     Z-ADD0         IN05
|   C                     Z-ADD0         IN06
|   C                     Z-SUBSD04      IN07
|   C                     Z-SUBSD05      IN08
|   C                     Z-ADD0         IN09
|   C                     Z-ADD0         IN10
|   C                     Z-ADD0         IN101
|   C                     Z-ADD0         IN11
|   C                     Z-ADD0         IN12
|   C                     Z-ADD0         IN13
|   C                     Z-ADD0         IN14
|   C                     Z-ADD0         IN15
|   C                     Z-ADD0         IN16
|   C                     Z-SUBSD04      IN17
|   C                     SUB  SD05      IN17
|   C                     Z-ADD0         IN18
|   C                     Z-ADD0         IN19
|   C                     Z-ADD0         IN20
|   C           SD04      ADD  SD05      WSD04
|   C           SD10      ADD  SD11      WSD10
|   C                     ADD  SD12      WSD10
|   C                     Z-ADD0         IN23
|   C                     Z-ADD0         IN24
|   C                     Z-ADD0         IN25
|   C                     Z-ADD0         IN231
|   C                     Z-ADD0         IN241
|   C                     Z-ADD0         IN251
      *
| 09-C           SD16      IFEQ COMPL
|   C           WSD04     MULT SD10      WORK
|   C                     Z-SUBWORK      IN26
|   C           WSD04     MULT SD11      WORK
|   C                     Z-SUBWORK      IN27
|   C           WSD04     MULT SD12      WORK
|   C                     Z-SUBWORK      IN28
| 09*C                     ELSE
|   C                     Z-ADD0         IN26
|   C                     Z-ADD0         IN27
|   C                     Z-ADD0         IN28
| 09-C                     END
|   C                     Z-ADD0         IN261
|   C                     Z-ADD0         IN271
|   C                     Z-ADD0         IN281
      *
|   C           WSD04     MULT SD10      IN29
|   C           WSD04     MULT SD11      IN30
|   C           WSD04     MULT SD12      IN31
|   C                     Z-ADD0         IN291
|   C                     Z-ADD0         IN301
|   C                     Z-ADD0         IN311
|   C                     Z-ADD0         IN32
|   C                     Z-ADD0         IN33
|   C                     Z-ADD0         IN34
|   C                     Z-ADD0         IN321
|   C                     Z-ADD0         IN331
|   C                     Z-ADD0         IN341
|   C                     Z-ADD0         IN35
|   C                     Z-ADD0         IN36
|   C                     Z-ADD0         IN37
|   C                     Z-ADD0         IN38
|   C                     Z-ADD0         IN39
|   C                     Z-ADD0         IN40
|   C                     Z-ADD0         IN41
|   C**
|   C                     WRITEIN0
| 07-C                     END
| 05-C                     END
      *----------------------------------------------------------------
| 10-C           SC03      IFEQ 'S2'
|   C           SC03      OREQ 'SB'
|   C           SC03      OREQ 'S3'
|   C           SC03      OREQ 'SC'
      *
|   C                     MOVELSD01      IN01
B2000C                     Z-ADDW#B16     IN02
|   C                     MOVE SD03      IN04
|   C                     Z-ADDSD04      QTY
|   C                     Z-ADDSD05      QTY1
|   C                     WRITEPD1
| 11-C           *IN39     IFEQ '1'
|   C                     WRITEPE1
|   C                     WRITEPH1
|   C                     SETOF                     39
| 11-C                     END
|   C*
|   C           KEYIN     CHAININ0                  40
B2000C                     Z-ADDDATE      INXX
B2000C                     TIME           INYY
|   C                     MOVE $USER     INZZ
|   C*
| 12-C           *IN40     IFEQ '0'
|   C                     SUB  SD04      IN07
|   C                     SUB  SD05      IN08
      *
| 13-C           SD16      IFEQ COMPL
|   C                     SUB  SD04      IN17
|   C                     SUB  SD05      IN17
|   C           WSD04     MULT SD10      WORK
|   C                     SUB  WORK      IN26
|   C           WSD04     MULT SD11      WORK
|   C                     SUB  WORK      IN27
|   C           WSD04     MULT SD12      WORK
|   C                     SUB  WORK      IN28
| 13*C                     ELSE
|   C                     ADD  WSD04     IN06
| 13-C                     END
      *
|   C           WSD04     MULT SD10      WORK
|   C                     ADD  WORK      IN29
|   C           WSD04     MULT SD11      WORK
|   C                     ADD  WORK      IN30
|   C           WSD04     MULT SD12      WORK
|   C                     ADD  WORK      IN31
|   C                     UPDATIN0
      *
| 12*C                     ELSE
|   C                     Z-ADD0         IN05
|   C                     Z-SUBSD04      IN07
|   C                     Z-SUBSD05      IN08
|   C                     Z-ADD0         IN09
|   C                     Z-ADD0         IN10
|   C                     Z-ADD0         IN101
|   C                     Z-ADD0         IN11
|   C                     Z-ADD0         IN12
|   C                     Z-ADD0         IN13
|   C                     Z-ADD0         IN14
|   C                     Z-ADD0         IN15
|   C                     Z-ADD0         IN16
|   C                     Z-ADD0         IN18
|   C                     Z-ADD0         IN19
|   C                     Z-ADD0         IN20
|   C                     Z-ADD0         IN23
|   C                     Z-ADD0         IN24
|   C                     Z-ADD0         IN25
|   C                     Z-ADD0         IN231
|   C                     Z-ADD0         IN241
|   C                     Z-ADD0         IN251
      *
| 14-C           SD16      IFEQ COMPL
|   C                     Z-ADD0         IN06
|   C                     Z-SUBWSD04     IN17
|   C           WSD04     MULT SD10      WORK
|   C                     Z-SUBWORK      IN26
|   C           WSD04     MULT SD11      WORK
|   C                     Z-SUBWORK      IN27
|   C           WSD04     MULT SD12      WORK
|   C                     Z-SUBWORK      IN28
| 14*C                     ELSE
|   C                     Z-ADDWSD04     IN06
|   C                     Z-ADD0         IN17
|   C                     Z-ADD0         IN26
|   C                     Z-ADD0         IN27
|   C                     Z-ADD0         IN28
| 14-C                     END
|   C                     Z-ADD0         IN261
|   C                     Z-ADD0         IN271
|   C                     Z-ADD0         IN281
      *
|   C           WSD04     MULT SD10      IN29
|   C           WSD04     MULT SD11      IN30
|   C           WSD04     MULT SD12      IN31
|   C                     Z-ADD0         IN291
|   C                     Z-ADD0         IN301
|   C                     Z-ADD0         IN311
|   C                     Z-ADD0         IN32
|   C                     Z-ADD0         IN33
|   C                     Z-ADD0         IN34
|   C                     Z-ADD0         IN321
|   C                     Z-ADD0         IN331
|   C                     Z-ADD0         IN341
|   C                     Z-ADD0         IN35
|   C                     Z-ADD0         IN36
|   C                     Z-ADD0         IN37
|   C                     Z-ADD0         IN38
|   C                     Z-ADD0         IN39
|   C                     Z-ADD0         IN40
|   C                     Z-ADD0         IN41
|   C**
|   C                     WRITEIN0
| 12-C                     END
| 10-C                     END
      *----------------------------------------------------------------
|   C           KEYSD     READESD0                      45
| 04-C                     END
|   C*
|   C                     READ SC0                      44
| 02*C                     ELSE
|   C                     SETON                     44
| 02-C                     END
|   C*
| 01-C                     END
|    C*
08===C                     ENDSR
      *===============================================================*
      *          RTN360....送貨單主檔
      *===============================================================*
09===C           RTN360    BEGSR
|    C*
B2000C           SETLL     SETLLSE0
|    C                     READ SE0                      44
| 01-C           *IN44     DOWEQ'0'
|   C*
B2000C                     Z-ADDSE24      WDATE
B2000C           WYYMM     IFEQ W#B16
|   C                     MOVE 'V'       SE40
B2000C                     Z-ADDDATE      SEXX
B2000C                     TIME           SEYY
|   C                     MOVE $USER     SEZZ
|   C**
|   C                     UPDATSE0
|   C                     MOVE SE02      PDNO
|   C***
|   C           KEYSF     SETLLSF0
|   C           KEYSF     READESF0                      45
| 03-C           *IN45     DOWEQ'0'
|   C*將ＳＤ之成本覆於ＳＦ上，因計算成本應已訂單成本為主
      *D1,D4,D7,D9
|   C           KEYSFD    CHAINSD0                  40
| 04-C           *IN40     IFEQ '0'
|   C                     Z-ADDSD10      SF10
|   C                     Z-ADDSD11      SF11
|   C                     Z-ADDSD12      SF12
| 04-C                     END
      *CHAIN NOT FOUND則延用原送貨成本
      *D2,D3,D5,D6,D8
|   C           SF19      ADD  SF20      WSD04
|   C                     MOVELSF01      COMPL
|   C*----------------------------------------------------------------
| 05-C           SE03      IFEQ 'D1'
|   C           SE03      OREQ 'DA'
|   C           SE03      OREQ 'D9'
|   C           SE03      OREQ 'DI'
|   C                     MOVELSF01      IN01
B2000C                     Z-ADDW#B16     IN02
|   C                     MOVE SE07      IN03
|   C                     MOVE SF03      IN04
|   C                     Z-ADDSF19      QTY
|   C                     Z-ADDSF20      QTY1
|   C                     WRITEPD1
| 06-C           *IN39     IFEQ '1'
|   C                     WRITEPE1
|   C                     WRITEPH1
|   C                     SETOF                     39
| 06-C                     END
|   C*
|   C           KEYIN     CHAININ0                  40
B2000C                     Z-ADDDATE      INXX
B2000C                     TIME           INYY
|   C                     MOVE $USER     INZZ
|   C*
|   C*產品歸屬＝公司第一碼
| 07-C           SF16      IFEQ COMPL
| 08-C           *IN40     IFEQ '0'
|   C                     SUB  SF19      IN07
|   C                     SUB  SF20      IN08
|   C                     SUB  WSD04     IN17
|   C           SF10      ADD  SF11      WSD10
|   C                     ADD  SF12      WSD10
|   C           SF10      MULT WSD04     WORK
|   C                     SUB  WORK      IN26
|   C           SF11      MULT WSD04     WORK
|   C                     SUB  WORK      IN27
|   C           SF12      MULT WSD04     WORK
|   C                     SUB  WORK      IN28
|   C           WSD04     MULT SF10      WORK
|   C                     ADD  WORK      IN29
|   C           WSD04     MULT SF11      WORK
|   C                     ADD  WORK      IN30
|   C           WSD04     MULT SF12      WORK
|   C                     ADD  WORK      IN31
|   C                     UPDATIN0
      *
| 08*C                     ELSE
|   C                     Z-ADD0         IN05
|   C                     Z-ADD0         IN06
|   C                     Z-SUBSF19      IN07
|   C                     Z-SUBSF20      IN08
|   C                     Z-ADD0         IN09
|   C                     Z-ADD0         IN10
|   C                     Z-ADD0         IN101
|   C                     Z-ADD0         IN11
|   C                     Z-ADD0         IN12
|   C                     Z-ADD0         IN13
|   C                     Z-ADD0         IN14
|   C                     Z-ADD0         IN15
|   C                     Z-ADD0         IN16
|   C                     Z-SUBWSD04     IN17
|   C                     Z-ADD0         IN18
|   C                     Z-ADD0         IN19
|   C                     Z-ADD0         IN20
|   C           SF10      ADD  SF11      WSD10
|   C                     ADD  SF12      WSD10
|   C                     Z-ADD0         IN23
|   C                     Z-ADD0         IN24
|   C                     Z-ADD0         IN25
|   C                     Z-ADD0         IN231
|   C                     Z-ADD0         IN241
|   C                     Z-ADD0         IN251
|   C           SF10      MULT WSD04     WORK
|   C                     Z-SUBWORK      IN26
|   C           SF11      MULT WSD04     WORK
|   C                     Z-SUBWORK      IN27
|   C           SF12      MULT WSD04     WORK
|   C                     Z-SUBWORK      IN28
|   C                     Z-ADD0         IN261
|   C                     Z-ADD0         IN271
|   C                     Z-ADD0         IN281
|   C           SF10      MULT WSD04     IN29
|   C           SF11      MULT WSD04     IN30
|   C           SF12      MULT WSD04     IN31
|   C                     Z-ADD0         IN291
|   C                     Z-ADD0         IN301
|   C                     Z-ADD0         IN311
|   C                     Z-ADD0         IN32
|   C                     Z-ADD0         IN33
|   C                     Z-ADD0         IN34
|   C                     Z-ADD0         IN321
|   C                     Z-ADD0         IN331
|   C                     Z-ADD0         IN341
|   C                     Z-ADD0         IN35
|   C                     Z-ADD0         IN36
|   C                     Z-ADD0         IN37
|   C                     Z-ADD0         IN38
|   C                     Z-ADD0         IN39
|   C                     Z-ADD0         IN40
|   C                     Z-ADD0         IN41
|   C**
|   C                     WRITEIN0
      *
| 08-C                     END
|   C*產品歸屬＜＞公司第一碼
| 07*C                     ELSE
| 09-C           *IN40     IFEQ '0'
|   C                     ADD  WSD04     IN06
|   C                     SUB  SF19      IN07
|   C                     SUB  SF20      IN08
|   C           SF10      ADD  SF11      WSD10
|   C                     ADD  SF12      WSD10
|   C           SF10      MULT WSD04     WORK
|   C                     ADD  WORK      IN29
|   C           SF11      MULT WSD04     WORK
|   C                     ADD  WORK      IN30
|   C           SF12      MULT WSD04     WORK
|   C                     ADD  WORK      IN31
|   C                     UPDATIN0
      *
| 09*C                     ELSE
|   C                     Z-ADD0         IN05
|   C                     Z-ADDWSD04     IN06
|   C                     Z-SUBSF19      IN07
|   C                     Z-SUBSF20      IN08
|   C                     Z-ADD0         IN09
|   C                     Z-ADD0         IN10
|   C                     Z-ADD0         IN101
|   C                     Z-ADD0         IN11
|   C                     Z-ADD0         IN12
|   C                     Z-ADD0         IN13
|   C                     Z-ADD0         IN14
|   C                     Z-ADD0         IN15
|   C                     Z-ADD0         IN16
|   C                     Z-ADD0         IN17
|   C                     Z-ADD0         IN18
|   C                     Z-ADD0         IN19
|   C                     Z-ADD0         IN20
|   C           SF10      ADD  SF11      WSD10
|   C                     ADD  SF12      WSD10
|   C                     Z-ADD0         IN23
|   C                     Z-ADD0         IN24
|   C                     Z-ADD0         IN25
|   C                     Z-ADD0         IN231
|   C                     Z-ADD0         IN241
|   C                     Z-ADD0         IN251
|   C                     Z-ADD0         IN26
|   C                     Z-ADD0         IN27
|   C                     Z-ADD0         IN28
|   C                     Z-ADD0         IN261
|   C                     Z-ADD0         IN271
|   C                     Z-ADD0         IN281
|   C           SF10      MULT WSD04     IN29
|   C           SF11      MULT WSD04     IN30
|   C           SF12      MULT WSD04     IN31
|   C                     Z-ADD0         IN291
|   C                     Z-ADD0         IN301
|   C                     Z-ADD0         IN311
|   C                     Z-ADD0         IN32
|   C                     Z-ADD0         IN33
|   C                     Z-ADD0         IN34
|   C                     Z-ADD0         IN321
|   C                     Z-ADD0         IN331
|   C                     Z-ADD0         IN341
|   C                     Z-ADD0         IN35
|   C                     Z-ADD0         IN36
|   C                     Z-ADD0         IN37
|   C                     Z-ADD0         IN38
|   C                     Z-ADD0         IN39
|   C                     Z-ADD0         IN40
|   C                     Z-ADD0         IN41
|   C**
|   C                     WRITEIN0
      *
| 09-C                     END
| 07-C                     END
| 05-C                     END
|   C*----------------------------------------------------------------
| 10-C           SE03      IFEQ 'DB'
|   C                     MOVELSF01      IN01
B2000C                     Z-ADDW#B16     IN02
|   C***物流點
      *KEEP KEY
B2000C                     Z-ADDSE24      KDATE
|   C                     MOVELSE01      KCOMP
|   C                     MOVELSE02      KORD
|   C           KORD      CHAINSP0                  40
|   C           SP01      CHAINSE0L                 40
      *原始單別物流點
|   C                     MOVELSE04      IN03
B2000C           KEYKEP    CHAINSE0                  40
      ***
|   C                     MOVE SF03      IN04
|   C                     Z-ADDSF19      QTY
|   C                     Z-ADDSF20      QTY1
|   C                     WRITEPD1
| 11-C           *IN39     IFEQ '1'
|   C                     WRITEPE1
|   C                     WRITEPH1
|   C                     SETOF                     39
| 11-C                     END
|   C*
|   C           KEYIN     CHAININ0                  40
B2000C                     Z-ADDDATE      INXX
B2000C                     TIME           INYY
|   C                     MOVE $USER     INZZ
|   C*
| 12-C           *IN40     IFEQ '0'
|   C                     ADD  WSD04     IN06
|   C                     ADD  WSD04     IN17
      *
|   C           SF10      MULT WSD04     WORK
|   C                     ADD  WORK      IN26
|   C           SF11      MULT WSD04     WORK
|   C                     ADD  WORK      IN27
|   C           SF12      MULT WSD04     WORK
|   C                     ADD  WORK      IN28
      *
|   C                     UPDATIN0
      *
| 12*C                     ELSE
|   C                     Z-ADD0         IN05
|   C                     Z-ADDWSD04     IN06
|   C                     Z-ADD0         IN07
|   C                     Z-ADD0         IN08
|   C                     Z-ADD0         IN09
|   C                     Z-ADD0         IN10
|   C                     Z-ADD0         IN101
|   C                     Z-ADD0         IN11
|   C                     Z-ADD0         IN12
|   C                     Z-ADD0         IN13
|   C                     Z-ADD0         IN14
|   C                     Z-ADD0         IN15
|   C                     Z-ADD0         IN16
|   C                     Z-ADDWSD04     IN17
|   C                     Z-ADD0         IN18
|   C                     Z-ADD0         IN19
|   C                     Z-ADD0         IN20
|   C                     Z-ADD0         IN23
|   C                     Z-ADD0         IN24
|   C                     Z-ADD0         IN25
|   C                     Z-ADD0         IN231
|   C                     Z-ADD0         IN241
|   C                     Z-ADD0         IN251
      *
|   C           SF10      MULT WSD04     IN26
|   C           SF11      MULT WSD04     IN27
|   C           SF12      MULT WSD04     IN28
|   C                     Z-ADD0         IN261
|   C                     Z-ADD0         IN271
|   C                     Z-ADD0         IN281
      *
|   C                     Z-ADD0         IN29
|   C                     Z-ADD0         IN30
|   C                     Z-ADD0         IN31
|   C                     Z-ADD0         IN291
|   C                     Z-ADD0         IN301
|   C                     Z-ADD0         IN311
|   C                     Z-ADD0         IN32
|   C                     Z-ADD0         IN33
|   C                     Z-ADD0         IN34
|   C                     Z-ADD0         IN321
|   C                     Z-ADD0         IN331
|   C                     Z-ADD0         IN341
|   C                     Z-ADD0         IN35
|   C                     Z-ADD0         IN36
|   C                     Z-ADD0         IN37
|   C                     Z-ADD0         IN38
|   C                     Z-ADD0         IN39
|   C                     Z-ADD0         IN40
|   C                     Z-ADD0         IN41
|   C**
|   C                     WRITEIN0
      *
| 12-C                     END
|   C*產品歸屬＝公司第一碼
|   C                     MOVELSF01      IN01
B2000C                     Z-ADDW#B16     IN02
      *出貨物流點
|   C                     MOVE SE07      IN03
|   C                     MOVE SF03      IN04
|   C                     Z-ADDSF19      QTY
|   C                     Z-ADDSF20      QTY1
|   C                     WRITEPD1
| 13-C           *IN39     IFEQ '1'
|   C                     WRITEPE1
|   C                     WRITEPH1
|   C                     SETOF                     39
| 13-C                     END
|   C*
|   C           KEYIN     CHAININ0                  40
B2000C                     Z-ADDDATE      INXX
B2000C                     TIME           INYY
|   C                     MOVE $USER     INZZ
|   C*
| 14-C           *IN40     IFEQ '0'
      *
|   C                     SUB  WSD04     IN11
      *
|   C                     SUB  WSD04     IN17
|   C           SF10      MULT WSD04     WORK
|   C                     SUB  WORK      IN26
|   C           SF11      MULT WSD04     WORK
|   C                     SUB  WORK      IN27
|   C           SF12      MULT WSD04     WORK
|   C                     SUB  WORK      IN28
|   C                     UPDATIN0
      *
| 14*C                     ELSE
|   C                     Z-ADD0         IN05
|   C                     Z-ADD0         IN06
|   C                     Z-ADD0         IN07
|   C                     Z-ADD0         IN08
|   C                     Z-ADD0         IN09
|   C                     Z-ADD0         IN10
|   C                     Z-ADD0         IN101
|   C                     Z-SUBWSD04     IN11
|   C                     Z-ADD0         IN12
|   C                     Z-ADD0         IN13
|   C                     Z-ADD0         IN14
|   C                     Z-ADD0         IN15
|   C                     Z-ADD0         IN16
|   C                     Z-SUBWSD04     IN17
|   C                     Z-ADD0         IN18
|   C                     Z-ADD0         IN19
|   C                     Z-ADD0         IN20
|   C                     Z-ADD0         IN23
|   C                     Z-ADD0         IN24
|   C                     Z-ADD0         IN25
|   C                     Z-ADD0         IN231
|   C                     Z-ADD0         IN241
|   C                     Z-ADD0         IN251
|   C           SF10      MULT WSD04     WORK
|   C                     Z-SUBWORK      IN26
|   C           SF11      MULT WSD04     WORK
|   C                     Z-SUBWORK      IN27
|   C           SF12      MULT WSD04     WORK
|   C                     Z-SUBWORK      IN28
|   C                     Z-ADD0         IN261
|   C                     Z-ADD0         IN271
|   C                     Z-ADD0         IN281
|   C                     Z-ADD0         IN29
|   C                     Z-ADD0         IN30
|   C                     Z-ADD0         IN31
|   C                     Z-ADD0         IN291
|   C                     Z-ADD0         IN301
|   C                     Z-ADD0         IN311
|   C                     Z-ADD0         IN32
|   C                     Z-ADD0         IN33
|   C                     Z-ADD0         IN34
|   C                     Z-ADD0         IN321
|   C                     Z-ADD0         IN331
|   C                     Z-ADD0         IN341
|   C                     Z-ADD0         IN35
|   C                     Z-ADD0         IN36
|   C                     Z-ADD0         IN37
|   C                     Z-ADD0         IN38
|   C                     Z-ADD0         IN39
|   C                     Z-ADD0         IN40
|   C                     Z-ADD0         IN41
|   C**
|   C                     WRITEIN0
      *
| 14-C                     END
|   C*
| 10-C                     END
|   C*----------------------------------------------------------------
|   C*產品歸屬＝公司第一碼
| 15-C           SE03      IFEQ 'D3'
|   C           SE03      OREQ 'D5'
|   C           SE03      OREQ 'DC'
|   C           SE03      OREQ 'DE'
| 16-C           COMPL     IFEQ SF16
|   C*
|   C                     MOVELSF01      IN01
B2000C                     Z-ADDW#B16     IN02
      *客戶
| 17-C           SE03      IFEQ 'DC'
|   C           SE03      OREQ 'DE'
|   C***物流點
      *KEEP KEY
B2000C                     Z-ADDSE24      KDATE
|   C                     MOVELSE01      KCOMP
|   C                     MOVELSE02      KORD
|   C           KORD      CHAINSP0                  40
|   C           SP01      CHAINSE0L                 40
      *原始單別物流點
|   C                     MOVELSE04      IN03
B2000C           KEYKEP    CHAINSE0                  40
| 17*C                     ELSE
|   C                     MOVELSE04      IN03
| 17-C                     END
      ***
|   C                     MOVE SF03      IN04
|   C                     Z-ADDSF19      QTY
|   C                     Z-ADDSF20      QTY1
|   C                     WRITEPD1
| 18-C           *IN39     IFEQ '1'
|   C                     WRITEPE1
|   C                     WRITEPH1
|   C                     SETOF                     39
| 18-C                     END
|   C*
|   C           KEYIN     CHAININ0                  40
B2000C                     Z-ADDDATE      INXX
B2000C                     TIME           INYY
|   C                     MOVE $USER     INZZ
|   C*
| 19-C           *IN40     IFEQ '0'
|   C                     ADD  WSD04     IN06
|   C                     ADD  WSD04     IN17
|   C           SF10      MULT WSD04     WORK
|   C                     ADD  WORK      IN26
|   C           SF11      MULT WSD04     WORK
|   C                     ADD  WORK      IN27
|   C           SF12      MULT WSD04     WORK
|   C                     ADD  WORK      IN28
|   C                     UPDATIN0
      *
| 19*C                     ELSE
|   C                     Z-ADD0         IN05
|   C                     Z-ADDWSD04     IN06
|   C                     Z-ADD0         IN07
|   C                     Z-ADD0         IN08
|   C                     Z-ADD0         IN09
|   C                     Z-ADD0         IN10
|   C                     Z-ADD0         IN101
|   C                     Z-ADD0         IN11
|   C                     Z-ADD0         IN12
|   C                     Z-ADD0         IN13
|   C                     Z-ADD0         IN14
|   C                     Z-ADD0         IN15
|   C                     Z-ADD0         IN16
|   C                     Z-ADDWSD04     IN17
|   C                     Z-ADD0         IN18
|   C                     Z-ADD0         IN19
|   C                     Z-ADD0         IN20
|   C                     Z-ADD0         IN23
|   C                     Z-ADD0         IN24
|   C                     Z-ADD0         IN25
|   C                     Z-ADD0         IN231
|   C                     Z-ADD0         IN241
|   C                     Z-ADD0         IN251
|   C           SF10      MULT WSD04     WORK
|   C                     Z-ADDWORK      IN26
|   C           SF11      MULT WSD04     WORK
|   C                     Z-ADDWORK      IN27
|   C           SF12      MULT WSD04     WORK
|   C                     Z-ADDWORK      IN28
|   C                     Z-ADD0         IN261
|   C                     Z-ADD0         IN271
|   C                     Z-ADD0         IN281
|   C                     Z-ADD0         IN29
|   C                     Z-ADD0         IN30
|   C                     Z-ADD0         IN31
|   C                     Z-ADD0         IN291
|   C                     Z-ADD0         IN301
|   C                     Z-ADD0         IN311
|   C                     Z-ADD0         IN32
|   C                     Z-ADD0         IN33
|   C                     Z-ADD0         IN34
|   C                     Z-ADD0         IN321
|   C                     Z-ADD0         IN331
|   C                     Z-ADD0         IN341
|   C                     Z-ADD0         IN35
|   C                     Z-ADD0         IN36
|   C                     Z-ADD0         IN37
|   C                     Z-ADD0         IN38
|   C                     Z-ADD0         IN39
|   C                     Z-ADD0         IN40
|   C                     Z-ADD0         IN41
|   C**
|   C                     WRITEIN0
      *
| 19-C                     END
      *
|   C                     MOVELSF01      IN01
B2000C                     Z-ADDW#B16     IN02
      *出貨物流點
|   C                     MOVE SE07      IN03
|   C                     MOVE SF03      IN04
|   C                     Z-ADDSF19      QTY
|   C                     Z-ADDSF20      QTY1
|   C                     WRITEPD1
| 20-C           *IN39     IFEQ '1'
|   C                     WRITEPE1
|   C                     WRITEPH1
|   C                     SETOF                     39
| 20-C                     END
|   C*
|   C           KEYIN     CHAININ0                  40
B2000C                     Z-ADDDATE      INXX
B2000C                     TIME           INYY
|   C                     MOVE $USER     INZZ
|   C*
| 21-C           *IN40     IFEQ '0'
|   C                     SUB  WSD04     IN12
|   C                     SUB  WSD04     IN17
|   C           SF10      MULT WSD04     WORK
|   C                     SUB  WORK      IN26
|   C           SF11      MULT WSD04     WORK
|   C                     SUB  WORK      IN27
|   C           SF12      MULT WSD04     WORK
|   C                     SUB  WORK      IN28
|   C                     UPDATIN0
      *
| 21*C                     ELSE
|   C                     Z-ADD0         IN05
|   C                     Z-ADD0         IN06
|   C                     Z-ADD0         IN07
|   C                     Z-ADD0         IN08
|   C                     Z-ADD0         IN09
|   C                     Z-ADD0         IN10
|   C                     Z-ADD0         IN101
|   C                     Z-ADD0         IN11
|   C                     Z-SUBWSD04     IN12
|   C                     Z-ADD0         IN13
|   C                     Z-ADD0         IN14
|   C                     Z-ADD0         IN15
|   C                     Z-ADD0         IN16
|   C                     Z-SUBWSD04     IN17
|   C                     Z-ADD0         IN18
|   C                     Z-ADD0         IN19
|   C                     Z-ADD0         IN20
|   C                     Z-ADD0         IN23
|   C                     Z-ADD0         IN24
|   C                     Z-ADD0         IN25
|   C                     Z-ADD0         IN231
|   C                     Z-ADD0         IN241
|   C                     Z-ADD0         IN251
|   C           SF10      MULT WSD04     WORK
|   C                     Z-SUBWORK      IN26
|   C           SF11      MULT WSD04     WORK
|   C                     Z-SUBWORK      IN27
|   C           SF12      MULT WSD04     WORK
|   C                     Z-SUBWORK      IN28
|   C                     Z-ADD0         IN261
|   C                     Z-ADD0         IN271
|   C                     Z-ADD0         IN281
|   C                     Z-ADD0         IN29
|   C                     Z-ADD0         IN30
|   C                     Z-ADD0         IN31
|   C                     Z-ADD0         IN291
|   C                     Z-ADD0         IN301
|   C                     Z-ADD0         IN311
|   C                     Z-ADD0         IN32
|   C                     Z-ADD0         IN33
|   C                     Z-ADD0         IN34
|   C                     Z-ADD0         IN321
|   C                     Z-ADD0         IN331
|   C                     Z-ADD0         IN341
|   C                     Z-ADD0         IN35
|   C                     Z-ADD0         IN36
|   C                     Z-ADD0         IN37
|   C                     Z-ADD0         IN38
|   C                     Z-ADD0         IN39
|   C                     Z-ADD0         IN40
|   C                     Z-ADD0         IN41
|   C**
|   C                     WRITEIN0
      *
| 21-C                     END
| 16-C                     END
| 15-C                     END
|   C*----------------------------------------------------------------
|   C*產品歸屬＝公司第一碼
| 22-C           SE03      IFEQ 'D4'
|   C           SE03      OREQ 'DD'
| 23-C           SF16      IFEQ COMPL
|   C                     MOVELSF01      IN01
B2000C                     Z-ADDW#B16     IN02
|   C                     MOVE SE07      IN03
|   C                     MOVE SF03      IN04
|   C                     Z-ADDSF19      QTY
|   C                     Z-ADDSF20      QTY1
|   C                     WRITEPD1
| 24-C           *IN39     IFEQ '1'
|   C                     WRITEPE1
|   C                     WRITEPH1
|   C                     SETOF                     39
| 24-C                     END
|   C*
|   C           KEYIN     CHAININ0                  40
B2000C                     Z-ADDDATE      INXX
B2000C                     TIME           INYY
|   C                     MOVE $USER     INZZ
|   C*
| 25-C           *IN40     IFEQ '0'
|   C                     SUB  SF20      IN08
|   C                     SUB  SF19      IN09
|   C                     SUB  WSD04     IN17
|   C           SF10      MULT WSD04     WORK
|   C                     SUB  WORK      IN26
|   C                     SUB  WORK      IN261
|   C                     ADD  WORK      IN291
|   C           SF11      MULT WSD04     WORK
|   C                     SUB  WORK      IN27
|   C                     SUB  WORK      IN271
|   C                     ADD  WORK      IN301
|   C           SF12      MULT WSD04     WORK
|   C                     SUB  WORK      IN28
|   C                     SUB  WORK      IN281
|   C                     ADD  WORK      IN311
|   C                     UPDATIN0
      *
| 25*C                     ELSE
|   C                     Z-ADD0         IN05
|   C                     Z-ADD0         IN06
|   C                     Z-ADD0         IN07
|   C                     Z-SUBSF20      IN08
|   C                     Z-SUBSF19      IN09
|   C                     Z-ADD0         IN10
|   C                     Z-ADD0         IN101
|   C                     Z-ADD0         IN11
|   C                     Z-ADD0         IN12
|   C                     Z-ADD0         IN13
|   C                     Z-ADD0         IN14
|   C                     Z-ADD0         IN15
|   C                     Z-ADD0         IN16
|   C                     Z-SUBWSD04     IN17
|   C                     Z-ADD0         IN18
|   C                     Z-ADD0         IN19
|   C                     Z-ADD0         IN20
|   C                     Z-ADD0         IN23
|   C                     Z-ADD0         IN24
|   C                     Z-ADD0         IN25
|   C                     Z-ADD0         IN231
|   C                     Z-ADD0         IN241
|   C                     Z-ADD0         IN251
      *
|   C           SF10      MULT WSD04     WORK
|   C                     Z-SUBWORK      IN26
|   C                     Z-SUBWORK      IN261
|   C                     Z-ADDWORK      IN291
|   C           SF11      MULT WSD04     WORK
|   C                     Z-SUBWORK      IN27
|   C                     Z-SUBWORK      IN271
|   C                     Z-ADDWORK      IN301
|   C           SF12      MULT WSD04     WORK
|   C                     Z-SUBWORK      IN28
|   C                     Z-SUBWORK      IN281
|   C                     Z-ADDWORK      IN311
      *
|   C                     Z-ADD0         IN29
|   C                     Z-ADD0         IN30
|   C                     Z-ADD0         IN31
|   C                     Z-ADD0         IN32
|   C                     Z-ADD0         IN33
|   C                     Z-ADD0         IN34
|   C                     Z-ADD0         IN321
|   C                     Z-ADD0         IN331
|   C                     Z-ADD0         IN341
|   C                     Z-ADD0         IN35
|   C                     Z-ADD0         IN36
|   C                     Z-ADD0         IN37
|   C                     Z-ADD0         IN38
|   C                     Z-ADD0         IN39
|   C                     Z-ADD0         IN40
|   C                     Z-ADD0         IN41
|   C**
|   C                     WRITEIN0
      *
| 25-C                     END
| 23*C                     ELSE
|   C*產品歸屬＜＞公司第一碼
|   C                     MOVELSF01      IN01
B2000C                     Z-ADDW#B16     IN02
      *出貨物流點
|   C                     MOVE SE07      IN03
|   C                     MOVE SF03      IN04
|   C                     Z-ADDSF19      QTY
|   C                     Z-ADDSF20      QTY1
|   C                     WRITEPD1
| 26-C           *IN39     IFEQ '1'
|   C                     WRITEPE1
|   C                     WRITEPH1
|   C                     SETOF                     39
| 26-C                     END
|   C*
|   C           KEYIN     CHAININ0                  40
B2000C                     Z-ADDDATE      INXX
B2000C                     TIME           INYY
|   C                     MOVE $USER     INZZ
|   C*
| 27-C           *IN40     IFEQ '0'
|   C                     ADD  WSD04     IN06
|   C                     SUB  SF20      IN08
|   C                     SUB  SF19      IN09
|   C           SF10      MULT WSD04     WORK
|   C                     ADD  WORK      IN291
|   C           SF11      MULT WSD04     WORK
|   C                     ADD  WORK      IN301
|   C           SF12      MULT WSD04     WORK
|   C                     ADD  WORK      IN311
|   C                     UPDATIN0
      *
| 27*C                     ELSE
|   C                     Z-ADD0         IN05
|   C                     Z-ADDWSD04     IN06
|   C                     Z-ADD0         IN07
|   C                     Z-SUBSF20      IN08
|   C                     Z-SUBSF19      IN09
|   C                     Z-ADD0         IN10
|   C                     Z-ADD0         IN101
|   C                     Z-ADD0         IN11
|   C                     Z-ADD0         IN12
|   C                     Z-ADD0         IN13
|   C                     Z-ADD0         IN14
|   C                     Z-ADD0         IN15
|   C                     Z-ADD0         IN16
|   C                     Z-ADD0         IN17
|   C                     Z-ADD0         IN18
|   C                     Z-ADD0         IN19
|   C                     Z-ADD0         IN20
|   C                     Z-ADD0         IN23
|   C                     Z-ADD0         IN24
|   C                     Z-ADD0         IN25
|   C                     Z-ADD0         IN231
|   C                     Z-ADD0         IN241
|   C                     Z-ADD0         IN251
|   C                     Z-ADD0         IN26
|   C                     Z-ADD0         IN27
|   C                     Z-ADD0         IN28
|   C                     Z-ADD0         IN261
|   C                     Z-ADD0         IN271
|   C                     Z-ADD0         IN281
|   C                     Z-ADD0         IN29
|   C                     Z-ADD0         IN30
|   C                     Z-ADD0         IN31
|   C           SF10      MULT WSD04     IN291
|   C           SF11      MULT WSD04     IN301
|   C           SF12      MULT WSD04     IN311
|   C                     Z-ADD0         IN32
|   C                     Z-ADD0         IN33
|   C                     Z-ADD0         IN34
|   C                     Z-ADD0         IN321
|   C                     Z-ADD0         IN331
|   C                     Z-ADD0         IN341
|   C                     Z-ADD0         IN35
|   C                     Z-ADD0         IN36
|   C                     Z-ADD0         IN37
|   C                     Z-ADD0         IN38
|   C                     Z-ADD0         IN39
|   C                     Z-ADD0         IN40
|   C                     Z-ADD0         IN41
|   C**
|   C                     WRITEIN0
      *
| 27-C                     END
| 23-C                     END
|   C*
| 22-C                     END
|   C*----------------------------------------------------------------
|   C*產品歸屬＝公司第一碼
| 28-C           SE03      IFEQ 'D7'
|   C           SE03      OREQ 'DG'
|   C                     MOVELSF01      IN01
B2000C                     Z-ADDW#B16     IN02
      *出貨物流點 A
|   C                     MOVE SE07      IN03
|   C                     MOVE SF03      IN04
|   C                     Z-ADDSF19      QTY
|   C                     Z-ADDSF20      QTY1
|   C                     WRITEPD1
| 29-C           *IN39     IFEQ '1'
|   C                     WRITEPE1
|   C                     WRITEPH1
|   C                     SETOF                     39
| 29-C                     END
|   C*
|   C           KEYIN     CHAININ0                  40
B2000C                     Z-ADDDATE      INXX
B2000C                     TIME           INYY
|   C                     MOVE $USER     INZZ
|   C*
| 30-C           *IN40     IFEQ '0'
|   C                     SUB  SF19      IN37
|   C                     SUB  SF20      IN38
|   C                     SUB  WSD04     IN17
|   C           SF10      MULT WSD04     WORK
|   C                     SUB  WORK      IN26
|   C                     ADD  WORK      IN29
|   C           SF11      MULT WSD04     WORK
|   C                     SUB  WORK      IN27
|   C                     ADD  WORK      IN30
|   C           SF12      MULT WSD04     WORK
|   C                     SUB  WORK      IN28
|   C                     ADD  WORK      IN31
|   C                     UPDATIN0
      *
| 30*C                     ELSE
|   C                     Z-ADD0         IN05
|   C                     Z-ADD0         IN06
|   C                     Z-ADD0         IN07
|   C                     Z-ADD0         IN08
|   C                     Z-ADD0         IN09
|   C                     Z-ADD0         IN10
|   C                     Z-ADD0         IN101
|   C                     Z-ADD0         IN11
|   C                     Z-ADD0         IN12
|   C                     Z-ADD0         IN13
|   C                     Z-ADD0         IN14
|   C                     Z-ADD0         IN15
|   C                     Z-ADD0         IN16
|   C                     Z-SUBWSD04     IN17
|   C                     Z-ADD0         IN18
|   C                     Z-ADD0         IN19
|   C                     Z-ADD0         IN20
|   C                     Z-ADD0         IN23
|   C                     Z-ADD0         IN24
|   C                     Z-ADD0         IN25
|   C                     Z-ADD0         IN231
|   C                     Z-ADD0         IN241
|   C                     Z-ADD0         IN251
|   C           SF10      MULT WSD04     WORK
|   C                     Z-SUBWORK      IN26
|   C                     Z-ADDWORK      IN29
|   C           SF11      MULT WSD04     WORK
|   C                     Z-SUBWORK      IN27
|   C                     Z-ADDWORK      IN30
|   C           SF12      MULT WSD04     WORK
|   C                     Z-SUBWORK      IN28
|   C                     Z-ADDWORK      IN31
|   C                     Z-ADD0         IN261
|   C                     Z-ADD0         IN271
|   C                     Z-ADD0         IN281
|   C                     Z-ADD0         IN291
|   C                     Z-ADD0         IN301
|   C                     Z-ADD0         IN311
|   C                     Z-ADD0         IN32
|   C                     Z-ADD0         IN33
|   C                     Z-ADD0         IN34
|   C                     Z-ADD0         IN321
|   C                     Z-ADD0         IN331
|   C                     Z-ADD0         IN341
|   C                     Z-ADD0         IN35
|   C                     Z-ADD0         IN36
|   C                     Z-SUBSF19      IN37
|   C                     Z-SUBSF20      IN38
|   C                     Z-ADD0         IN39
|   C                     Z-ADD0         IN40
|   C                     Z-ADD0         IN41
|   C**
|   C                     WRITEIN0
      *
| 30-C                     END
| 28-C                     END
|   C*
|   C*----------------------------------------------------------------
| 31-C           SE03      IFEQ 'D8'
|   C           SE03      OREQ 'DH'
      *
|   C                     MOVELSF01      IN01
B2000C                     Z-ADDW#B16     IN02
      *收貨物流點
|   C                     MOVE SE26      IN03
|   C                     MOVE SF03      IN04
|   C                     Z-ADDSF19      QTY
|   C                     Z-ADDSF20      QTY1
|   C                     WRITEPD1
| 32-C           *IN39     IFEQ '1'
|   C                     WRITEPE1
|   C                     WRITEPH1
|   C                     SETOF                     39
| 32-C                     END
|   C*
|   C           KEYIN     CHAININ0                  40
B2000C                     Z-ADDDATE      INXX
B2000C                     TIME           INYY
|   C                     MOVE $USER     INZZ
|   C*
| 33-C           *IN40     IFEQ '0'
|   C                     ADD  WSD04     IN39
|   C                     ADD  WSD04     IN17
|   C           SF10      MULT WSD04     WORK
|   C                     ADD  WORK      IN26
|   C           SF11      MULT WSD04     WORK
|   C                     ADD  WORK      IN27
|   C           SF12      MULT WSD04     WORK
|   C                     ADD  WORK      IN28
|   C                     UPDATIN0
      *
| 33*C                     ELSE
|   C                     Z-ADD0         IN05
|   C                     Z-ADD0         IN06
|   C                     Z-ADD0         IN07
|   C                     Z-ADD0         IN08
|   C                     Z-ADD0         IN09
|   C                     Z-ADD0         IN10
|   C                     Z-ADD0         IN101
|   C                     Z-ADD0         IN11
|   C                     Z-ADD0         IN12
|   C                     Z-ADD0         IN13
|   C                     Z-ADD0         IN14
|   C                     Z-ADD0         IN15
|   C                     Z-ADD0         IN16
|   C                     Z-ADDWSD04     IN17
|   C                     Z-ADD0         IN18
|   C                     Z-ADD0         IN19
|   C                     Z-ADD0         IN20
|   C                     Z-ADD0         IN23
|   C                     Z-ADD0         IN24
|   C                     Z-ADD0         IN25
|   C                     Z-ADD0         IN231
|   C                     Z-ADD0         IN241
|   C                     Z-ADD0         IN251
|   C           SF10      MULT WSD04     IN26
|   C           SF11      MULT WSD04     IN27
|   C           SF12      MULT WSD04     IN28
|   C                     Z-ADD0         IN261
|   C                     Z-ADD0         IN271
|   C                     Z-ADD0         IN281
|   C                     Z-ADD0         IN29
|   C                     Z-ADD0         IN30
|   C                     Z-ADD0         IN31
|   C                     Z-ADD0         IN291
|   C                     Z-ADD0         IN301
|   C                     Z-ADD0         IN311
|   C                     Z-ADD0         IN32
|   C                     Z-ADD0         IN33
|   C                     Z-ADD0         IN34
|   C                     Z-ADD0         IN321
|   C                     Z-ADD0         IN331
|   C                     Z-ADD0         IN341
|   C                     Z-ADD0         IN35
|   C                     Z-ADD0         IN36
|   C                     Z-ADD0         IN37
|   C                     Z-ADD0         IN38
|   C                     Z-ADDWSD04     IN39
|   C                     Z-ADD0         IN40
|   C                     Z-ADD0         IN41
|   C**
|   C                     WRITEIN0
      *
| 33-C                     END
|   C*產品歸屬＝公司第一碼
| 34-C           SF16      IFEQ COMPL
|   C                     MOVELSF01      IN01
B2000C                     Z-ADDW#B16     IN02
      *出貨物流點
|   C                     MOVE SE07      IN03
|   C                     MOVE SF03      IN04
|   C                     Z-ADDSF19      QTY
|   C                     Z-ADDSF20      QTY1
|   C                     WRITEPD1
| 35-C           *IN39     IFEQ '1'
|   C                     WRITEPE1
|   C                     WRITEPH1
|   C                     SETOF                     39
| 35-C                     END
|   C*
|   C           KEYIN     CHAININ0                  40
B2000C                     Z-ADDDATE      INXX
B2000C                     TIME           INYY
|   C                     MOVE $USER     INZZ
|   C*
| 36-C           *IN40     IFEQ '0'
|   C                     SUB  WSD04     IN20
|   C                     SUB  WSD04     IN17
|   C           SF10      MULT WSD04     WORK
|   C                     SUB  WORK      IN26
|   C           SF11      MULT WSD04     WORK
|   C                     SUB  WORK      IN27
|   C           SF12      MULT WSD04     WORK
|   C                     SUB  WORK      IN28
|   C                     UPDATIN0
      *
| 36*C                     ELSE
|   C                     Z-ADD0         IN05
|   C                     Z-ADD0         IN06
|   C                     Z-ADD0         IN07
|   C                     Z-ADD0         IN08
|   C                     Z-ADD0         IN09
|   C                     Z-ADD0         IN10
|   C                     Z-ADD0         IN101
|   C                     Z-ADD0         IN11
|   C                     Z-ADD0         IN12
|   C                     Z-ADD0         IN13
|   C                     Z-ADD0         IN14
|   C                     Z-ADD0         IN15
|   C                     Z-ADD0         IN16
|   C                     Z-SUBWSD04     IN17
|   C                     Z-ADD0         IN18
|   C                     Z-ADD0         IN19
|   C                     Z-SUBWSD04     IN20
|   C                     Z-ADD0         IN23
|   C                     Z-ADD0         IN24
|   C                     Z-ADD0         IN25
|   C                     Z-ADD0         IN231
|   C                     Z-ADD0         IN241
|   C                     Z-ADD0         IN251
|   C           SF10      MULT WSD04     WORK
|   C                     Z-SUBWORK      IN26
|   C           SF11      MULT WSD04     WORK
|   C                     Z-SUBWORK      IN27
|   C           SF12      MULT WSD04     WORK
|   C                     Z-SUBWORK      IN28
|   C                     Z-ADD0         IN261
|   C                     Z-ADD0         IN271
|   C                     Z-ADD0         IN281
|   C                     Z-ADD0         IN29
|   C                     Z-ADD0         IN30
|   C                     Z-ADD0         IN31
|   C                     Z-ADD0         IN291
|   C                     Z-ADD0         IN301
|   C                     Z-ADD0         IN311
|   C                     Z-ADD0         IN32
|   C                     Z-ADD0         IN33
|   C                     Z-ADD0         IN34
|   C                     Z-ADD0         IN321
|   C                     Z-ADD0         IN331
|   C                     Z-ADD0         IN341
|   C                     Z-ADD0         IN35
|   C                     Z-ADD0         IN36
|   C                     Z-ADD0         IN37
|   C                     Z-ADD0         IN38
|   C                     Z-ADD0         IN39
|   C                     Z-ADD0         IN40
|   C                     Z-ADD0         IN41
|   C**
|   C                     WRITEIN0
      *
| 36-C                     END
|   C*
| 34*C                     ELSE
|   C*產品歸屬＜＞公司第一碼
|   C                     MOVELSF01      IN01
B2000C                     Z-ADDW#B16     IN02
      *出貨物流點
|   C                     MOVE SE07      IN03
|   C                     MOVE SF03      IN04
|   C                     Z-ADDSF19      QTY
|   C                     Z-ADDSF20      QTY1
|   C                     WRITEPD1
| 37-C           *IN39     IFEQ '1'
|   C                     WRITEPE1
|   C                     WRITEPH1
|   C                     SETOF                     39
| 37-C                     END
|   C*
|   C           KEYIN     CHAININ0                  40
B2000C                     Z-ADDDATE      INXX
B2000C                     TIME           INYY
|   C                     MOVE $USER     INZZ
|   C*
| 38-C           *IN40     IFEQ '0'
|   C                     ADD  WSD04     IN06
|   C                     SUB  WSD04     IN20
|   C                     UPDATIN0
      *
| 38*C                     ELSE
|   C                     Z-ADD0         IN05
|   C                     Z-ADDWSD04     IN06
|   C                     Z-ADD0         IN07
|   C                     Z-ADD0         IN08
|   C                     Z-ADD0         IN09
|   C                     Z-ADD0         IN10
|   C                     Z-ADD0         IN101
|   C                     Z-ADD0         IN11
|   C                     Z-ADD0         IN12
|   C                     Z-ADD0         IN13
|   C                     Z-ADD0         IN14
|   C                     Z-ADD0         IN15
|   C                     Z-ADD0         IN16
|   C                     Z-ADD0         IN17
|   C                     Z-ADD0         IN18
|   C                     Z-ADD0         IN19
|   C                     Z-SUBWSD04     IN20
|   C                     Z-ADD0         IN23
|   C                     Z-ADD0         IN24
|   C                     Z-ADD0         IN25
|   C                     Z-ADD0         IN231
|   C                     Z-ADD0         IN241
|   C                     Z-ADD0         IN251
|   C                     Z-ADD0         IN26
|   C                     Z-ADD0         IN27
|   C                     Z-ADD0         IN28
|   C                     Z-ADD0         IN261
|   C                     Z-ADD0         IN271
|   C                     Z-ADD0         IN281
|   C                     Z-ADD0         IN29
|   C                     Z-ADD0         IN30
|   C                     Z-ADD0         IN31
|   C                     Z-ADD0         IN291
|   C                     Z-ADD0         IN301
|   C                     Z-ADD0         IN311
|   C                     Z-ADD0         IN32
|   C                     Z-ADD0         IN33
|   C                     Z-ADD0         IN34
|   C                     Z-ADD0         IN321
|   C                     Z-ADD0         IN331
|   C                     Z-ADD0         IN341
|   C                     Z-ADD0         IN35
|   C                     Z-ADD0         IN36
|   C                     Z-ADD0         IN37
|   C                     Z-ADD0         IN38
|   C                     Z-ADD0         IN39
|   C                     Z-ADD0         IN40
|   C                     Z-ADD0         IN41
|   C**
|   C                     WRITEIN0
      *
| 38-C                     END
|   C*
| 34-C                     END
| 31-C                     END
|   C*----------------------------------------------------------------
|   C           KEYSF     READESF0                      45
| 03-C                     END
|   C*
|   C                     READ SE0                      44
| 02*C                     ELSE
|   C                     SETON                     44
| 02-C                     END
|   C*
| 01-C                     END
|    C*
09===C                     ENDSR
      *===============================================================*
      *          RTN370....銷貨退回主檔
      *===============================================================*
10===C           RTN370    BEGSR
|    C*
B2000C           SETLL     SETLLSG0
|    C                     READ SG0                      44
| 01-C           *IN44     DOWEQ'0'
|   C*
B2000C                     Z-ADDSG26      WDATE
B2000C           WYYMM     IFEQ W#B16
|   C                     MOVE 'V'       SG16
B2000C                     Z-ADDDATE      SGXX
B2000C                     TIME           SGYY
|   C                     MOVE $USER     SGZZ
|   C**
|   C                     UPDATSG0
|   C                     MOVE SG02      PDNO
|   C                     MOVELSG01      COMPL   1
|   C***
|   C           KEYSH     SETLLSH0
|   C           KEYSH     READESH0                      45
| 03-C           *IN45     DOWEQ'0'
|   C*
|   C                     MOVELSH01      IN01
B2000C                     Z-ADDW#B16     IN02
      *退回物流點
|   C                     MOVE SG07      IN03
|   C                     MOVE SH03      IN04
|   C                     Z-ADDSH06      QTY
|   C                     Z-ADD0         QTY1
|   C                     WRITEPD1
| 04-C           *IN39     IFEQ '1'
|   C                     WRITEPE1
|   C                     WRITEPH1
|   C                     SETOF                     39
| 04-C                     END
|   C*
|   C           KEYIN     CHAININ0                  40
B2000C                     Z-ADDDATE      INXX
B2000C                     TIME           INYY
|   C                     MOVE $USER     INZZ
|   C*
|   C*產品歸屬＝公司第一碼
| 05-C           SH11      IFEQ COMPL
| 06-C           *IN40     IFEQ '0'
|   C                     ADD  SH12      IN10
|   C                     ADD  SH13      IN101
|   C                     ADD  SH06      IN17
|   C                     ADD  SH14      IN26
|   C                     ADD  SH15      IN27
|   C                     ADD  SH16      IN28
|   C                     ADD  SH14      IN32
|   C                     ADD  SH15      IN33
|   C                     ADD  SH16      IN34
|   C                     UPDATIN0
      *
| 06*C                     ELSE
|   C                     Z-ADD0         IN05
|   C                     Z-ADD0         IN06
|   C                     Z-ADD0         IN07
|   C                     Z-ADD0         IN08
|   C                     Z-ADD0         IN09
|   C                     Z-ADDSH12      IN10
|   C                     Z-ADDSH13      IN101
|   C                     Z-ADD0         IN11
|   C                     Z-ADD0         IN12
|   C                     Z-ADD0         IN13
|   C                     Z-ADD0         IN14
|   C                     Z-ADD0         IN15
|   C                     Z-ADD0         IN16
|   C                     Z-ADDSH06      IN17
|   C                     Z-ADD0         IN18
|   C                     Z-ADD0         IN19
|   C                     Z-ADD0         IN20
|   C                     Z-ADD0         IN23
|   C                     Z-ADD0         IN24
|   C                     Z-ADD0         IN25
|   C                     Z-ADD0         IN231
|   C                     Z-ADD0         IN241
|   C                     Z-ADD0         IN251
|   C                     Z-ADDSH14      IN26
|   C                     Z-ADDSH15      IN27
|   C                     Z-ADDSH16      IN28
|   C                     Z-ADD0         IN261
|   C                     Z-ADD0         IN271
|   C                     Z-ADD0         IN281
|   C                     Z-ADD0         IN29
|   C                     Z-ADD0         IN30
|   C                     Z-ADD0         IN31
|   C                     Z-ADD0         IN291
|   C                     Z-ADD0         IN301
|   C                     Z-ADD0         IN311
|   C                     Z-ADDSH14      IN32
|   C                     Z-ADDSH15      IN33
|   C                     Z-ADDSH16      IN34
|   C                     Z-ADD0         IN321
|   C                     Z-ADD0         IN331
|   C                     Z-ADD0         IN341
|   C                     Z-ADD0         IN35
|   C                     Z-ADD0         IN36
|   C                     Z-ADD0         IN37
|   C                     Z-ADD0         IN38
|   C                     Z-ADD0         IN39
|   C                     Z-ADD0         IN40
|   C                     Z-ADD0         IN41
|   C**
|   C                     WRITEIN0
      *
| 06-C                     END
| 05*C                     ELSE
|   C*產品歸屬＜＞公司第一碼
| 07-C           *IN40     IFEQ '0'
|   C                     ADD  SH12      IN10
|   C                     ADD  SH13      IN101
|   C                     ADD  SH14      IN32
|   C                     ADD  SH15      IN33
|   C                     ADD  SH16      IN34
|   C                     SUB  SH06      IN35
|   C                     UPDATIN0
      *
| 07*C                     ELSE
|   C                     Z-ADD0         IN05
|   C                     Z-ADD0         IN06
|   C                     Z-ADD0         IN07
|   C                     Z-ADD0         IN08
|   C                     Z-ADD0         IN09
|   C                     Z-ADDSH12      IN10
|   C                     Z-ADDSH13      IN101
|   C                     Z-ADD0         IN11
|   C                     Z-ADD0         IN12
|   C                     Z-ADD0         IN13
|   C                     Z-ADD0         IN14
|   C                     Z-ADD0         IN15
|   C                     Z-ADD0         IN16
|   C                     Z-ADD0         IN18
|   C                     Z-ADD0         IN19
|   C                     Z-ADD0         IN20
|   C                     Z-ADD0         IN23
|   C                     Z-ADD0         IN24
|   C                     Z-ADD0         IN25
|   C                     Z-ADD0         IN231
|   C                     Z-ADD0         IN241
|   C                     Z-ADD0         IN251
|   C                     Z-ADD0         IN26
|   C                     Z-ADD0         IN27
|   C                     Z-ADD0         IN28
|   C                     Z-ADD0         IN261
|   C                     Z-ADD0         IN271
|   C                     Z-ADD0         IN281
|   C                     Z-ADD0         IN29
|   C                     Z-ADD0         IN30
|   C                     Z-ADD0         IN31
|   C                     Z-ADD0         IN291
|   C                     Z-ADD0         IN301
|   C                     Z-ADD0         IN311
|   C                     Z-ADDSH14      IN32
|   C                     Z-ADDSH15      IN33
|   C                     Z-ADDSH16      IN34
|   C                     Z-SUBSH06      IN35
|   C                     Z-ADD0         IN17
|   C                     Z-ADD0         IN321
|   C                     Z-ADD0         IN331
|   C                     Z-ADD0         IN341
|   C                     Z-ADD0         IN36
|   C                     Z-ADD0         IN37
|   C                     Z-ADD0         IN38
|   C                     Z-ADD0         IN39
|   C                     Z-ADD0         IN40
|   C                     Z-ADD0         IN41
|   C**
|   C                     WRITEIN0
      *
| 07-C                     END
| 05-C                     END
|   C*
|   C           KEYSH     READESH0                      45
| 03-C                     END
|   C*
|   C                     READ SG0                      44
| 02*C                     ELSE
|   C                     SETON                     44
| 02-C                     END
|   C*
| 01-C                     END
|    C*
10===C                     ENDSR
      *===============================================================*
      *          RTN380....產品收回主檔
      *===============================================================*
11===C           RTN380    BEGSR
|    C*
B2000C           SETLL     SETLLSN0
|    C                     READ SN0                      44
| 01-C           *IN44     DOWEQ'0'
|   C*
B2000C                     Z-ADDSN06      WDATE
B2000C           WYYMM     IFEQ W#B16
|   C                     MOVE 'V'       SN09
B2000C                     Z-ADDDATE      SNXX
B2000C                     TIME           SNYY
|   C                     MOVE $USER     SNZZ
|   C**
|   C                     UPDATSN0
|   C                     MOVE SN02      PDNO
|   C                     MOVELSN01      COMPL
      *
|   C           KEYSO     SETLLSO0
|   C           KEYSO     READESO0                      45
| 03-C           *IN45     DOWEQ'0'
|   C*
| 04-C           SN02L     IFEQ 'R2'
|   C           COMPL     ANDEQSO11
|   C           SN02L     OREQ 'RB'
|   C           SN02L     OREQ 'R3'
      *試飲退回不記錄客戶物流點
| 05-C           SN02L     IFNE 'R3'
|   C*
|   C                     MOVELSO01      IN01
B2000C                     Z-ADDW#B16     IN02
      *
| 06-C           SN02L     IFEQ 'RB'
B2000C                     Z-ADDSN06      KDATE
|   C                     MOVELSN01      KCOMP
|   C                     MOVELSN02      KORD
|   C           KORD      CHAINSP0                  40
|   C           SP01      CHAINSN0L                 40
      *原始單別物流點
|   C                     MOVELSN03      IN03
B2000C           KEYKEP    CHAINSN0                  40
| 06*C                     ELSE
|   C                     MOVE SN03      IN03
| 06-C                     END
      *
|   C                     MOVE SO03      IN04
|   C                     Z-ADDSO05      QTY
|   C                     Z-ADD0         QTY1
|   C                     WRITEPD1
| 07-C           *IN39     IFEQ '1'
|   C                     WRITEPE1
|   C                     WRITEPH1
|   C                     SETOF                     39
| 07-C                     END
|   C*
|   C           KEYIN     CHAININ0                  40
B2000C                     Z-ADDDATE      INXX
B2000C                     TIME           INYY
|   C                     MOVE $USER     INZZ
|   C*
| 08-C           *IN40     IFEQ '0'
|   C                     SUB  SO05      IN36
|   C                     SUB  SO05      IN17
|   C                     SUB  SO16      IN26
|   C                     SUB  SO17      IN27
|   C                     SUB  SO18      IN28
      *
|   C                     UPDATIN0
      *
| 08*C                     ELSE
|   C                     Z-ADD0         IN05
|   C                     Z-ADD0         IN06
|   C                     Z-ADD0         IN07
|   C                     Z-ADD0         IN08
|   C                     Z-ADD0         IN09
|   C                     Z-ADD0         IN10
|   C                     Z-ADD0         IN101
|   C                     Z-ADD0         IN11
|   C                     Z-ADD0         IN12
|   C                     Z-ADD0         IN13
|   C                     Z-ADD0         IN14
|   C                     Z-ADD0         IN15
|   C                     Z-ADD0         IN16
|   C                     Z-SUBSO05      IN17
|   C                     Z-ADD0         IN18
|   C                     Z-ADD0         IN19
|   C                     Z-ADD0         IN20
|   C                     Z-ADD0         IN23
|   C                     Z-ADD0         IN24
|   C                     Z-ADD0         IN25
|   C                     Z-ADD0         IN231
|   C                     Z-ADD0         IN241
|   C                     Z-ADD0         IN251
|   C                     Z-SUBSO16      IN26
|   C                     Z-SUBSO17      IN27
|   C                     Z-SUBSO18      IN28
|   C                     Z-ADD0         IN261
|   C                     Z-ADD0         IN271
|   C                     Z-ADD0         IN281
|   C                     Z-ADD0         IN29
|   C                     Z-ADD0         IN30
|   C                     Z-ADD0         IN31
|   C                     Z-ADD0         IN291
|   C                     Z-ADD0         IN301
|   C                     Z-ADD0         IN311
|   C                     Z-ADD0         IN32
|   C                     Z-ADD0         IN33
|   C                     Z-ADD0         IN34
|   C                     Z-ADD0         IN321
|   C                     Z-ADD0         IN331
|   C                     Z-ADD0         IN341
|   C                     Z-ADD0         IN35
|   C                     Z-SUBSO05      IN36
|   C                     Z-ADD0         IN37
|   C                     Z-ADD0         IN38
|   C                     Z-ADD0         IN39
|   C                     Z-ADD0         IN40
|   C                     Z-ADD0         IN41
|   C**
|   C                     WRITEIN0
| 08-C                     END
| 05-C                     END
|   C*產品歸屬＝公司第一碼
| 09-C           SO11      IFEQ COMPL
|   C*
|   C                     MOVELSO01      IN01
B2000C                     Z-ADDW#B16     IN02
|   C                     MOVE SN04      IN03
|   C                     MOVE SO03      IN04
|   C                     Z-ADDSO05      QTY
|   C                     Z-ADD0         QTY1
|   C                     WRITEPD1
| 10-C           *IN39     IFEQ '1'
|   C                     WRITEPE1
|   C                     WRITEPH1
|   C                     SETOF                     39
| 10-C                     END
|   C*
|   C           KEYIN     CHAININ0                  40
B2000C                     Z-ADDDATE      INXX
B2000C                     TIME           INYY
|   C                     MOVE $USER     INZZ
|   C*
| 11-C           *IN40     IFEQ '0'
      *
| 12-C           SN02L     IFEQ 'R2'
|   C           SN02L     OREQ 'RB'
|   C                     ADD  SO05      IN18
| 12*C                     ELSE
      *試飲收回
|   C                     ADD  SO05      IN40
|   C                     ADD  SO16      IN261
|   C                     ADD  SO17      IN271
|   C                     ADD  SO18      IN281
|   C                     ADD  SO16      IN321
|   C                     ADD  SO17      IN331
|   C                     ADD  SO18      IN341
| 12-C                     END
      *
|   C                     ADD  SO05      IN17
|   C                     ADD  SO16      IN26
|   C                     ADD  SO17      IN27
|   C                     ADD  SO18      IN28
|   C                     UPDATIN0
      *
| 11*C                     ELSE
|   C                     Z-ADD0         IN05
|   C                     Z-ADD0         IN06
|   C                     Z-ADD0         IN07
|   C                     Z-ADD0         IN08
|   C                     Z-ADD0         IN09
|   C                     Z-ADD0         IN10
|   C                     Z-ADD0         IN101
|   C                     Z-ADD0         IN11
|   C                     Z-ADD0         IN12
|   C                     Z-ADD0         IN13
|   C                     Z-ADD0         IN14
|   C                     Z-ADD0         IN15
|   C                     Z-ADD0         IN16
|   C                     Z-ADDSO05      IN17
      *
| 13-C           SN02L     IFEQ 'R2'
|   C           SN02L     OREQ 'RB'
|   C                     Z-ADDSO05      IN18
|   C                     Z-ADD0         IN40
|   C                     Z-ADD0         IN261
|   C                     Z-ADD0         IN271
|   C                     Z-ADD0         IN281
|   C                     Z-ADD0         IN321
|   C                     Z-ADD0         IN331
|   C                     Z-ADD0         IN341
| 13*C                     ELSE
|   C                     Z-ADD0         IN18
|   C                     Z-ADDSO05      IN40
|   C                     Z-ADDSO16      IN261
|   C                     Z-ADDSO17      IN271
|   C                     Z-ADDSO18      IN281
|   C                     Z-ADDSO16      IN321
|   C                     Z-ADDSO17      IN331
|   C                     Z-ADDSO18      IN341
| 13-C                     END
      *
|   C                     Z-ADD0         IN19
|   C                     Z-ADD0         IN20
|   C                     Z-ADD0         IN23
|   C                     Z-ADD0         IN24
|   C                     Z-ADD0         IN25
|   C                     Z-ADD0         IN231
|   C                     Z-ADD0         IN241
|   C                     Z-ADD0         IN251
|   C                     Z-ADDSO16      IN26
|   C                     Z-ADDSO17      IN27
|   C                     Z-ADDSO18      IN28
|   C                     Z-ADD0         IN29
|   C                     Z-ADD0         IN30
|   C                     Z-ADD0         IN31
|   C                     Z-ADD0         IN291
|   C                     Z-ADD0         IN301
|   C                     Z-ADD0         IN311
|   C                     Z-ADD0         IN32
|   C                     Z-ADD0         IN33
|   C                     Z-ADD0         IN34
|   C                     Z-ADD0         IN35
|   C                     Z-ADD0         IN36
|   C                     Z-ADD0         IN37
|   C                     Z-ADD0         IN38
|   C                     Z-ADD0         IN39
|   C                     Z-ADD0         IN41
|   C**
|   C                     WRITEIN0
      *
| 11-C                     END
| 09*C                     ELSE
|   C*產品歸屬＜＞公司第一碼
|   C                     MOVELSO01      IN01
B2000C                     Z-ADDW#B16     IN02
|   C                     MOVE SN04      IN03
|   C                     MOVE SO03      IN04
|   C                     Z-ADDSO05      QTY
|   C                     Z-ADD0         QTY1
|   C                     WRITEPD1
| 14-C           *IN39     IFEQ '1'
|   C                     WRITEPE1
|   C                     WRITEPH1
|   C                     SETOF                     39
| 14-C                     END
|   C*
|   C           KEYIN     CHAININ0                  40
B2000C                     Z-ADDDATE      INXX
B2000C                     TIME           INYY
|   C                     MOVE $USER     INZZ
|   C*
| 15-C           *IN40     IFEQ '0'
      *
| 16-C           SN02L     IFEQ 'R2'
|   C           SN02L     OREQ 'RB'
|   C                     ADD  SO05      IN18
| 16*C                     ELSE
|   C                     ADD  SO05      IN40
| 16-C                     END
      *
|   C                     SUB  SO05      IN36
|   C                     UPDATIN0
      *
| 15*C                     ELSE
|   C                     Z-ADD0         IN05
|   C                     Z-ADD0         IN06
|   C                     Z-ADD0         IN07
|   C                     Z-ADD0         IN08
|   C                     Z-ADD0         IN09
|   C                     Z-ADD0         IN10
|   C                     Z-ADD0         IN101
|   C                     Z-ADD0         IN11
|   C                     Z-ADD0         IN12
|   C                     Z-ADD0         IN13
|   C                     Z-ADD0         IN14
|   C                     Z-ADD0         IN15
|   C                     Z-ADD0         IN16
|   C                     Z-ADD0         IN17
      *
| 17-C           SN02L     IFEQ 'R2'
|   C           SN02L     OREQ 'RB'
|   C                     Z-ADDSO05      IN18
|   C                     Z-ADD0         IN40
| 17*C                     ELSE
|   C                     Z-ADD0         IN18
|   C                     Z-ADDSO05      IN40
| 17-C                     END
      *
|   C                     Z-ADD0         IN19
|   C                     Z-ADD0         IN20
|   C                     Z-ADD0         IN23
|   C                     Z-ADD0         IN24
|   C                     Z-ADD0         IN25
|   C                     Z-ADD0         IN231
|   C                     Z-ADD0         IN241
|   C                     Z-ADD0         IN251
|   C                     Z-ADD0         IN26
|   C                     Z-ADD0         IN27
|   C                     Z-ADD0         IN28
|   C                     Z-ADD0         IN261
|   C                     Z-ADD0         IN271
|   C                     Z-ADD0         IN281
|   C                     Z-ADD0         IN29
|   C                     Z-ADD0         IN30
|   C                     Z-ADD0         IN31
|   C                     Z-ADD0         IN291
|   C                     Z-ADD0         IN301
|   C                     Z-ADD0         IN311
|   C                     Z-ADD0         IN32
|   C                     Z-ADD0         IN33
|   C                     Z-ADD0         IN34
|   C                     Z-ADD0         IN321
|   C                     Z-ADD0         IN331
|   C                     Z-ADD0         IN341
|   C                     Z-ADD0         IN35
|   C                     Z-SUBSO05      IN36
|   C                     Z-ADD0         IN37
|   C                     Z-ADD0         IN38
|   C                     Z-ADD0         IN39
|   C                     Z-ADD0         IN41
|   C**
|   C                     WRITEIN0
      *
| 15-C                     END
| 09-C                     END
|   C*
| 04-C                     END
|   C           KEYSO     READESO0                      45
| 03-C                     END
|   C*
|   C                     READ SN0                      44
| 02*C                     ELSE
|   C                     SETON                     44
| 02-C                     END
|   C*
| 01-C                     END
|    C*
11===C                     ENDSR
      *===============================================================*
      *          RTN390....產品成本調整檔
      *===============================================================*
12===C           RTN390    BEGSR
|    C*
B2000C           SETLL     SETLLIB0
|    C                     READ IB0                      44
| 01-C           *IN44     DOWEQ'0'
|   C*
B2000C                     Z-ADDIB04      WDATE
B2000C           WYYMM     IFEQ W#B16
|   C                     MOVE 'V'       IB18
|   C                     UPDATIB0
|   C*
|   C                     MOVELIB02      COMPL
      *
|   C                     MOVELIB02      IN01
B2000C                     Z-ADDW#B16     IN02
|   C                     MOVELIB03      IN03
|   C                     MOVE IB01      IN04
|   C                     Z-ADDIB13      QTY
|   C                     Z-ADD0         QTY1
|   C                     WRITEPD1
| 03-C           *IN39     IFEQ '1'
|   C                     WRITEPE1
|   C                     WRITEPH1
|   C                     SETOF                     39
| 03-C                     END
|   C*
|   C           KEYIN     CHAININ0                  40
B2000C                     Z-ADDDATE      INXX
B2000C                     TIME           INYY
|   C                     MOVE $USER     INZZ
|   C*
| 04-C           *IN40     IFEQ '0'
|   C                     ADD  IB13      IN14
|   C                     ADD  IB13      IN17
|   C                     ADD  IB10      IN26
|   C                     ADD  IB11      IN27
|   C                     ADD  IB12      IN28
|   C                     UPDATIN0
      *
| 04*C                     ELSE
|   C                     Z-ADD0         IN05
|   C                     Z-ADD0         IN06
|   C                     Z-ADD0         IN07
|   C                     Z-ADD0         IN08
|   C                     Z-ADD0         IN09
|   C                     Z-ADD0         IN10
|   C                     Z-ADD0         IN101
|   C                     Z-ADD0         IN11
|   C                     Z-ADD0         IN12
|   C                     Z-ADD0         IN13
|   C                     Z-ADDIB13      IN14
|   C                     Z-ADD0         IN15
|   C                     Z-ADD0         IN16
|   C                     Z-ADDIB13      IN17
|   C                     Z-ADD0         IN18
|   C                     Z-ADD0         IN19
|   C                     Z-ADD0         IN20
|   C                     Z-ADD0         IN23
|   C                     Z-ADD0         IN24
|   C                     Z-ADD0         IN25
|   C                     Z-ADD0         IN231
|   C                     Z-ADD0         IN241
|   C                     Z-ADD0         IN251
|   C                     Z-ADDIB10      IN26
|   C                     Z-ADDIB11      IN27
|   C                     Z-ADDIB12      IN28
|   C                     Z-ADD0         IN261
|   C                     Z-ADD0         IN271
|   C                     Z-ADD0         IN281
|   C                     Z-ADD0         IN29
|   C                     Z-ADD0         IN30
|   C                     Z-ADD0         IN31
|   C                     Z-ADD0         IN291
|   C                     Z-ADD0         IN301
|   C                     Z-ADD0         IN311
|   C                     Z-ADD0         IN32
|   C                     Z-ADD0         IN33
|   C                     Z-ADD0         IN34
|   C                     Z-ADD0         IN321
|   C                     Z-ADD0         IN331
|   C                     Z-ADD0         IN341
|   C                     Z-ADD0         IN35
|   C                     Z-ADD0         IN36
|   C                     Z-ADD0         IN37
|   C                     Z-ADD0         IN38
|   C                     Z-ADD0         IN39
|   C                     Z-ADD0         IN40
|   C                     Z-ADD0         IN41
|   C**
|   C                     WRITEIN0
|   C*
| 04-C                     END
|   C                     READ IB0                      44
| 02*C                     ELSE
|   C                     SETON                     44
| 02-C                     END
|   C*
| 01-C                     END
|    C*
12===C                     ENDSR
      *===============================================================*
      *          RTN400....產品報廢主檔
      *===============================================================*
13===C           RTN400    BEGSR
|    C*
B2000C           SETLL     SETLLIE0
|    C                     READ IE0                      44
| 01-C           *IN44     DOWEQ'0'
|   C*
B2000C                     Z-ADDIE05      WDATE
B2000C           WYYMM     IFEQ W#B16
|   C                     MOVE 'V'       IE06
B2000C                     Z-ADDDATE      IEXX
B2000C                     TIME           IEYY
|   C                     MOVE $USER     IEZZ
|   C**
|   C                     UPDATIE0
|   C                     MOVE IE02      PDNO
|   C***
|   C           KEYIF     SETLLIF0
|   C           KEYIF     READEIF0                      45
| 03-C           *IN45     DOWEQ'0'
|   C*
|   C                     MOVELIF01      IN01
B2000C                     Z-ADDW#B16     IN02
|   C                     MOVE IE03      IN03
|   C                     MOVE IF03      IN04
|   C                     Z-ADDIF04      QTY
|   C                     Z-ADD0         QTY1
|   C                     WRITEPD1
| 04-C           *IN39     IFEQ '1'
|   C                     WRITEPE1
|   C                     WRITEPH1
|   C                     SETOF                     39
| 04-C                     END
|   C*
|   C           KEYIN     CHAININ0                  40
B2000C                     Z-ADDDATE      INXX
B2000C                     TIME           INYY
|   C                     MOVE $USER     INZZ
|   C*
| 05-C           *IN40     IFEQ '0'
|   C                     SUB  IF04      IN15
|   C                     SUB  IF04      IN17
|   C                     SUB  IF08      IN26
|   C                     SUB  IF09      IN27
|   C                     SUB  IF10      IN28
|   C                     UPDATIN0
      *
| 05*C                     ELSE
|   C                     Z-ADD0         IN05
|   C                     Z-ADD0         IN06
|   C                     Z-ADD0         IN07
|   C                     Z-ADD0         IN08
|   C                     Z-ADD0         IN09
|   C                     Z-ADD0         IN10
|   C                     Z-ADD0         IN101
|   C                     Z-ADD0         IN11
|   C                     Z-ADD0         IN12
|   C                     Z-ADD0         IN13
|   C                     Z-ADD0         IN14
|   C                     Z-SUBIF04      IN15
|   C                     Z-ADD0         IN16
|   C                     Z-SUBIF04      IN17
|   C                     Z-ADD0         IN18
|   C                     Z-ADD0         IN19
|   C                     Z-ADD0         IN20
|   C                     Z-ADD0         IN23
|   C                     Z-ADD0         IN24
|   C                     Z-ADD0         IN25
|   C                     Z-ADD0         IN231
|   C                     Z-ADD0         IN241
|   C                     Z-ADD0         IN251
|   C                     Z-SUBIF08      IN26
|   C                     Z-SUBIF09      IN27
|   C                     Z-SUBIF10      IN28
|   C                     Z-ADD0         IN261
|   C                     Z-ADD0         IN271
|   C                     Z-ADD0         IN281
|   C                     Z-ADD0         IN29
|   C                     Z-ADD0         IN30
|   C                     Z-ADD0         IN31
|   C                     Z-ADD0         IN291
|   C                     Z-ADD0         IN301
|   C                     Z-ADD0         IN311
|   C                     Z-ADD0         IN32
|   C                     Z-ADD0         IN33
|   C                     Z-ADD0         IN34
|   C                     Z-ADD0         IN321
|   C                     Z-ADD0         IN331
|   C                     Z-ADD0         IN341
|   C                     Z-ADD0         IN35
|   C                     Z-ADD0         IN36
|   C                     Z-ADD0         IN37
|   C                     Z-ADD0         IN38
|   C                     Z-ADD0         IN39
|   C                     Z-ADD0         IN40
|   C                     Z-ADD0         IN41
|   C**
|   C                     WRITEIN0
      *
| 05-C                     END
|   C*
|   C           KEYIF     READEIF0                      45
| 03-C                     END
|   C*
|   C                     READ IE0                      44
| 02*C                     ELSE
|   C                     SETON                     44
| 02-C                     END
|   C*
| 01-C                     END
|    C*
13===C                     ENDSR
      *===============================================================*
      *          RTN410....存貨調整主檔
      *===============================================================*
14===C           RTN410    BEGSR
|    C*
B2000C           SETLL     SETLLIG0
|    C                     READ IG0                      44
| 01-C           *IN44     DOWEQ'0'
|   C*
B2000C                     Z-ADDIG05      WDATE
B2000C           WYYMM     IFEQ W#B16
|   C                     MOVE 'V'       IG07
B2000C                     Z-ADDDATE      IGXX
B2000C                     TIME           IGYY
|   C                     MOVE $USER     IGZZ
|   C**
|   C                     UPDATIG0
|   C                     MOVE IG02      PDNO
|   C***
|   C           KEYIH     SETLLIH0
|   C           KEYIH     READEIH0                      45
| 03-C           *IN45     DOWEQ'0'
|   C*
|   C                     MOVELIH01      IN01
B2000C                     Z-ADDW#B16     IN02
|   C                     MOVE IG03      IN03
|   C                     MOVE IH03      IN04
|   C                     Z-ADDIH05      QTY
|   C                     Z-ADD0         QTY1
| 04-C           IG04      IFEQ '2'
|   C           IG04      OREQ '1'
|   C           IH03      ANDNE*BLANKS
|   C                     WRITEPD1
| 05-C           *IN39     IFEQ '1'
|   C                     WRITEPE1
|   C                     WRITEPH1
|   C                     SETOF                     39
| 05-C                     END
|   C*
|   C           KEYIN     CHAININ0                  40
B2000C                     Z-ADDDATE      INXX
B2000C                     TIME           INYY
|   C                     MOVE $USER     INZZ
|   C*
| 06-C           *IN40     IFEQ '0'
|   C                     SUB  IH05      IN14
|   C                     SUB  IH05      IN17
|   C                     SUB  IH08      IN26
|   C                     SUB  IH09      IN27
|   C                     SUB  IH10      IN28
|   C                     UPDATIN0
      *
| 06*C                     ELSE
|   C                     Z-ADD0         IN05
|   C                     Z-ADD0         IN06
|   C                     Z-ADD0         IN07
|   C                     Z-ADD0         IN08
|   C                     Z-ADD0         IN09
|   C                     Z-ADD0         IN10
|   C                     Z-ADD0         IN101
|   C                     Z-ADD0         IN11
|   C                     Z-ADD0         IN12
|   C                     Z-ADD0         IN13
|   C                     Z-SUBIH05      IN14
|   C                     Z-ADD0         IN15
|   C                     Z-ADD0         IN16
|   C                     Z-SUBIH05      IN17
|   C                     Z-ADD0         IN18
|   C                     Z-ADD0         IN19
|   C                     Z-ADD0         IN20
|   C                     Z-ADD0         IN23
|   C                     Z-ADD0         IN24
|   C                     Z-ADD0         IN25
|   C                     Z-ADD0         IN231
|   C                     Z-ADD0         IN241
|   C                     Z-ADD0         IN251
|   C                     Z-SUBIH08      IN26
|   C                     Z-SUBIH09      IN27
|   C                     Z-SUBIH10      IN28
|   C                     Z-ADD0         IN261
|   C                     Z-ADD0         IN271
|   C                     Z-ADD0         IN281
|   C                     Z-ADD0         IN29
|   C                     Z-ADD0         IN30
|   C                     Z-ADD0         IN31
|   C                     Z-ADD0         IN291
|   C                     Z-ADD0         IN301
|   C                     Z-ADD0         IN311
|   C                     Z-ADD0         IN32
|   C                     Z-ADD0         IN33
|   C                     Z-ADD0         IN34
|   C                     Z-ADD0         IN321
|   C                     Z-ADD0         IN331
|   C                     Z-ADD0         IN341
|   C                     Z-ADD0         IN35
|   C                     Z-ADD0         IN36
|   C                     Z-ADD0         IN37
|   C                     Z-ADD0         IN38
|   C                     Z-ADD0         IN39
|   C                     Z-ADD0         IN40
|   C                     Z-ADD0         IN41
|   C**
|   C                     WRITEIN0
      *
| 06-C                     END
| 04-C                     END
|   C*
|   C                     MOVELIH01      IN01
B2000C                     Z-ADDW#B16     IN02
|   C                     MOVE IG03      IN03
|   C                     MOVE IH04      IN04
|   C                     Z-ADDIH05      QTY
|   C                     Z-ADD0         QTY1
| 07-C           IG04      IFEQ '2'
|   C           IG04      OREQ '1'
|   C           IH04      ANDNE*BLANKS
|   C                     WRITEPD1
| 08-C           *IN39     IFEQ '1'
|   C                     WRITEPE1
|   C                     WRITEPH1
|   C                     SETOF                     39
| 08-C                     END
|   C*
|   C           KEYIN     CHAININ0                  40
B2000C                     Z-ADDDATE      INXX
B2000C                     TIME           INYY
|   C                     MOVE $USER     INZZ
|   C*
| 09-C           *IN40     IFEQ '0'
|   C                     ADD  IH05      IN14
|   C                     ADD  IH05      IN17
|   C                     ADD  IH08      IN26
|   C                     ADD  IH09      IN27
|   C                     ADD  IH10      IN28
|   C                     UPDATIN0
      *
| 09*C                     ELSE
|   C                     Z-ADD0         IN05
|   C                     Z-ADD0         IN06
|   C                     Z-ADD0         IN07
|   C                     Z-ADD0         IN08
|   C                     Z-ADD0         IN09
|   C                     Z-ADD0         IN10
|   C                     Z-ADD0         IN101
|   C                     Z-ADD0         IN11
|   C                     Z-ADD0         IN12
|   C                     Z-ADD0         IN13
|   C                     Z-ADDIH05      IN14
|   C                     Z-ADD0         IN15
|   C                     Z-ADD0         IN16
|   C                     Z-ADDIH05      IN17
|   C                     Z-ADD0         IN18
|   C                     Z-ADD0         IN19
|   C                     Z-ADD0         IN20
|   C                     Z-ADD0         IN23
|   C                     Z-ADD0         IN24
|   C                     Z-ADD0         IN25
|   C                     Z-ADD0         IN231
|   C                     Z-ADD0         IN241
|   C                     Z-ADD0         IN251
|   C                     Z-ADDIH08      IN26
|   C                     Z-ADDIH09      IN27
|   C                     Z-ADDIH10      IN28
|   C                     Z-ADD0         IN261
|   C                     Z-ADD0         IN271
|   C                     Z-ADD0         IN281
|   C                     Z-ADD0         IN29
|   C                     Z-ADD0         IN30
|   C                     Z-ADD0         IN31
|   C                     Z-ADD0         IN291
|   C                     Z-ADD0         IN301
|   C                     Z-ADD0         IN311
|   C                     Z-ADD0         IN32
|   C                     Z-ADD0         IN33
|   C                     Z-ADD0         IN34
|   C                     Z-ADD0         IN321
|   C                     Z-ADD0         IN331
|   C                     Z-ADD0         IN341
|   C                     Z-ADD0         IN35
|   C                     Z-ADD0         IN36
|   C                     Z-ADD0         IN37
|   C                     Z-ADD0         IN38
|   C                     Z-ADD0         IN39
|   C                     Z-ADD0         IN40
|   C                     Z-ADD0         IN41
|   C**
|   C                     WRITEIN0
      *
| 09-C                     END
| 07-C                     END
|   C*
|   C           KEYIH     READEIH0                      45
| 03-C                     END
|   C*
|   C                     READ IG0                      44
| 02*C                     ELSE
|   C                     SETON                     44
| 02-C                     END
|   C*
| 01-C                     END
|    C*
14===C                     ENDSR
      *===============================================================*
      *          RTN420....產品調撥主檔
      *===============================================================*
15===C           RTN420    BEGSR
|    C*
B2000C           SETLL     SETLLII0
|    C                     READ II0                      44
| 01-C           *IN44     DOWEQ'0'
|   C*
B2000C                     Z-ADDII06      WDATE
B2000C           WYYMM     IFEQ W#B16
|   C                     MOVE 'V'       II07
B2000C                     Z-ADDDATE      IIXX
B2000C                     TIME           IIYY
|   C                     MOVE $USER     IIZZ
|   C**
|   C                     UPDATII0
|   C***
|   C                     MOVE II02      PDNO
|   C           KEYIJ     SETLLIJ0
|   C           KEYIJ     READEIJ0                      45
| 03-C           *IN45     DOWEQ'0'
|   C*
|   C                     MOVELIJ01      IN01
B2000C                     Z-ADDW#B16     IN02
|   C                     MOVE II03      IN03
|   C                     MOVE IJ03      IN04
|   C                     Z-ADDIJ05      QTY
|   C                     Z-ADD0         QTY1
|   C                     WRITEPD1
| 04-C           *IN39     IFEQ '1'
|   C                     WRITEPE1
|   C                     WRITEPH1
|   C                     SETOF                     39
| 04-C                     END
|   C*
|   C           KEYIN     CHAININ0                  40
B2000C                     Z-ADDDATE      INXX
B2000C                     TIME           INYY
|   C                     MOVE $USER     INZZ
|   C*
| 05-C           *IN40     IFEQ '0'
|   C                     SUB  IJ05      IN13
|   C                     SUB  IJ05      IN17
|   C                     SUB  IJ09      IN26
|   C                     SUB  IJ10      IN27
|   C                     SUB  IJ11      IN28
|   C                     UPDATIN0
      *
| 05*C                     ELSE
|   C                     Z-ADD0         IN05
|   C                     Z-ADD0         IN06
|   C                     Z-ADD0         IN07
|   C                     Z-ADD0         IN08
|   C                     Z-ADD0         IN09
|   C                     Z-ADD0         IN10
|   C                     Z-ADD0         IN101
|   C                     Z-ADD0         IN11
|   C                     Z-ADD0         IN12
|   C                     Z-SUBIJ05      IN13
|   C                     Z-ADD0         IN14
|   C                     Z-ADD0         IN15
|   C                     Z-ADD0         IN16
|   C                     Z-SUBIJ05      IN17
|   C                     Z-ADD0         IN18
|   C                     Z-ADD0         IN19
|   C                     Z-ADD0         IN20
|   C                     Z-ADD0         IN23
|   C                     Z-ADD0         IN24
|   C                     Z-ADD0         IN25
|   C                     Z-ADD0         IN231
|   C                     Z-ADD0         IN241
|   C                     Z-ADD0         IN251
|   C                     Z-SUBIJ09      IN26
|   C                     Z-SUBIJ10      IN27
|   C                     Z-SUBIJ11      IN28
|   C                     Z-ADD0         IN261
|   C                     Z-ADD0         IN271
|   C                     Z-ADD0         IN281
|   C                     Z-ADD0         IN29
|   C                     Z-ADD0         IN30
|   C                     Z-ADD0         IN31
|   C                     Z-ADD0         IN291
|   C                     Z-ADD0         IN301
|   C                     Z-ADD0         IN311
|   C                     Z-ADD0         IN32
|   C                     Z-ADD0         IN33
|   C                     Z-ADD0         IN34
|   C                     Z-ADD0         IN321
|   C                     Z-ADD0         IN331
|   C                     Z-ADD0         IN341
|   C                     Z-ADD0         IN35
|   C                     Z-ADD0         IN36
|   C                     Z-ADD0         IN37
|   C                     Z-ADD0         IN38
|   C                     Z-ADD0         IN39
|   C                     Z-ADD0         IN40
|   C                     Z-ADD0         IN41
|   C**
|   C                     WRITEIN0
      *
| 05-C                     END
|   C*
|   C                     MOVELIJ01      IN01
B2000C                     Z-ADDW#B16     IN02
|   C                     MOVE II04      IN03
|   C                     MOVE IJ03      IN04
|   C                     Z-ADDIJ05      QTY
|   C                     Z-ADD0         QTY1
|   C                     WRITEPD1
| 06-C           *IN39     IFEQ '1'
|   C                     WRITEPE1
|   C                     WRITEPH1
|   C                     SETOF                     39
| 06-C                     END
|   C*
|   C           KEYIN     CHAININ0                  40
B2000C                     Z-ADDDATE      INXX
B2000C                     TIME           INYY
|   C                     MOVE $USER     INZZ
|   C*
| 07-C           *IN40     IFEQ '0'
|   C                     ADD  IJ05      IN13
|   C                     ADD  IJ05      IN17
|   C                     ADD  IJ09      IN26
|   C                     ADD  IJ10      IN27
|   C                     ADD  IJ11      IN28
|   C                     UPDATIN0
      *
| 07*C                     ELSE
|   C                     Z-ADD0         IN05
|   C                     Z-ADD0         IN06
|   C                     Z-ADD0         IN07
|   C                     Z-ADD0         IN08
|   C                     Z-ADD0         IN09
|   C                     Z-ADD0         IN10
|   C                     Z-ADD0         IN101
|   C                     Z-ADD0         IN11
|   C                     Z-ADD0         IN12
|   C                     Z-ADDIJ05      IN13
|   C                     Z-ADD0         IN14
|   C                     Z-ADD0         IN15
|   C                     Z-ADD0         IN16
|   C                     Z-ADDIJ05      IN17
|   C                     Z-ADD0         IN18
|   C                     Z-ADD0         IN19
|   C                     Z-ADD0         IN20
|   C                     Z-ADD0         IN23
|   C                     Z-ADD0         IN24
|   C                     Z-ADD0         IN25
|   C                     Z-ADD0         IN231
|   C                     Z-ADD0         IN241
|   C                     Z-ADD0         IN251
|   C                     Z-ADDIJ09      IN26
|   C                     Z-ADDIJ10      IN27
|   C                     Z-ADDIJ11      IN28
|   C                     Z-ADD0         IN261
|   C                     Z-ADD0         IN271
|   C                     Z-ADD0         IN281
|   C                     Z-ADD0         IN29
|   C                     Z-ADD0         IN30
|   C                     Z-ADD0         IN31
|   C                     Z-ADD0         IN291
|   C                     Z-ADD0         IN301
|   C                     Z-ADD0         IN311
|   C                     Z-ADD0         IN32
|   C                     Z-ADD0         IN33
|   C                     Z-ADD0         IN34
|   C                     Z-ADD0         IN321
|   C                     Z-ADD0         IN331
|   C                     Z-ADD0         IN341
|   C                     Z-ADD0         IN35
|   C                     Z-ADD0         IN36
|   C                     Z-ADD0         IN37
|   C                     Z-ADD0         IN38
|   C                     Z-ADD0         IN39
|   C                     Z-ADD0         IN40
|   C                     Z-ADD0         IN41
|   C**
|   C                     WRITEIN0
      *
| 07-C                     END
|   C*
|   C           KEYIJ     READEIJ0                      45
| 03-C                     END
|   C*
|   C                     READ II0                      44
| 02*C                     ELSE
|   C                     SETON                     44
| 02-C                     END
|   C*
| 01-C                     END
|    C*
15===C                     ENDSR
      *===============================================================*
      *          RTN430....禮盒組拆主檔
      *===============================================================*
16===C           RTN430    BEGSR
|    C*
B2000C           SETLL     SETLLIM0
|    C                     READ IM0                      44
| 01-C           *IN44     DOWEQ'0'
|   C*
B2000C                     Z-ADDIM08      WDATE
B2000C           WYYMM     IFEQ W#B16
|   C                     MOVE 'V'       IM09
B2000C                     Z-ADDDATE      IMXX
B2000C                     TIME           IMYY
|   C                     MOVE $USER     IMZZ
|   C**
|   C                     UPDATIM0
|   C                     MOVE IM02      PDNO
|   C***
|   C           KEYIL     SETLLIL0
|   C           KEYIL     READEIL0                      45
| 03-C           *IN45     DOWEQ'0'
|   C*
|   C                     MOVELIL01      IN01
B2000C                     Z-ADDW#B16     IN02
|   C                     MOVE IL03      IN03
|   C                     MOVE IL05      IN04
|   C                     Z-ADDIL06      QTY
|   C                     Z-ADD0         QTY1
|   C                     WRITEPD1
| 04-C           *IN39     IFEQ '1'
|   C                     WRITEPE1
|   C                     WRITEPH1
|   C                     SETOF                     39
| 04-C                     END
|   C*
|   C           KEYIN     CHAININ0                  40
B2000C                     Z-ADDDATE      INXX
B2000C                     TIME           INYY
|   C                     MOVE $USER     INZZ
|   C*
| 05-C           *IN40     IFEQ '0'
| 06-C           IL07      IFEQ -1
|   C                     SUB  IL06      IN16
|   C                     SUB  IL06      IN17
|   C                     SUB  IL08      IN26
|   C                     SUB  IL09      IN27
|   C                     SUB  IL10      IN28
| 06-C                     END
| 07-C           IL07      IFEQ 1
|   C                     ADD  IL06      IN16
|   C                     ADD  IL06      IN17
|   C                     ADD  IL08      IN26
|   C                     ADD  IL09      IN27
|   C                     ADD  IL10      IN28
| 07-C                     END
|   C                     UPDATIN0
      *
| 05*C                     ELSE
|   C                     Z-ADD0         IN05
|   C                     Z-ADD0         IN06
|   C                     Z-ADD0         IN07
|   C                     Z-ADD0         IN08
|   C                     Z-ADD0         IN09
|   C                     Z-ADD0         IN10
|   C                     Z-ADD0         IN101
|   C                     Z-ADD0         IN11
|   C                     Z-ADD0         IN12
|   C                     Z-ADD0         IN13
|   C                     Z-ADD0         IN14
|   C                     Z-ADD0         IN15
| 08-C           IL07      IFEQ -1
|   C                     Z-SUBIL06      IN16
|   C                     Z-SUBIL06      IN17
|   C                     Z-SUBIL08      IN26
|   C                     Z-SUBIL09      IN27
|   C                     Z-SUBIL10      IN28
| 08-C                     END
| 09-C           IL07      IFEQ 1
|   C                     Z-ADDIL06      IN16
|   C                     Z-ADDIL06      IN17
|   C                     Z-ADDIL08      IN26
|   C                     Z-ADDIL09      IN27
|   C                     Z-ADDIL10      IN28
| 09-C                     END
|   C                     Z-ADD0         IN18
|   C                     Z-ADD0         IN19
|   C                     Z-ADD0         IN20
|   C                     Z-ADD0         IN23
|   C                     Z-ADD0         IN24
|   C                     Z-ADD0         IN25
|   C                     Z-ADD0         IN231
|   C                     Z-ADD0         IN241
|   C                     Z-ADD0         IN251
|   C                     Z-ADD0         IN261
|   C                     Z-ADD0         IN271
|   C                     Z-ADD0         IN281
|   C                     Z-ADD0         IN29
|   C                     Z-ADD0         IN30
|   C                     Z-ADD0         IN31
|   C                     Z-ADD0         IN291
|   C                     Z-ADD0         IN301
|   C                     Z-ADD0         IN311
|   C                     Z-ADD0         IN32
|   C                     Z-ADD0         IN33
|   C                     Z-ADD0         IN34
|   C                     Z-ADD0         IN321
|   C                     Z-ADD0         IN331
|   C                     Z-ADD0         IN341
|   C                     Z-ADD0         IN35
|   C                     Z-ADD0         IN36
|   C                     Z-ADD0         IN37
|   C                     Z-ADD0         IN38
|   C                     Z-ADD0         IN39
|   C                     Z-ADD0         IN40
|   C                     Z-ADD0         IN41
|   C**
|   C                     WRITEIN0
      *
| 05-C                     END
|   C*
|   C           KEYIL     READEIL0                      45
| 03-C                     END
|   C*
|   C                     READ IM0                      44
| 02*C                     ELSE
|   C                     SETON                     44
| 02-C                     END
|   C*
| 01-C                     END
|    C*
16===C                     ENDSR
      *===============================================================*
      *          RTN440....良壞轉換主檔
      *===============================================================*
17===C           RTN440    BEGSR
|    C*
B2000C           SETLL     SETLLIC0
|    C                     READ IC0                      44
| 01-C           *IN44     DOWEQ'0'
|   C*
B2000C                     Z-ADDIC05      WDATE
B2000C           WYYMM     IFEQ W#B16
|   C                     MOVE 'V'       IC06
B2000C                     Z-ADDDATE      ICXX
B2000C                     TIME           ICYY
|   C                     MOVE $USER     ICZZ
|   C**
|   C                     UPDATIC0
|   C                     MOVE IC02      PDNO
|   C                     WRITEPD1
| 03-C           *IN39     IFEQ '1'
|   C                     WRITEPE1
|   C                     WRITEPH1
|   C                     SETOF                     39
| 03-C                     END
|   C*
|   C                     READ IC0                      44
| 02*C                     ELSE
|   C                     SETON                     44
| 02-C                     END
|   C*
| 01-C                     END
|    C*
17===C                     ENDSR
      *===============================================================*
      *          RTN450....盤盈虧檔
      *===============================================================*
18===C           RTN450    BEGSR
|    C*
B2000C           SETLL     SETLLIU0
|    C                     READ IU0                      44
| 01-C           *IN44     DOWEQ'0'
|   C*
B2000C                     Z-ADDIU04      WDATE
B2000C           WYYMM     IFEQ W#B16
|   C***
|   C                     MOVELIU01      IN01
B2000C                     Z-ADDW#B16     IN02
|   C                     MOVE IU03      IN03
|   C                     MOVE IU05      IN04
|   C                     Z-ADDIU06      QTY
|   C                     Z-ADDIU07      QTY1
|   C                     WRITEPD1
| 03-C           *IN39     IFEQ '1'
|   C                     WRITEPE1
|   C                     WRITEPH1
|   C                     SETOF                     39
| 03-C                     END
|   C*
|   C           KEYIN     CHAININ0                  40
B2000C                     Z-ADDDATE      INXX
B2000C                     TIME           INYY
|   C                     MOVE $USER     INZZ
|   C*
|   C           IU06      ADD  IU07      WORK
| 04-C           *IN40     IFEQ '0'
|   C                     ADD  WORK      IN41
|   C                     ADD  WORK      IN17
|   C                     ADD  IU08      IN26
|   C                     ADD  IU09      IN27
|   C                     ADD  IU10      IN28
|   C                     UPDATIN0
      *
| 04*C                     ELSE
|   C                     Z-ADD0         IN05
|   C                     Z-ADD0         IN06
|   C                     Z-ADD0         IN07
|   C                     Z-ADD0         IN08
|   C                     Z-ADD0         IN09
|   C                     Z-ADD0         IN10
|   C                     Z-ADD0         IN101
|   C                     Z-ADD0         IN11
|   C                     Z-ADD0         IN12
|   C                     Z-ADD0         IN13
|   C                     Z-ADD0         IN14
|   C                     Z-ADD0         IN15
|   C                     Z-ADD0         IN16
|   C                     Z-ADDWORK      IN17
|   C                     Z-ADD0         IN18
|   C                     Z-ADD0         IN19
|   C                     Z-ADD0         IN20
|   C                     Z-ADD0         IN23
|   C                     Z-ADD0         IN24
|   C                     Z-ADD0         IN25
|   C                     Z-ADD0         IN231
|   C                     Z-ADD0         IN241
|   C                     Z-ADD0         IN251
|   C                     Z-SUBIU08      IN26
|   C                     Z-SUBIU09      IN27
|   C                     Z-SUBIU10      IN28
|   C                     Z-ADD0         IN261
|   C                     Z-ADD0         IN271
|   C                     Z-ADD0         IN281
|   C                     Z-ADD0         IN29
|   C                     Z-ADD0         IN30
|   C                     Z-ADD0         IN31
|   C                     Z-ADD0         IN291
|   C                     Z-ADD0         IN301
|   C                     Z-ADD0         IN311
|   C                     Z-ADD0         IN32
|   C                     Z-ADD0         IN33
|   C                     Z-ADD0         IN34
|   C                     Z-ADD0         IN321
|   C                     Z-ADD0         IN331
|   C                     Z-ADD0         IN341
|   C                     Z-ADD0         IN35
|   C                     Z-ADD0         IN36
|   C                     Z-ADD0         IN37
|   C                     Z-ADD0         IN38
|   C                     Z-ADD0         IN39
|   C                     Z-ADD0         IN40
|   C                     Z-ADDWORK      IN41
|   C**
|   C                     WRITEIN0
      *
| 04-C                     END
|   C*
|   C                     READ IU0                      44
| 02*C                     ELSE
|   C                     SETON                     44
| 02-C                     END
|   C*
| 01-C                     END
|    C*
18===C                     ENDSR
      *===============================================================*
      *          RTN500....公司主檔
      *===============================================================*
19===C           RTN500    BEGSR
|    C*
|    C           *LOVAL    SETLL#B0
|    C                     READ #B0                      40
| 01-C           *IN40     DOWEQ'0'
|   C*
B2000C                     Z-ADDW#B16     #B16
B2000C                     Z-ADDDATE      #BXX
B2000C                     TIME           #BYY
|   C                     MOVE $USER     #BZZ
|   C*
|   C                     UPDAT#B0
|   C                     READ #B0                      40
| 01-C                     END
|    C*
19===C                     ENDSR
